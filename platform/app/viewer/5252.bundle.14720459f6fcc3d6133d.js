/*! For license information please see 5252.bundle.14720459f6fcc3d6133d.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5252],{5057:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(53586),i=n(48080),o=n(92885),a=n(71209);function s(e,t){const n=e.image;if(!e.canvas||!e.image)return;const s=(0,r.A)();if(n.stats={lastGetPixelDataTime:-1,lastStoredPixelDataToCanvasImageDataTime:-1,lastPutImageDataTime:-1,lastRenderTime:-1,lastLutGenerateTime:-1},n){let r=n.render;r||(r=e.viewport.colormap?a.l:n.color?i.f:o.j),r(e,t)}const l=(0,r.A)()-s;n.stats.lastRenderTime=l,e.invalid=!1,e.needsRedraw=!1}},7808:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(45354);function i(e,t){const n=new r.d;if(!e.viewport.displayedArea)return n;n.translate(e.canvas.width/2,e.canvas.height/2);const i=e.viewport.rotation;0!==i&&n.rotate(i*Math.PI/180);let o=e.viewport.scale,a=e.viewport.scale;const s=e.viewport.displayedArea.brhc.x-(e.viewport.displayedArea.tlhc.x-1),l=e.viewport.displayedArea.brhc.y-(e.viewport.displayedArea.tlhc.y-1);if("NONE"===e.viewport.displayedArea.presentationSizeMode)e.image.rowPixelSpacing<e.image.columnPixelSpacing?o*=e.image.columnPixelSpacing/e.image.rowPixelSpacing:e.image.columnPixelSpacing<e.image.rowPixelSpacing&&(a*=e.image.rowPixelSpacing/e.image.columnPixelSpacing);else if(o=e.viewport.displayedArea.columnPixelSpacing,a=e.viewport.displayedArea.rowPixelSpacing,"SCALE TO FIT"===e.viewport.displayedArea.presentationSizeMode){const t=e.canvas.height/(l*a),n=e.canvas.width/(s*o);o=a=Math.min(n,t),e.viewport.displayedArea.rowPixelSpacing<e.viewport.displayedArea.columnPixelSpacing?o*=e.viewport.displayedArea.columnPixelSpacing/e.viewport.displayedArea.rowPixelSpacing:e.viewport.displayedArea.columnPixelSpacing<e.viewport.displayedArea.rowPixelSpacing&&(a*=e.viewport.displayedArea.rowPixelSpacing/e.viewport.displayedArea.columnPixelSpacing)}return n.scale(o,a),0!==i&&n.rotate(-i*Math.PI/180),n.translate(e.viewport.translation.x,e.viewport.translation.y),0!==i&&n.rotate(i*Math.PI/180),void 0!==t&&n.scale(t,t),e.viewport.hflip&&n.scale(-1,1),e.viewport.vflip&&n.scale(1,-1),n.translate(-s/2,-l/2),n}},36931:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(12132),i=n(57162);function o(e,t,n,o){if(void 0===e)throw new Error("getDefaultViewport: parameter canvas must not be undefined");if(void 0===t)return(0,r.A)();const a=(0,i.A)(e,t,0).scaleFactor;let s;return"PT"===n&&t.isPreScaled?s={windowWidth:5,windowCenter:2.5}:void 0!==t.windowWidth&&void 0!==t.windowCenter&&(s={windowWidth:Array.isArray(t.windowWidth)?t.windowWidth[0]:t.windowWidth,windowCenter:Array.isArray(t.windowCenter)?t.windowCenter[0]:t.windowCenter}),{scale:a,translation:{x:0,y:0},voi:s,invert:t.invert,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:t.modalityLUT,modality:n,voiLUT:t.voiLUT,colormap:void 0!==o?o:t.colormap,displayedArea:{tlhc:{x:1,y:1},brhc:{x:t.columns,y:t.rows},rowPixelSpacing:void 0===t.rowPixelSpacing?1:t.rowPixelSpacing,columnPixelSpacing:void 0===t.columnPixelSpacing?1:t.columnPixelSpacing,presentationSizeMode:"NONE"}}}},98834:(e,t,n)=>{n.d(t,{oI:()=>r.Ay,A7:()=>i.A});n(61640),n(92099);var r=n(30135),i=n(10809);n(46347);n(90740)},90808:(e,t,n)=>{},31749:(e,t,n)=>{n.d(t,{Events:()=>r.A,ImageQualityStatus:()=>p.A,InterpolationType:()=>a.A,MetadataModules:()=>y.A,OrientationAxis:()=>d.A,RequestType:()=>i.A,VOILUTFunctionType:()=>g.A,VideoEnums:()=>v,ViewportStatus:()=>h.A,ViewportType:()=>o.A});var r=n(32643),i=n(43213),o=n(41864),a=n(29310),s=n(67737);const{BlendMode:l}=s.Ay;var c;!function(e){e[e.COMPOSITE=l.COMPOSITE_BLEND]="COMPOSITE",e[e.MAXIMUM_INTENSITY_BLEND=l.MAXIMUM_INTENSITY_BLEND]="MAXIMUM_INTENSITY_BLEND",e[e.MINIMUM_INTENSITY_BLEND=l.MINIMUM_INTENSITY_BLEND]="MINIMUM_INTENSITY_BLEND",e[e.AVERAGE_INTENSITY_BLEND=l.AVERAGE_INTENSITY_BLEND]="AVERAGE_INTENSITY_BLEND"}(c||(c={}));var u,d=n(18735);!function(e){e.CONTOUR="CONTOUR",e.SURFACE="SURFACE"}(u||(u={}));n(86066);var f,g=n(82501);n(91369);!function(e){e.NOT_APPLICABLE="",e.ERMF="ERMF",e.USER="User",e.PROJECTION="Proj",e.REGION="Region",e.ERROR="Error",e.UNCALIBRATED="Uncalibrated"}(f||(f={}));var m,h=n(1814),p=n(77474),v=n(13545),y=n(69850);!function(e){e.SUM="SUM",e.SUBTRACT="SUBTRACT",e.AVERAGE="AVERAGE"}(m||(m={}))},86846:(e,t,n)=>{n.d(t,{Ay:()=>i});var r=n(39536);function i(e){if(!e)return;const{viewportUid:t,renderingEngineUid:n}=e.dataset;return o(t,n)}function o(e,t){if(!t||!e)return;const n=(0,r.Ay)(t);if(!n||n.hasBeenDestroyed)return;const i=n.getViewport(e);if(!i)return;const o=i.getFrameOfReferenceUID();return{viewport:i,renderingEngine:n,viewportId:e,renderingEngineId:t,FrameOfReferenceUID:o}}},59693:(e,t,n)=>{n.d(t,{lk:()=>s,D0:()=>u,LH:()=>l,Dh:()=>c,a:()=>d});n(39536),n(74268),n(99178),n(31749),n(24743);let r=!1;const i={gpuTier:{tier:2},isMobile:!1,rendering:{useCPURendering:!1,preferSizeOverAccuracy:!1,strictZSpacingForVolumeViewport:!0},peerImport:e=>null};let o={...i,rendering:{...i.rendering}};function a(){return!!/iPad|iPhone|iPod/.test(navigator.platform)||navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&navigator.platform.includes("MacIntel")}function s(){return!a()}function l(){return o.rendering.useCPURendering}function c(){return r}function u(){return o}function d(e){return o.peerImport(e)}},80068:(e,t,n)=>{n.d(t,{loadAndCacheImage:()=>g,loadImage:()=>f});var r=n(49038),i=n(32643),o=n(10364),a=(n(27119),n(99576),n(69372)),s=(n(80221),n(24623));n(51159),n(74876);const l={};let c;function u(e,t){const n=r.Ay.getImageLoadObject(e);if(n)return d(n.promise,e),n;const i=e.split(":")[0],o=l[i]||c;if(!o)throw new Error(`loadImageFromImageLoader: No image loader found for scheme '${i}'`);const a=o(e,t);return d(a.promise,e),a}function d(e,t){Promise.resolve(e).then((e=>{!function(e){if(!e.voxelManager){const{width:t,height:n,numberOfComponents:r}=e,i=s.A.createImageVoxelManager({scalarData:e.getPixelData(),width:t,height:n,numberOfComponents:r});e.voxelManager=i,e.getPixelData=()=>i.getScalarData(),delete e.imageFrame.pixelData}}(e),(0,a.A)(o.A,i.A.IMAGE_LOADED,{image:e})})).catch((e=>{const n={imageId:t,error:e};(0,a.A)(o.A,i.A.IMAGE_LOAD_FAILED,n)}))}function f(e,t={priority:0,requestType:"prefetch"}){if(void 0===e)throw new Error("loadImage: parameter imageId must not be undefined");return u(e,t).promise}function g(e,t={priority:0,requestType:"prefetch"}){if(void 0===e)throw new Error("loadAndCacheImage: parameter imageId must not be undefined");const n=u(e,t);return r.Ay.getImageLoadObject(e)||r.Ay.putImageLoadObject(e,n),n.promise}},39561:(e,t,n)=>{n.d(t,{createAndCacheVolume:()=>f,getUnknownVolumeLoaderSchema:()=>m,getVolumeLoaderSchemes:()=>g,loadVolume:()=>d});n(7742),n(86252);var r=n(49038),i=n(32643),o=n(10364),a=n(69372),s=(n(80221),n(24623),n(80068),n(9734),n(55500));const l={};let c=s.F;function u(e,t){const n=e.indexOf(":"),r=e.substring(0,n);let s=l[r];if(null==s){if(null==c||"function"!=typeof c)throw new Error(`No volume loader for scheme ${r} has been registered`);s=c}const u=s(e,t);return u.promise.then((function(e){(0,a.A)(o.A,i.A.VOLUME_LOADED,{volume:e})}),(function(t){const n={volumeId:e,error:t};(0,a.A)(o.A,i.A.VOLUME_LOADED_FAILED,n)})),u}function d(e,t={imageIds:[]}){if(void 0===e)throw new Error("loadVolume: parameter volumeId must not be undefined");let n=r.Ay.getVolumeLoadObject(e);return void 0!==n?n.promise:(n=u(e,t),n.promise.then((e=>e)))}async function f(e,t){if(void 0===e)throw new Error("createAndCacheVolume: parameter volumeId must not be undefined");let n=r.Ay.getVolumeLoadObject(e);return void 0!==n||(n=u(e,t),r.Ay.putVolumeLoadObject(e,n)),n.promise}function g(){return Object.keys(l)}function m(){return c.name}},22191:(e,t,n)=>{n.d(t,{A:()=>r});class r{constructor(e){this.name=e||"unknown"}static as(e){if(e.iterator)return e.iterator;const t=new r("as iterator");return e.then((e=>{try{t.add(e,!0)}catch(e){t.reject(e)}}),(e=>{t.reject(e)})),t}add(e,t=!1){this.nextValue=e,this.done||=t,this.waiting&&(this.waiting.resolve(e),this.waiting=void 0)}resolve(){this.done=!0,this.waiting&&(this.waiting.resolve(this.nextValue),this.waiting=void 0)}reject(e){this.rejectReason=e,this.waiting?.reject(e)}getRecent(){if(this.rejectReason)throw this.rejectReason;return this.nextValue}async*[Symbol.asyncIterator](){for(;!this.done;){if(this.rejectReason)throw this.rejectReason;if(void 0!==this.nextValue&&(yield this.nextValue,this.done))break;this.waiting||(this.waiting={},this.waiting.promise=new Promise(((e,t)=>{this.waiting.resolve=e,this.waiting.reject=t}))),await this.waiting.promise}yield this.nextValue}async forEach(e,t){let n=0;try{for await(const r of this){const{done:i}=this;try{await e(r,i,n),n++}catch(e){if(!i){console.warn("Caught exception in intermediate value",e);continue}if(!t)throw e;t(e,i)}}}catch(e){if(!t)throw e;t(e,!0)}}generate(e,t){return e(this,this.reject.bind(this)).then((()=>{this.done||this.resolve()}),(e=>{this.reject(e),t?t(e):console.warn("Couldn't process because",e)}))}async nextPromise(){for await(const e of this)if(e)return e;return this.nextValue}async donePromise(){for await(const e of this);return this.nextValue}getNextPromise(){const e=this.nextPromise();return e.iterator=this,e}getDonePromise(){const e=this.donePromise();return e.iterator=this,e}}},67645:(e,t,n)=>{n.d(t,{A:()=>r});class r{constructor(e,t,n=1){this.rows=new Map,this.height=1,this.width=1,this.depth=1,this.jMultiple=1,this.kMultiple=1,this.numberOfComponents=1,this.defaultValue=0,this.pixelDataConstructor=Uint8Array,this.get=e=>{const t=e%this.jMultiple,n=(e-t)/this.jMultiple,r=this.getRLE(t,n);return r?.value||this.defaultValue},this.getRun=(e,t)=>{const n=e+t*this.height;return this.rows.get(n)},this.set=(e,t)=>{if(void 0===t)throw new Error("Can't set undefined at "+e%this.width);const n=e%this.width,r=(e-n)/this.width,i=this.rows.get(r);if(!i)return void this.rows.set(r,[{start:n,end:n+1,value:t}]);const o=this.findIndex(i,n),a=i[o],s=i[o-1];if(!a)return s&&s.value===t&&s.end===n?void s.end++:void(i[o]={start:n,end:n+1,value:t});const{start:l,end:c,value:u}=a;if(t===u&&n>=l)return;const d={start:n,end:n+1,value:t},f=n>l,g=f?o+1:o,m=f?a:s;let h=f?i[o+1]:a;if(m?.value===t&&m.end===n)return m.end++,void(h?.value===t&&h.start===n+1?(m.end=h.end,i.splice(o,1)):h?.start===n&&(h.start++,h.start===h.end&&(i.splice(o,1),h=i[o],h?.start===n+1&&h.value===t&&(m.end=h.end,i.splice(o,1)))));if(h?.value===t&&h.start===n+1)return h.start--,void(m?.end>n&&(m.end=n,m.end===m.start&&i.splice(o,1)));if(h?.start!==n||h.end!==n+1)n===h?.start&&h.start++,f&&c>n+1?i.splice(g,0,d,{start:n+1,end:m.end,value:m.value}):i.splice(g,0,d),m?.end>n&&(m.end=n);else{h.value=t;const e=i[o+1];e?.start==n+1&&e?.value===t&&(i.splice(o+1,1),h.end=e.end)}},this.width=e,this.height=t,this.depth=n,this.jMultiple=e,this.kMultiple=this.jMultiple*t}getRLE(e,t,n=0){const r=this.rows.get(t+n*this.height);if(!r)return;const i=r[this.findIndex(r,e)];return e>=i?.start?i:void 0}findIndex(e,t){for(let n=0;n<e.length;n++){const{end:r}=e[n];if(t<r)return n}return e.length}clear(){this.rows.clear()}keys(){return[...this.rows.keys()]}getPixelData(e=0,t){t?t.fill(0):t=new this.pixelDataConstructor(this.width*this.height*this.numberOfComponents);const{width:n,height:r,numberOfComponents:i}=this;for(let o=0;o<r;o++){const r=this.getRun(o,e);if(r)if(1===i)for(const e of r){const r=o*n,{start:i,end:a,value:s}=e;for(let e=i;e<a;e++)t[r+e]=s}else for(const e of r){const r=o*n*i,{start:a,end:s,value:l}=e;for(let e=a;e<s;e+=i)for(let n=0;n<i;n++)t[r+e+n]=l[n]}}return t}}},98039:(e,t,n)=>{function r(e){return i(e,"vtkVolume")||i(e,"vtkImageSlice")}function i(e,t){return!!("isA"in e?e:e.actor).isA(t)}n.d(t,{N:()=>i,e:()=>r})},96833:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(33739),i=n(99341);function o(e,t){const n=t.colorTransfer.split(" ").splice(1).map(parseFloat),{shiftRange:o}=function(e){let t=1/0,n=-1/0;for(let r=0;r<e.length;r+=4)t=Math.min(t,e[r]),n=Math.max(n,e[r]);const r=(n-t)/2;return{shiftRange:[-r,r],min:t,max:n}}(n),a=o[0],s=o[1]-o[0],l=r.Ay.newInstance(),c=[];for(let e=0;e<n.length;e+=4){let t=n[e];const r=n[e+1],i=n[e+2],o=n[e+3];t=(t-a)/s,c.push([t,r,i,o])}!function(e,t,n){const r=t[1]-t[0],i=e.map((([e,n,i,o])=>[e*r+t[0],n,i,o]));n.removeAllPoints(),i.forEach((([e,t,r,i])=>n.addRGBPoint(e,t,r,i)))}(c,o,l),e.getProperty().setRGBTransferFunction(0,l);const u=t.scalarOpacity.split(" ").splice(1).map(parseFloat),d=i.Ay.newInstance(),f=[];for(let e=0;e<u.length;e+=2){let t=u[e];const n=u[e+1];t=(t-a)/s,f.push([t,n])}!function(e,t,n){const r=t[1]-t[0],i=e.map((([e,n])=>[e*r+t[0],n]));n.removeAllPoints(),i.forEach((([e,t])=>n.addPoint(e,t)))}(f,o,d);const g=e.getProperty();g.setScalarOpacity(0,d);const[m,h,p,v]=t.gradientOpacity.split(" ").splice(1).map(parseFloat);g.setUseGradientOpacity(0,!0),g.setGradientOpacityMinimumValue(0,m),g.setGradientOpacityMinimumOpacity(0,h),g.setGradientOpacityMaximumValue(0,p),g.setGradientOpacityMaximumOpacity(0,v),"1"===t.interpolation&&g.setInterpolationTypeToFastLinear(),g.setShade("1"===t.shade);const y=parseFloat(t.ambient),w=parseFloat(t.diffuse),I=parseFloat(t.specular),A=parseFloat(t.specularPower);g.setAmbient(y),g.setDiffuse(w),g.setSpecular(I),g.setSpecularPower(A)}},91979:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(39536),i=n(24724);const o=e=>{const t=function(e){const t=(0,r.qO)(),n=[];return t.forEach((t=>{const r=(0,i.A)(e);r.length&&n.push({renderingEngine:t,viewportIds:r.map((e=>e.id))})})),n}(e);t?.length&&t.forEach((({renderingEngine:e,viewportIds:t})=>{e.hasBeenDestroyed||e.renderViewports(t)}))}},84061:(e,t,n)=>{function r(e,t,n){return Math.max(t,Math.min(n,e))}n.d(t,{A:()=>r,q:()=>r})},13859:(e,t,n)=>{n.r(t),n.d(t,{findMatchingColormap:()=>u,getColormap:()=>l,getColormapNames:()=>c,registerColormap:()=>s});var r=n(660),i=n(74638),o=n(98039);const a=new Map;function s(e){a.set(e.Name,e)}function l(e){return a.get(e)}function c(){return Array.from(a.keys())}function u(e,t){const n=r.A.rgbPresetNames.map((e=>r.A.getPresetByName(e))),a=c().map((e=>l(e))),s=n.concat(a).find((t=>{const{RGBPoints:n}=t;if(n.length!==e.length)return!1;for(let t=0;t<n.length;t+=4)if(!(0,i.Ay)(n.slice(t+1,t+4),e.slice(t+1,t+4)))return!1;return!0}));if(!s)return null;const u=[];if((0,o.N)(t,"vtkVolume")){const e=t.getProperty().getScalarOpacity(0).getDataPointer();if(!e)return{name:s.Name};for(let t=0;t<e.length;t+=2)u.push({value:e[t],opacity:e[t+1]})}return{name:s.Name,opacity:u}}},74657:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(33739);function i(e){const t=r.Ay.newInstance();let n=0,i=1024;return void 0!==e.lower&&void 0!==e.upper&&(n=e.lower,i=e.upper),t.addRGBPoint(n,0,0,0),t.addRGBPoint(i,1,1,1),t}},40256:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(33739),i=n(42008),o=n(68136);function a(e,t=1024){const{windowWidth:n,windowCenter:a}=o.toWindowLevel(e.lower,e.upper),s=Array.from({length:t},((e,n)=>(n+1)/(t+2))).flatMap((e=>{const t=((e,t,n)=>t-n/4*Math.log((1-e)/e))(e,a,n);return[t,e,e,e,.5,0]})),l=r.Ay.newInstance();return l.buildFunctionFromArray(i.Ay.newInstance({values:s,numberOfComponents:6})),l}},63470:(e,t,n)=>{function r(e,t,n=0){const r=[];for(let i=n;i<e.length;i+=t)r.push(i);return r}n.d(t,{A:()=>r})},99949:(e,t,n)=>{function r(e){if(null===e||"object"!=typeof e)return e;if("function"==typeof e)return e;if("function"==typeof structuredClone)return e;if(Array.isArray(e))return e.map(r);{const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=r(e[n]));return t}}n.d(t,{G:()=>r})},88619:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(3823),i=n(74876),o=n(85008),a=n(19325);function s(e,t,n){const{direction:s,spacing:l,imageIds:c}=e;if(!c.length)return;const u=s.slice(6,9),d=r.eR.dot(u,n);if(Math.abs(d)<1-a.EPSILON)return;const f=(0,o.A)({direction:s,spacing:l},n)/2;let g;for(let e=0;e<c.length;e++){const o=c[e],{imagePositionPatient:a}=i.get("imagePlaneModule",o),s=r.eR.create();r.eR.sub(s,t,a);const l=r.eR.dot(s,n);Math.abs(l)<f&&(g=o)}return g}},47476:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(20537),i=n(65292);const o=function(e){const t=e.getCamera(),{spacingInNormalDirection:n,imageVolume:o}=(0,i.A)(e,t);if(!o)return;const{viewPlaneNormal:a,focalPoint:s}=t,l=e.getActors().find((e=>e.referencedId===o.volumeId||e.uid===o.volumeId));l||console.warn("No actor found for with actorUID of",o.volumeId);const c=l.actor,u=(0,r.A)(c,a,s),{min:d,max:f,current:g}=u,m=Math.round((f-d)/n)+1;let h=(g-d)/(f-d)*m;return h=Math.floor(h),h>m-1?h=m-1:h<0&&(h=0),{numberOfSlices:m,imageIndex:h}}},25308:(e,t,n)=>{function r(e){let t,n=e[0],r=e[0];const i=e.length;for(let o=1;o<i;o++)t=e[o],n=Math.min(n,t),r=Math.max(r,t);return{min:n,max:r}}n.d(t,{A:()=>r})},32173:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(74876);function i(e){const t=r.get("modalityLutModule",e)||{},n=r.get("generalSeriesModule",e)||{},{modality:i}=n,o={rescaleSlope:t.rescaleSlope||1,rescaleIntercept:t.rescaleIntercept??0,modality:i},a=r.get("scalingModule",e)||{};return{...o,..."PT"===i&&{suvbw:a.suvbw,suvbsa:a.suvbsa,suvlbm:a.suvlbm}}}},20537:(e,t,n)=>{n.d(t,{A:()=>u});var r=n(89265),i=n(15105),o=n(19325);const a=o.EPSILON*o.EPSILON,s=e=>Math.abs(Math.abs(e)-1)<a,l=(e,t)=>s(e[t])||s(e[t+1])||s(e[t+2]),c=e=>l(e,0)&&l(e,3)&&l(e,6);function u(e,t,n){const o=e.getMapper().getInputData();let a;const s=o.getDirection();if(c(s))a=(0,i.A)(e);else{const[e,t,n]=o.getDimensions();a=[[0,0,0],[e-1,0,0],[0,t-1,0],[e-1,t-1,0],[0,0,n-1],[e-1,0,n-1],[0,t-1,n-1],[e-1,t-1,n-1]].map((e=>o.indexToWorld(e)))}const l=r.A.buildFromDegree().identity().rotateFromDirections(t,[1,0,0]);a.forEach((e=>l.apply(e)));const u=[...n];l.apply(u);const d=u[0];let f=1/0,g=-1/0;for(let e=0;e<8;e++){const t=a[e][0];t>g&&(g=t),t<f&&(f=t)}return{min:f,max:g,current:d,actor:e,viewPlaneNormal:t,focalPoint:n}}},85008:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(3823);function i(e,t){const{direction:n,spacing:i}=e,o=n.slice(0,3),a=n.slice(3,6),s=n.slice(6,9),l=[r.eR.dot(o,t),r.eR.dot(a,t),r.eR.dot(s,t)],c=r.eR.create();r.eR.set(c,l[0]*i[0],l[1]*i[1],l[2]*i[2]);return r.eR.length(c)}},65292:(e,t,n)=>{n.d(t,{A:()=>u});var r=n(49038),i=n(19325),o=n(85008),a=n(39561),s=n(12437);const l=1+i.EPSILON,c=e=>!!(0,a.getVolumeLoaderSchemes)().find((t=>{return n=e.volumeId,(r=t)===n.substring(0,Math.min(n.length,r.length));var n,r}));function u(e,t,n,i=!1){const{viewPlaneNormal:o}=t,a=e.getActors();if(!a.length)return{spacingInNormalDirection:null,imageVolume:null,actorUID:null};const u=a.map((e=>{const t=e.referencedId??e.uid;return r.Ay.getVolume(t)})).filter((e=>!!e));if(n){const t=(0,s.A)(n),r=u.findIndex((e=>t.includes(e.volumeId))),l=u[r],{uid:c}=a[r];return{imageVolume:l,spacingInNormalDirection:d(l,o,e,i),actorUID:c}}if(!u.length)return{spacingInNormalDirection:null,imageVolume:null,actorUID:null};const f={spacingInNormalDirection:1/0,imageVolume:null,actorUID:null},g=u.find(c);for(let t=0;t<u.length;t++){const n=u[t];if(g&&!c(n))continue;const r=d(n,o,e);r*l<f.spacingInNormalDirection&&(f.spacingInNormalDirection=r,f.imageVolume=n,f.actorUID=a[t].uid)}return f}function d(e,t,n,r=!1){const{slabThickness:i}=n.getProperties();let a=i;return i&&r||(a=(0,o.A)(e,t)),a}},24724:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(39536);const i=function(e){const t=(0,r.qO)(),n=[];return t.forEach((t=>{const r=t.getVolumeViewports().filter((t=>t.hasVolumeId(e)));n.push(...r)})),n}},70210:(e,t,n)=>{function r(e){let t=[];const[n,r]=e.getRange();e.getTable(n,r,1024,t),t=t.filter(((e,t)=>t%3==0));const i=[...Array(1024).keys()].map(((e,t)=>n+(r-n)/1023*t)),o=t[256],a=Math.log((1-o)/o),s=i[256],l=t[768],c=Math.log((1-l)/l),u=i[768],d=Math.round(4*(u-s)/(a-c)),f=Math.round(s+d*a/4);return[Math.round(f-d/2),Math.round(f+d/2)]}n.d(t,{A:()=>r})},15105:(e,t,n)=>{function r(e){const t=e.getMapper().getInputData(),n=t.extentToBounds(t.getExtent());return[[n[0],n[2],n[4]],[n[0],n[2],n[5]],[n[0],n[3],n[4]],[n[0],n[3],n[5]],[n[1],n[2],n[4]],[n[1],n[2],n[5]],[n[1],n[3],n[4]],[n[1],n[3],n[5]]]}n.d(t,{A:()=>r})},12437:(e,t,n)=>{n.d(t,{A:()=>r});const r=e=>{const t="volumeId:",n=e.includes(t)?e.substring(9):e,r=n.indexOf("sliceIndex=");return-1===r?n:n.substring(0,r-1)}},4031:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(20537),i=n(65292);const o=function(e,t,n=!1){const o=e.getCamera(),{focalPoint:a,viewPlaneNormal:s}=o,{spacingInNormalDirection:l,actorUID:c}=(0,i.A)(e,o,t,n);if(!c)throw new Error(`Could not find image volume with id ${t} in the viewport`);const u=e.getActor(c);if(!u)return console.warn("No actor found for with actorUID of",c),null;const d=u.actor;return{sliceRange:(0,r.A)(d,s,a),spacingInNormalDirection:l,camera:o}}},61375:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(4031);const i=function(e,t,n=!1){const{sliceRange:i,spacingInNormalDirection:o,camera:a}=(0,r.A)(e,t,n),{min:s,max:l,current:c}=i,u=Math.round((l-s)/o),d=(c-s)/(l-s)*u;return{numScrollSteps:u,currentStepIndex:Math.round(d),sliceRangeInfo:{sliceRange:i,spacingInNormalDirection:o,camera:a}}}},30169:(e,t,n)=>{n.d(t,{a:()=>r});const r=e=>Object.values(e).some((e=>"number"==typeof e&&!Number.isInteger(e)))},38883:(e,t,n)=>{function r(e){return Array.isArray(e)?e.some((e=>Number.isNaN(e))):Number.isNaN(e)}n.d(t,{A:()=>r})},39537:(e,t,n)=>{function r(e){const t=e.indexOf(":");return e.substring(t+1)}n.d(t,{A:()=>r})},17791:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(74876);const i=new Map,o="imageRetrieveConfiguration",a={IMAGE_RETRIEVE_CONFIGURATION:o,clear:()=>{i.clear()},add:(e,t)=>{i.set(e,t)},get:(e,...t)=>{if(e===o)return t.map((e=>i.get(e))).find((e=>void 0!==e))}};(0,r.addProvider)(a.get.bind(a));const s=a},49035:(e,t,n)=>{n.r(t),n.d(t,{PointsManager:()=>we,ProgressiveIterator:()=>Ce.A,RLEVoxelMap:()=>ze.A,VoxelManager:()=>Be.A,actorIsA:()=>oe.N,applyPreset:()=>ye.A,autoLoad:()=>vt.A,calculateViewportsSpatialRegistration:()=>me,calibratedPixelSpacingMetadataProvider:()=>b,clamp:()=>S.A,clip:()=>At,color:()=>o,colormap:()=>tt,convertStackToVolumeViewport:()=>Ue,convertToGrayscale:()=>qe,convertVolumeToStackViewport:()=>je,createLinearRGBTransferFunction:()=>d.A,createSigmoidRGBTransferFunction:()=>c.A,decimate:()=>Re.A,deepClone:()=>wt.G,deepEqual:()=>at,deepMerge:()=>Ie.A,eventListener:()=>r,generateVolumePropsFromImageIds:()=>Ne.D,genericMetadataProvider:()=>xe.A,getBufferConfiguration:()=>Le.h,getClosestImageId:()=>x.A,getClosestStackImageIndexForPoint:()=>le,getCurrentVolumeViewportSlice:()=>ue,getDynamicVolumeInfo:()=>pt,getImageLegacy:()=>Se,getImageSliceDataForVolumeViewport:()=>ie.A,getMinMax:()=>h.A,getRandomSampleFromArray:()=>Xe,getRuntimeId:()=>I,getScalingParameters:()=>Ae.A,getSliceRange:()=>ne.A,getSpacingInNormalDirection:()=>_.A,getTargetVolumeAndSpacingInNormalDir:()=>M.A,getViewportImageCornersInWorld:()=>he,getViewportImageIds:()=>$e,getViewportModality:()=>Et,getViewportsWithImageURI:()=>ae,getViewportsWithVolumeId:()=>V.A,getVoiFromSigmoidRGBTransferFunction:()=>u.A,getVolumeActorCorners:()=>C.A,getVolumeId:()=>Ke.A,getVolumeSliceRangeInfo:()=>ee.A,getVolumeViewportScrollInfo:()=>te.A,getVolumeViewportsContainingSameVolumes:()=>O,hasFloatScalingParameters:()=>Ze.a,hasNaNValues:()=>ve.A,imageIdToURI:()=>A.A,imageRetrieveMetadataProvider:()=>De.A,imageToWorldCoords:()=>Q,indexWithinDimensions:()=>R,invertRgbTransferFunction:()=>l.A,isEqual:()=>E.n4,isEqualAbs:()=>E.Ph,isEqualNegative:()=>E.WC,isImageActor:()=>oe.e,isOpposite:()=>T,isPTPrescaledWithSUV:()=>z,isValidVolume:()=>_e,isVideoTransferSyntax:()=>Ve,jumpToSlice:()=>St,loadImageToCanvas:()=>J,makeVolumeMetadata:()=>Te.A,planar:()=>se,pointInShapeCallback:()=>Qe.i,renderToCanvasCPU:()=>$,renderToCanvasGPU:()=>G,roundNumber:()=>Ye,roundToPrecision:()=>He,scaleArray:()=>yt,scaleRgbTransferFunction:()=>f,scroll:()=>bt,snapFocalPointToSlice:()=>re.A,sortImageIdsAndGetSpacing:()=>Ee.A,spatialRegistrationMetadataProvider:()=>ge,splitImageIdsBy4DTags:()=>ht,transferFunctionUtils:()=>nt,transformIndexToWorld:()=>N.A,transformWorldToIndex:()=>L.A,triggerEvent:()=>g.A,updateVTKImageDataWithCornerstoneImage:()=>Me.J,uuidv4:()=>m.A,windowLevel:()=>et,worldToImageCoords:()=>Z});var r={};n.r(r),n.d(r,{MultiTargetEventListenerManager:()=>s,TargetEventListeners:()=>a});var i,o={};n.r(o),n.d(o,{hexToRgb:()=>ot,rgbToHex:()=>it}),function(e){e[e.None=0]="None",e[e.Capture=1]="Capture",e[e.Bubble=2]="Bubble"}(i||(i={}));class a{constructor(e){this._eventListeners=new Map,this._children=new Map,this._target=e}get isEmpty(){return 0===this._eventListeners.size&&0===this._children.size}addEventListener(e,t,n){const r=e.indexOf(".");if(-1!==r){const i=e.substring(0,r);let o=this._children.get(i);o||(o=new a(this._target),this._children.set(i,o)),e=e.substring(r+1),o.addEventListener(e,t,n)}else this._addEventListener(e,t,n)}removeEventListener(e,t,n){const r=e.indexOf(".");if(-1!==r){const i=e.substring(0,r),o=this._children.get(i);if(!o)return;e=e.substring(r+1),o.removeEventListener(e,t,n),o.isEmpty&&this._children.delete(i)}else this._removeEventListener(e,t,n)}reset(){Array.from(this._children.entries()).forEach((([e,t])=>{if(t.reset(),!t.isEmpty)throw new Error("Child is not empty and cannot be removed");this._children.delete(e)})),this._unregisterAllEvents()}_addEventListener(e,t,n){let r=this._eventListeners.get(e);r||(r=new Map,this._eventListeners.set(e,r));const o=n?.capture??!1?i.Capture:i.Bubble,a=r.get(t)??i.None;a&o?console.warn("A listener is already registered for this phase"):(r.set(t,a|o),this._target.addEventListener(e,t,n))}_removeEventListener(e,t,n){const r=n?.capture??!1?i.Capture:i.Bubble,o=this._eventListeners.get(e);if(!o)return;(t?[t]:Array.from(o.keys())).forEach((t=>{const a=o.get(t)??i.None;if(!!!(a&r))return;this._target.removeEventListener(e,t,n);const s=a^r;s===i.None?o.delete(t):o.set(t,s)})),o.size||this._eventListeners.delete(e)}_unregisterAllListeners(e,t){Array.from(t.entries()).forEach((([t,n])=>{for(let r=i.Capture;n;r<<=1){if(!(n&r))continue;const o=r===i.Capture;this.removeEventListener(e,t,{capture:o}),n^=r}}))}_unregisterAllEvents(){Array.from(this._eventListeners.entries()).forEach((([e,t])=>{this._unregisterAllListeners(e,t)}))}}class s{constructor(){this._targetsEventListeners=new Map}addEventListener(e,t,n,r){let i=this._targetsEventListeners.get(e);i||(i=new a(e),this._targetsEventListeners.set(e,i)),i.addEventListener(t,n,r)}removeEventListener(e,t,n,r){const i=this._targetsEventListeners.get(e);i&&(i.removeEventListener(t,n,r),i.isEmpty&&this._targetsEventListeners.delete(e))}reset(){Array.from(this._targetsEventListeners.entries()).forEach((([e,t])=>{t.reset(),this._targetsEventListeners.delete(e)}))}}var l=n(50134),c=n(40256),u=n(70210),d=n(74657);function f(e,t){const n=e.getSize();for(let r=0;r<n;r++){const n=[];e.getNodeValue(r,n),n[1]=n[1]*t,n[2]=n[2]*t,n[3]=n[3]*t,e.setNodeValue(r,n)}}var g=n(69372),m=n(80221),h=n(25308);const p=Symbol("LastRuntimeId"),v={},y=4294967295,w="-";function I(e,t,n){return function(e,t,n){let r=e[t];r instanceof Array||(r=[0],Object.defineProperty(e,t,{value:r}));for(let e=!0,t=0;e&&t<r.length;++t){let i=0|r[t];i<n?(e=!1,i+=1):(i=0,t+1===r.length&&r.push(0)),r[t]=i}return r}(null!==e&&"object"==typeof e?e:v,p,("number"==typeof n&&n>0?n:y)>>>0).join("string"==typeof t?t:w)}var A=n(39537);const P={},b={add:(e,t)=>{const n=(0,A.A)(e);P[n]=t},get:(e,t)=>{if("calibratedPixelSpacing"===e){const e=(0,A.A)(t);return P[e]}}};var S=n(84061),E=n(74638);function T(e,t,n=1e-5){return Math.abs(e[0]+t[0])<n&&Math.abs(e[1]+t[1])<n&&Math.abs(e[2]+t[2])<n}var x=n(88619),_=n(85008),M=n(65292),C=n(15105);function R(e,t){return!(e[0]<0||e[0]>=t[0]||e[1]<0||e[1]>=t[1]||e[2]<0||e[2]>=t[2])}var D=n(39536);const O=function(e,t){let n;n=t?[(0,D.lD)(t)]:(0,D.qO)();const r=[];return n.forEach((t=>{const n=e.getActors(),i=t.getVolumeViewports();for(const e of i){const t=e.getActors();if(t.length!==n.length)continue;n.every((({uid:e})=>t.find((t=>e===t.uid))))&&r.push(e)}})),r};var V=n(24724),L=n(38669),N=n(94741),F=n(80068),W=n(74876),U=n(31749),k=n(51159),j=n(30135),B=n(56706);const z=e=>e.preScale.scaled&&e.preScale.scalingParameters.suvbw;function G(e,t,n=void 0,r="_thumbnails",i={displayArea:{imageArea:[1,1]}}){if(!(e&&e instanceof HTMLCanvasElement))throw new Error("canvas element is required");const o=!t.imageId,a=!o&&t,s=o&&t,l=`renderGPUViewport-${a.imageId||s.volumeId}`,c=document.createElement("div"),u=window.devicePixelRatio||1;i.displayArea||(i.displayArea={imageArea:[1,1]});const d=e.width,f=e.height;c.style.width=`${d/u+j.p8}px`,c.style.height=`${f/u+j.p8}px`,c.style.visibility="hidden",c.style.position="absolute",document.body.appendChild(c);const g=l.split(":").join("-");c.setAttribute("viewport-id-for-remove",g);const m=(0,j.Ay)(c),h=(0,D.lD)(r)||new B.Ay(r);let p=h.getViewport(l);if(!p){const e={viewportId:l,type:o?U.ViewportType.ORTHOGRAPHIC:U.ViewportType.STACK,element:c,defaultOptions:{...i,suppressEvents:!0}};h.enableElement(e),p=h.getViewport(l)}return new Promise((r=>{let d=!1,{viewReference:f}=i;const v=t=>{if(d)return;if(f){const e=f;return f=null,p.setViewReference(e),void p.render()}e.getContext("2d").drawImage(m,0,0,m.width,m.height,0,0,e.width,e.height);const n=p.canvasToWorld([0,0]),i=p.canvasToWorld([m.width/u,0]),o=p.canvasToWorld([0,m.height/u]);d=!0,c.removeEventListener(U.Events.IMAGE_RENDERED,v),setTimeout((()=>{h.disableElement(l);document.querySelectorAll(`[viewport-id-for-remove="${g}"]`).forEach((e=>{e.remove()}))}),0),r({origin:n,bottomLeft:o,topRight:i,thicknessMm:1})};c.addEventListener(U.Events.IMAGE_RENDERED,v),o?p.setVolumes([s],!1,!0):p.renderImageObject(t),p.resetCamera(),"PT"!==n||z(a)||p.setProperties({voiRange:{lower:a.minPixelValue,upper:a.maxPixelValue}}),p.render()}))}var H=n(36931),Y=n(7808),q=n(5057);function $(e,t,n,r,i){if(t.volumeId)throw new Error("Unsupported volume rendering for CPU");const o=t,a={canvas:e,viewport:(0,H.A)(e,o,n),image:o,renderingTools:{}};a.transform=(0,Y.A)(a);return new Promise(((e,t)=>{(0,q.A)(a,true),e(null)}))}n(59693);var X=n(49038);function J(e){const{canvas:t,imageId:n,viewReference:r,requestType:i=U.RequestType.Thumbnail,priority:o=-5,renderingEngineId:a="_thumbnails",useCPURendering:s=!1,thumbnail:l=!1,imageAspect:c=!1,viewportOptions:u}=e,d=r?.volumeId,f=d&&!n,g=r&&u?{...u,viewReference:r}:u,m=s?$:G;return new Promise(((e,r)=>{function u(n,i){const{modality:o}=W.get("generalSeriesModule",i)||{},u=!f&&n,d=f&&n;u&&(u.isPreScaled=u.isPreScaled||u.preScale?.scaled),l&&(t.height=256,t.width=256),c&&u&&(t.width=u&&t.height*u.width/u.height),t.style.width=t.width/devicePixelRatio+"px",t.style.height=t.height/devicePixelRatio+"px",d&&s&&r(new Error("CPU rendering of volume not supported")),m(t,n,o,a,g).then(e)}function h(e,t){console.error(e,t),r(e)}const p={useRGBA:!!s,requestType:i};if(d){const e=X.Ay.getVolume(d);e||r(new Error(`Volume id ${d} not found in cache`));u(e,e.imageIds[0])}else k.A.addRequest(function(e,t,n){return(0,F.loadAndCacheImage)(e,n).then((t=>{u.call(this,t,e)}),(t=>{h.call(this,t,e)}))}.bind(null,n,null,p),i,{imageId:n},o)}))}var K=n(3823);const Z=function(e,t){const n=(0,W.get)("imagePlaneModule",e);if(!n)throw new Error(`No imagePlaneModule found for imageId: ${e}`);const{columnCosines:r,rowCosines:i,imagePositionPatient:o}=n;let{columnPixelSpacing:a,rowPixelSpacing:s}=n;a||=1,s||=1;const l=K.eR.create();K.eR.scaleAndAdd(l,o,r,-a/2),K.eR.scaleAndAdd(l,l,i,-s/2);const c=K.eR.create();return K.eR.sub(c,t,l),[K.eR.dot(c,i)/s,K.eR.dot(c,r)/a]};function Q(e,t){const n=(0,W.get)("imagePlaneModule",e);if(!n)throw new Error(`No imagePlaneModule found for imageId: ${e}`);const{columnCosines:r,rowCosines:i,imagePositionPatient:o}=n;let{columnPixelSpacing:a,rowPixelSpacing:s}=n;a||=1,s||=1;const l=K.eR.create();return K.eR.scaleAndAdd(l,o,i,s*(t[0]-.5)),K.eR.scaleAndAdd(l,l,r,a*(t[1]-.5)),Array.from(l)}var ee=n(4031),te=n(61375),ne=n(20537),re=n(80500),ie=n(47476),oe=n(98039);function ae(e){const t=(0,D.qO)(),n=[];return t.forEach((t=>{t.getViewports().forEach((t=>{t.hasImageURI(e)&&n.push(t)}))})),n}var se=n(52268);function le(e,t){const n=function(e,t){const n=t.getImageIds(),r=t.getCurrentImageIdIndex();if(0===n.length)return null;const i=t=>{const n=function(e){const t=W.get("imagePlaneModule",e);if(!(t&&t.rowCosines instanceof Array&&3===t.rowCosines.length&&t.columnCosines instanceof Array&&3===t.columnCosines.length&&t.imagePositionPatient instanceof Array&&3===t.imagePositionPatient.length))return null;const{rowCosines:n,columnCosines:r,imagePositionPatient:i}=t,o=K.eR.set(K.eR.create(),...n),a=K.eR.set(K.eR.create(),...r),s=K.eR.cross(K.eR.create(),o,a);return{rowCosines:n,columnCosines:r,imagePositionPatient:i,planeNormal:s}}(t);if(!n)return null;const r=se.planeEquation(n.planeNormal,n.imagePositionPatient);return se.planeDistanceToPoint(r,e)},o={distance:i(n[r])??1/0,index:r},a=n.slice(r+1);for(let e=0;e<a.length;e++){const t=i(a[e]);if(null!==t){if(!(t<=o.distance))break;o.distance=t,o.index=e+r+1}}const s=n.slice(0,r);for(let e=s.length-1;e>=0;e--){const t=i(s[e]);if(null!==t&&t!==o.distance){if(!(t<o.distance))break;o.distance=t,o.index=e}}return o.distance===1/0?null:o}(e,t);return n?n.index:null}var ce=n(51919);function ue(e){const{width:t,height:n}=e.getCanvas(),{sliceToIndexMatrix:r,indexToSliceMatrix:i}=e.getSliceViewInfo(),o=(0,ce.e)(e,[0,0]),a=(0,ce.e)(e,[t-1,0]),s=(0,ce.e)(e,[0,n-1]),l=K.eR.sub(K.eR.create(),a,o),c=K.eR.sub(K.eR.create(),s,o),u=K.eR.cross(K.eR.create(),l,c);K.eR.normalize(l,l),K.eR.normalize(c,c),K.eR.normalize(u,u);const d=Math.max(Math.abs(l[0]),Math.abs(l[1]),Math.abs(l[2])),f=Math.max(Math.abs(c[0]),Math.abs(c[1]),Math.abs(c[2]));if(!K.Fd.equals(1,d)||!K.Fd.equals(1,f))throw new Error("Livewire is not available for rotate/oblique viewports");const{voxelManager:g}=e.getImageData(),m=e.getSliceViewInfo(),h=g.getSliceData(m);return{width:m.width,height:m.height,scalarData:h,sliceToIndexMatrix:r,indexToSliceMatrix:i}}const de={},fe={add:(e,t)=>{const[n,r]=e,i=`${n}_${r}`;de[i]||(de[i]={}),de[i]=t},get:(e,t,n)=>{if("spatialRegistrationModule"!==e)return;const r=`${t}_${n}`;if(de[r])return de[r];const i=`${n}_${t}`;return de[i]?K.pB.invert(K.pB.create(),de[i]):void 0}};(0,W.addProvider)(fe.get.bind(fe));const ge=fe;const me=function(e,t){const n=e.getSliceIndex(),r=t.getSliceIndex(),i=(0,W.get)("imagePlaneModule",n.toString()),o=(0,W.get)("imagePlaneModule",r.toString());if(!i||!o)return void console.log("Viewport spatial registration requires image plane module");const{imageOrientationPatient:a}=o;if(!i.imageOrientationPatient.every(((e,t)=>Math.abs(e-a[t])<.05)))return void console.log("Viewport spatial registration only supported for same orientation (hence translation only) for now",i?.imageOrientationPatient,o?.imageOrientationPatient);const s=i.imagePositionPatient,l=o.imagePositionPatient,c=K.eR.subtract(K.eR.create(),s,l),u=K.pB.fromTranslation(K.pB.create(),c);ge.add([e.id,t.id],u)};function he(e){const{imageData:t,dimensions:n}=e.getImageData(),{canvas:r}=e,i=window.devicePixelRatio,o=[r.width/i,0],a=[r.width/i,r.height/i],s=[0,r.height/i],l=e.canvasToWorld([0,0]),c=e.canvasToWorld(o),u=e.canvasToWorld(a),d=e.canvasToWorld(s),f=t.worldToIndex(l),g=t.worldToIndex(c),m=t.worldToIndex(u),h=t.worldToIndex(d);return function({dimensions:e,imageData:t,topLeftImage:n,topRightImage:r,bottomRightImage:i,bottomLeftImage:o,topLeftWorld:a,topRightWorld:s,bottomRightWorld:l,bottomLeftWorld:c}){const u=pe(n,e)?a:t.indexToWorld([0,0,0]),d=pe(r,e)?s:t.indexToWorld([e[0]-1,0,0]),f=pe(i,e)?l:t.indexToWorld([e[0]-1,e[1]-1,0]),g=pe(o,e)?c:t.indexToWorld([0,e[1]-1,0]);return[u,d,g,f]}({dimensions:n,imageData:t,topLeftImage:f,topRightImage:g,bottomRightImage:m,bottomLeftImage:h,topLeftWorld:l,topRightWorld:c,bottomRightWorld:u,bottomLeftWorld:d})}function pe(e,t){return e[0]>0||e[0]<t[0]-1||e[1]>0||e[1]<t[1]-1||e[2]>0||e[2]<t[2]-1}var ve=n(38883),ye=n(96833);class we{constructor(e={}){this._dimensions=3,this._length=0,this._byteSize=4,this.growSize=128;const{initialSize:t=1024,dimensions:n=3,growSize:r=128}=e,i=t*n;this.growSize=r,this.array=new ArrayBuffer(i*this._byteSize),this.data=new Float32Array(this.array),this._dimensions=n}forEach(e){for(let t=0;t<this._length;t++)e(this.getPoint(t),t)}get length(){return this._length}get dimensions(){return this._dimensions}get dimensionLength(){return this._length*this._dimensions}getPoint(e){if(e<0&&(e+=this._length),e<0||e>=this._length)return;const t=this._dimensions*e;return this.data.subarray(t,t+this._dimensions)}getPointArray(e){const t=[];if(e<0&&(e+=this._length),e<0||e>=this._length)return;const n=this._dimensions*e;for(let e=0;e<this._dimensions;e++)t.push(this.data[e+n]);return t}grow(e=1,t=this.growSize){if(this.dimensionLength+e*this._dimensions<=this.data.length)return;const n=this.data.length+t,r=new ArrayBuffer(n*this._dimensions*this._byteSize),i=new Float32Array(r);i.set(this.data),this.data=i,this.array=r}reverse(){const e=Math.floor(this._length/2);for(let t=0;t<e;t++){const e=t*this._dimensions,n=(this._length-1-t)*this._dimensions;for(let t=0;t<this._dimensions;t++){const r=this.data[e+t];this.data[e+t]=this.data[n+t],this.data[n+t]=r}}}push(e){this.grow(1);const t=this.length*this._dimensions;for(let n=0;n<this._dimensions;n++)this.data[n+t]=e[n];this._length++}map(e){const t=[];for(let n=0;n<this._length;n++)t.push(e(this.getPoint(n),n));return t}get points(){return this.map((e=>e))}toXYZ(){const e={x:[],y:[]};this._dimensions>=3&&(e.z=[]);const{x:t,y:n,z:r}=e;return this.forEach((e=>{t.push(e[0]),n.push(e[1]),r&&r.push(e[2])})),e}static fromXYZ({x:e,y:t,z:n}){const r=we.create3(e.length);let i=0;for(let o=0;o<e.length;o++)r.data[i++]=e[o],r.data[i++]=t[o],r.data[i++]=n?n[o]:0;return r._length=e.length,r}subselect(e=10,t=0){const n=new we({initialSize:e,dimensions:this._dimensions});for(let r=0;r<e;r++){const i=(t+Math.floor(this.length*r/e))%this.length;n.push(this.getPoint(i))}return n}static create3(e=128){return new we({initialSize:e,dimensions:3})}static create2(e=128){return new we({initialSize:e,dimensions:2})}}var Ie=n(74268),Ae=n(32173),Pe=n(58165),be=n(86846);const Se=function(e){const t=(0,be.Ay)(e);if(!t)return;const{viewport:n}=t;if(!(n instanceof Pe.A))throw new Error(`An image can only be fetched for a stack viewport and not for a viewport of type: ${n.type}`);return n.getCornerstoneImage()};var Ee=n(90537),Te=n(1865),xe=n(27119);function _e(e){const t=e[0],{modality:n,seriesInstanceUID:r}=W.get("generalSeriesModule",t),{imageOrientationPatient:i,pixelSpacing:o,frameOfReferenceUID:a,columns:s,rows:l}=W.get("imagePlaneModule",t),c={modality:n,imageOrientationPatient:i,pixelSpacing:o,frameOfReferenceUID:a,columns:s,rows:l,seriesInstanceUID:r},u=e.every((e=>{const{modality:t,seriesInstanceUID:n}=W.get("generalSeriesModule",e),{imageOrientationPatient:r,pixelSpacing:i,columns:o,rows:a}=W.get("imagePlaneModule",e);return n===c.seriesInstanceUID&&t===c.modality&&o===c.columns&&a===c.rows&&(0,E.Ay)(r,c.imageOrientationPatient)&&(0,E.Ay)(i,c.pixelSpacing)}));return u}var Me=n(45278),Ce=n(22191),Re=n(63470),De=n(17791);const Oe=new Set(["1.2.840.10008.1.2.4.100","1.2.840.10008.1.2.4.100.1","1.2.840.10008.1.2.4.101","1.2.840.10008.1.2.4.101.1","1.2.840.10008.1.2.4.102","1.2.840.10008.1.2.4.102.1","1.2.840.10008.1.2.4.103","1.2.840.10008.1.2.4.103.1","1.2.840.10008.1.2.4.104","1.2.840.10008.1.2.4.104.1","1.2.840.10008.1.2.4.105","1.2.840.10008.1.2.4.105.1","1.2.840.10008.1.2.4.106","1.2.840.10008.1.2.4.106.1","1.2.840.10008.1.2.4.107","1.2.840.10008.1.2.4.108"]);function Ve(e){if(!e)return!1;return(Array.isArray(e)?e:[e]).find((e=>Oe.has(e)))}var Le=n(99576),Ne=n(9734),Fe=n(98834),We=n(39561);async function Ue({viewport:e,options:t={}}){const n=e.getRenderingEngine();let r=t.volumeId||`${(0,m.A)()}`;if(0===r.split(":").length){r=`${(0,We.getUnknownVolumeLoaderSchema)()}:${r}`}const{id:i,element:o}=e,a=t.viewportId||i,s=e.getImageIds(),l=e.getViewPresentation(),c=e.getViewReference();n.enableElement({viewportId:a,type:U.ViewportType.ORTHOGRAPHIC,element:o,defaultOptions:{background:t.background,orientation:t.orientation}});(await(0,We.createAndCacheVolume)(r,{imageIds:s})).load();const u=n.getViewport(a);await(0,Fe.A7)(n,[{volumeId:r}],[a]);const d=()=>{u.render(),o.removeEventListener(U.Events.VOLUME_VIEWPORT_NEW_VOLUME,d)};return o.addEventListener(U.Events.VOLUME_VIEWPORT_NEW_VOLUME,d),u.setViewPresentation(l),u.setViewReference(c),u.render(),u}var ke=n(86252);async function je({viewport:e,options:t}){const n=e,{id:r,element:i}=n,o=e.getRenderingEngine(),{background:a}=t,s=t.viewportId||r,l=X.Ay.getVolume(n.getVolumeId());if(!(l instanceof ke.Q))throw new Error("Currently, you cannot decache a volume that is not an ImageVolume. So, unfortunately, volumes such as nifti  (which are basic Volume, without imageIds) cannot be decached.");const c={viewportId:s,type:U.ViewportType.STACK,element:i,defaultOptions:{background:a}},u=n.getViewReference();o.enableElement(c);const d=o.getViewport(s);return await d.setStack(l.imageIds),d.setViewReference(u),d.render(),d}var Be=n(24623),ze=n(67645),Ge=n(19325);function He(e){return Math.round(e/Ge.EPSILON)*Ge.EPSILON}const Ye=function e(t,n=2){if(Array.isArray(t))return t.map((t=>e(t,n))).join(", ");if(null==t||""===t)return"NaN";t=Number(t);const r=Math.abs(t);if(r<1e-4)return`${t}`;const i=r>=100?n-2:r>=10?n-1:r>=1?n:r>=.1?n+1:r>=.01?n+2:r>=.001?n+3:n+4;return t.toFixed(i)};function qe(e,t,n){const r=e.length===t*n*4,i=e.length===t*n*3;if(r||i){const i=new Float32Array(t*n);let o=0,a=0;const s=r?4:3;for(let r=0;r<t;r++)for(let t=0;t<n;t++){const t=e[o],n=e[o+1],r=e[o+2];i[a]=(t+n+r)/3,o+=s,a++}return i}return e}const $e=function(e){if(e instanceof B.PX){return X.Ay.getVolume(e.getVolumeId()).imageIds}if(e.getImageIds)return e.getImageIds()};function Xe(e,t){const n=[...e];return t>=n.length?(Je(n),n):(Je(n),n.slice(0,t))}function Je(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}}var Ke=n(12437),Ze=n(30169),Qe=n(56577),et=n(68136),tt=n(13859),nt=n(85745);function rt(e){const t=e.toString(16);return 1==t.length?"0"+t:t}function it(e,t,n){return"#"+rt(e)+rt(t)+rt(n)}function ot(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}function at(e,t){if(e===t)return!0;if(null==e||null==t)return!1;try{return JSON.stringify(e)===JSON.stringify(t)}catch(n){return console.debug("Error in JSON.stringify during deep comparison:",n),e===t}}const st=(e,t)=>e.reduce(((e,n)=>((e[n[t]]=e[n[t]]||[]).push(n),e)),{});function lt(e,t){const n={};let r=[];const i=Object.keys(e);for(let o=0;o<i.length;o++){const a=new Set,s=e[i[o]];for(let e=0;e<s.length;e++){const r=t(s[e].imageId)||0;if(n[r]=n[r]||[],n[r].push({imageId:s[e].imageId}),a.add(r),a.size-1<e)return}if(0==o)r=Array.from(a);else if(!gt(r,a))return}return n}function ct(e,t){const n=W.get(t,e);try{return parseFloat(n)}catch{return}}function ut(e){const t=W.get("20011003",e);try{const{InlineBinary:e}=t;if(e){const t=atob(e),n=new ArrayBuffer(t.length),r=new DataView(n);for(let e=0;e<t.length;e++)r.setUint8(e,t.charCodeAt(e));return new Float32Array(n)[0]}return parseFloat(t)}catch{return}}function dt(e){let t=W.get("0019100c",e)||W.get("0019100C",e);try{const{InlineBinary:e}=t;return e&&(t=atob(e)),parseFloat(t)}catch{return}}function ft(e){let t=W.get("00431039",e);try{const{InlineBinary:e}=t;return e&&(t=atob(e).split("//")),parseFloat(t[0])%1e5}catch{return}}function gt(e,t){if(e.length!=t.size)return!1;for(let n=0;n<e.length;n++)if(!t.has(e[n]))return!1;return!0}function mt(e){const t=W.get("petImageModule",e);return t?t.frameReferenceTime:0}const ht=function(e){const t=function(e){const t=e.map((e=>{const{imagePositionPatient:t}=W.get("imagePlaneModule",e)||{};return{imageId:e,imagePositionPatient:t}}));if(!t.every((e=>e.imagePositionPatient)))return null;const n=st(t,"imagePositionPatient"),r=Object.keys(n),i=n[r[0]].length;return 1===i?null:r.every((e=>n[e].length===i))?n:null}(e);if(!t)return{imageIdGroups:[e],splittingTag:null};const n=["TemporalPositionIdentifier","DiffusionBValue","TriggerTime","EchoTime","EchoNumber","PhilipsPrivateBValue","SiemensPrivateBValue","GEPrivateBValue","PetFrameReferenceTime"],r=[e=>ct(e,n[0]),e=>ct(e,n[1]),e=>ct(e,n[2]),e=>ct(e,n[3]),e=>ct(e,n[4]),ut,dt,ft,mt];for(let e=0;e<r.length;e++){const i=lt(t,r[e]);if(i){return{imageIdGroups:Object.keys(i).map(Number.parseFloat).sort(((e,t)=>e-t)).map((e=>i[e].map((e=>e.imageId)))),splittingTag:n[e]}}}return{imageIdGroups:[e],splittingTag:null}};const pt=function(e){const{imageIdGroups:t,splittingTag:n}=ht(e);return{isDynamicVolume:t.length>1,timePoints:t,splittingTag:n}};var vt=n(91979);function yt(e,t){const n=e.length,{rescaleSlope:r,rescaleIntercept:i,suvbw:o}=t;if("PT"===t.modality&&"number"==typeof o)for(let t=0;t<n;t++)e[t]=o*(e[t]*r+i);else for(let t=0;t<n;t++)e[t]=e[t]*r+i;return e}var wt=n(99949);function It(e,t,n){return Math.min(Math.max(t,e),n)}const At=It;var Pt=n(10364);function bt(e,t){if(!(0,be.Ay)(e.element))throw new Error("Scroll::Viewport is not enabled (it might be disabled)");if(e instanceof B.hS&&0===e.getImageIds().length)throw new Error("Scroll::Stack Viewport has no images");const{volumeId:n,delta:r,scrollSlabs:i}=t;if(e instanceof B.PX)!function(e,t,n,r=!1){const i=r,{numScrollSteps:o,currentStepIndex:a,sliceRangeInfo:s}=(0,te.A)(e,t,i);if(!s)return;const{sliceRange:l,spacingInNormalDirection:c,camera:u}=s,{focalPoint:d,viewPlaneNormal:f,position:m}=u,{newFocalPoint:h,newPosition:p}=(0,re.A)(d,m,l,f,c,n);e.setCamera({focalPoint:h,position:p}),e.render();const v=a+n,y={volumeId:t,viewport:e,delta:n,desiredStepIndex:v,currentStepIndex:a,numScrollSteps:o,currentImageId:e.getCurrentImageId()};(v>o||v<0)&&e.getCurrentImageId()?(0,g.A)(Pt.A,U.Events.VOLUME_VIEWPORT_SCROLL_OUT_OF_BOUNDS,y):(0,g.A)(Pt.A,U.Events.VOLUME_VIEWPORT_SCROLL,y)}(e,n,r,i);else{const n=e.getCurrentImageIdIndex();if(n+r>e.getImageIds().length-1||n+r<0){const e={imageIdIndex:n,direction:r};(0,g.A)(Pt.A,U.Events.STACK_SCROLL_OUT_OF_BOUNDS,e)}e.scroll(r,t.debounceLoading,t.loop)}}async function St(e,t={}){const{imageIndex:n,debounceLoading:r,volumeId:i}=t,o=(0,be.Ay)(e);if(!o)throw new Error("Element has been disabled");const{viewport:a}=o,{imageIndex:s,numberOfSlices:l}=function(e,t){if(e instanceof Pe.A)return{numberOfSlices:e.getImageIds().length,imageIndex:t?e.getTargetImageIdIndex():e.getCurrentImageIdIndex()};return{numberOfSlices:e.getNumberOfSlices(),imageIndex:e.getSliceIndex()}}(a,r),c=function(e,t){const n=e-1;return At(t,0,n)}(l,n);bt(a,{delta:c-s,debounceLoading:r,volumeId:i})}const Et=(e,t)=>function(e,t,n){if(!n)throw new Error("getVolume is required, use the utilities export instead ");if(e.modality)return e.modality;if(e.setVolumes){if(!(t=t??e.getVolumeId())||!n)return;return n(t).metadata.Modality}throw new Error("Invalid viewport type")}(e,t,X.Ay.getVolume)},50134:(e,t,n)=>{function r(e){if(!e)return;const t=e.getSize();for(let n=0;n<t;n++){const t=[];e.getNodeValue(n,t),t[1]=1-t[1],t[2]=1-t[2],t[3]=1-t[3],e.setNodeValue(n,t)}}n.d(t,{A:()=>r})},74638:(e,t,n)=>{function r(e,t,n){return Math.abs(e-t)<=n}function i(e){return"number"==typeof e}function o(e){return e&&"object"==typeof e&&"length"in e&&"number"==typeof e.length&&e.length>0&&"number"==typeof e[0]}function a(e,t,n=1e-5){return typeof e==typeof t&&null!==e&&null!==t&&(i(e)&&i(t)?r(e,t,n):!(!o(e)||!o(t))&&function(e,t,n=1e-5){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!r(e[i],t[i],n))return!1;return!0}(e,t,n))}n.d(t,{Ay:()=>a,Ph:()=>u,WC:()=>c,n4:()=>a});const s=e=>"number"==typeof e?-e:e?.map?e.map(s):!e,l=e=>"number"==typeof e?Math.abs(e):e?.map?e.map(l):e,c=(e,t,n=void 0)=>a(e,s(t),n),u=(e,t,n=void 0)=>a(l(e),l(t),n)},1865:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(74876);function i(e){const t=e[0],{pixelRepresentation:n,bitsAllocated:i,bitsStored:o,highBit:a,photometricInterpretation:s,samplesPerPixel:l}=(0,r.get)("imagePixelModule",t),c=[],u=(0,r.get)("voiLutModule",t);let d;if(u){const{windowWidth:e,windowCenter:t}=u;if(d=u?.voiLUTFunction,Array.isArray(e))for(let n=0;n<e.length;n++)c.push({windowWidth:e[n],windowCenter:t[n]});else c.push({windowWidth:e,windowCenter:t})}else c.push({windowWidth:void 0,windowCenter:void 0});const{modality:f,seriesInstanceUID:g}=(0,r.get)("generalSeriesModule",t),{imageOrientationPatient:m,pixelSpacing:h,frameOfReferenceUID:p,columns:v,rows:y}=(0,r.get)("imagePlaneModule",t);return{BitsAllocated:i,BitsStored:o,SamplesPerPixel:l,HighBit:a,PhotometricInterpretation:s,PixelRepresentation:n,Modality:f,ImageOrientationPatient:m,PixelSpacing:h,FrameOfReferenceUID:p,Columns:v,Rows:y,voiLut:c,VOILUTFunction:d,SeriesInstanceUID:g}}},52268:(e,t,n)=>{n.r(t),n.d(t,{linePlaneIntersection:()=>i,planeDistanceToPoint:()=>s,planeEquation:()=>o,threePlaneIntersection:()=>a});var r=n(3823);function i(e,t,n){const[r,i,o]=e,[a,s,l]=t,[c,u,d,f]=n,g=a-r,m=s-i,h=l-o,p=-1*(c*r+u*i+d*o-f)/(c*g+u*m+d*h);return[g*p+r,m*p+i,h*p+o]}function o(e,t,n=!1){const[r,i,o]=e,a=r*t[0]+i*t[1]+o*t[2];if(n){const e=Math.sqrt(r*r+i*i+o*o);return[r/e,i/e,o/e,a/e]}return[r,i,o,a]}function a(e,t,n){const[i,o,a,s]=e,[l,c,u,d]=t,[f,g,m,h]=n,p=r.w0.fromValues(i,l,f,o,c,g,a,u,m),v=r.w0.fromValues(s,d,h,o,c,g,a,u,m),y=r.w0.fromValues(i,l,f,s,d,h,a,u,m),w=r.w0.fromValues(i,l,f,o,c,g,s,d,h);return[r.w0.determinant(v)/r.w0.determinant(p),r.w0.determinant(y)/r.w0.determinant(p),r.w0.determinant(w)/r.w0.determinant(p)]}function s(e,t,n=!1){const[r,i,o,a]=e,[s,l,c]=t,u=r*s+i*l+o*c-a,d=Math.abs(u)/Math.sqrt(r*r+i*i+o*o);return(n?Math.sign(u):1)*d}},56577:(e,t,n)=>{n.d(t,{i:()=>i});var r=n(3823);function i(e,t){const{pointInShapeFn:n,callback:i,boundsIJK:o,returnPoints:a=!1}=t;let s,l,c,u,d,f,g;const{numComps:m}=e;if(g=e.getScalarData?e.getScalarData():e.getPointData().getScalars().getData(),!g)return void console.warn("No scalar data found for imageData",e);const h=e.getDimensions();o?[[s,l],[c,u],[d,f]]=o:(s=0,l=h[0],c=0,u=h[1],d=0,f=h[2]);const p=r.eR.fromValues(s,c,d),v=e.getDirection(),y=v.slice(0,3),w=v.slice(3,6),I=v.slice(6,9),A=e.getSpacing(),[P,b,S]=A,E=e.indexToWorld(p),T=r.eR.fromValues(y[0]*P,y[1]*P,y[2]*P),x=r.eR.fromValues(w[0]*b,w[1]*b,w[2]*b),_=r.eR.fromValues(I[0]*S,I[1]*S,I[2]*S),M=m||g.length/h[2]/h[1]/h[0],C=h[0]*M,R=h[1]*C,D=[],O=r.eR.clone(E);for(let e=d;e<=f;e++){const t=r.eR.clone(O);for(let t=c;t<=u;t++){const o=r.eR.clone(O);for(let o=s;o<=l;o++){const a=[o,t,e];if(n(O,a)){const n=e*R+t*C+o*M;let r;r=M>2?[g[n],g[n+1],g[n+2]]:g[n],D.push({value:r,index:n,pointIJK:a,pointLPS:O.slice()}),i&&i({value:r,index:n,pointIJK:a,pointLPS:O})}r.eR.add(O,O,T)}r.eR.copy(O,o),r.eR.add(O,O,x)}r.eR.copy(O,t),r.eR.add(O,O,_)}return a?D:void 0}},80500:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(3823);function i(e,t,n,i,o,a){const{min:s,max:l,current:c}=n,u=r.eR.create();r.eR.sub(u,t,e);const d=Math.round((l-s)/o),f=(c-s)/(l-s)*d;let g=Math.round(f),m=[e[0]-i[0]*f*o,e[1]-i[1]*f*o,e[2]-i[2]*f*o];g+=a,g>d?g=d:g<0&&(g=0);const h=g*o;m=[m[0]+i[0]*h,m[1]+i[1]*h,m[2]+i[2]*h];return{newFocalPoint:m,newPosition:[m[0]+u[0],m[1]+u[1],m[2]+u[2]]}}},90537:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(3823),i=n(74876),o=n(59693);function a(e,t){const{imagePositionPatient:n,imageOrientationPatient:a}=i.get("imagePlaneModule",e[0]);if(!t){const e=r.eR.fromValues(a[0],a[1],a[2]),n=r.eR.fromValues(a[3],a[4],a[5]);t=r.eR.create(),r.eR.cross(t,e,n)}const s=r.eR.create(),l="wadouri"===e[0].split(":")[0];let c,u;function d(e){const{imagePositionPatient:o}=i.get("imagePlaneModule",e),a=r.eR.create();return r.eR.sub(a,n,o),r.eR.dot(a,t)}if(r.eR.set(s,n[0],n[1],n[2]),l){const o=[e[0],e[Math.floor(e.length/2)]];c=e;d(o[0])-d(o[1])<0&&c.reverse();const a=i.get("imagePlaneModule",o[1]);if(!a)throw new Error("Incomplete metadata required for volume construction.");const s=r.eR.create();r.eR.sub(s,n,a.imagePositionPatient);const l=r.eR.dot(s,t);u=Math.abs(l)/Math.floor(e.length/2)}else{const t=e.map((e=>({distance:d(e),imageId:e})));t.sort(((e,t)=>t.distance-e.distance)),c=t.map((e=>e.imageId));const n=t.length;u=Math.abs(t[n-1].distance-t[0].distance)/(n-1)}const{imagePositionPatient:f,sliceThickness:g,spacingBetweenSlices:m}=i.get("imagePlaneModule",c[0]),{strictZSpacingForVolumeViewport:h}=(0,o.D0)().rendering;0!==u||h||(g&&m?(console.log("Could not calculate zSpacing. Using spacingBetweenSlices"),u=m):g?(console.log("Could not calculate zSpacing and no spacingBetweenSlices. Using sliceThickness"),u=g):(console.log("Could not calculate zSpacing. The VolumeViewport visualization is compromised. Setting zSpacing to 1 to render"),u=1));return{zSpacing:u,origin:f,sortedImageIds:c}}},85745:(e,t,n)=>{function r(e){const t=e.getSize(),n=[];for(let r=0;r<t;r++){const t=[];e.getNodeValue(r,t),n.push(t)}return n}function i(e,t){t?.length&&(e.removeAllPoints(),t.forEach((t=>{e.addRGBPoint(...t)})))}n.r(t),n.d(t,{getTransferFunctionNodes:()=>r,setTransferFunctionNodes:()=>i})},51919:(e,t,n)=>{n.d(t,{e:()=>i});var r=n(38669);function i(e,t){const{imageData:n}=e.getImageData(),i=e.canvasToWorld(t);return(0,r.A)(n,i)}},94741:(e,t,n)=>{function r(e,t){return e.indexToWorld(t)}n.d(t,{A:()=>r})},38669:(e,t,n)=>{function r(e,t){return e.worldToIndex(t).map(Math.round)}n.d(t,{A:()=>r})},45278:(e,t,n)=>{function r(e,t){const n=t.voxelManager.getScalarData();if(!e.getPointData)return;const r=e.getPointData().getScalars().getData();if(t.color&&t.rgba){const e=new Uint8Array(t.columns*t.rows*3);for(let r=0;r<t.columns*t.rows;r++)e[3*r]=n[4*r],e[3*r+1]=n[4*r+1],e[3*r+2]=n[4*r+2];t.rgba=!1,t.getPixelData=()=>e,r.set(e)}else r.set(n);e.modified()}n.d(t,{J:()=>r})},68136:(e,t,n)=>{function r(e,t){return{windowWidth:Math.abs(t-e)+1,windowCenter:(e+t+1)/2}}function i(e,t){return{lower:t-.5-(e-1)/2,upper:t-.5+(e-1)/2}}n.r(t),n.d(t,{toLowHighRange:()=>i,toWindowLevel:()=>r})},25810:(e,t,n)=>{var r=n(99178),i=(n(31749),n(19325));n(56706),n(61640),n(92099),n(30135),n(94155),n(40893),n(46347),n(58165),n(32501),n(81466),n(10056),n(10364),n(39536),n(58927),n(49038),n(91073),n(51159),n(86846),n(74876),n(59693);const o=Symbol("DefaultSettings"),a=Symbol("RuntimeSettings"),s=Symbol("ObjectSettingsMap"),l=Symbol("Dictionary");class c{constructor(e){const t=Object.create(e instanceof c&&l in e?e[l]:null);Object.seal(Object.defineProperty(this,l,{value:t}))}set(e,t){return d(this[l],e,t,null)}get(e){return function(e,t){return e[t]}(this[l],e)}unset(e){return function(e,t){if(t.endsWith(".")){let n=0;const r=t,i=r.slice(0,-1),o=0===i.length;for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(o||t.startsWith(r)||t===i)&&(delete e[t],++n);return n>0}return delete e[t]}(this[l],e+"")}forEach(e){u(this[l],e)}extend(){return new c(this)}import(e){f(e)&&Object.keys(e).forEach((t=>{d(this[l],t,e[t],null)}))}dump(){const e={};return u(this[l],((t,n)=>{void 0!==n&&g(e,t,n)})),e}static assert(e){return e instanceof c?e:c.getRuntimeSettings()}static getDefaultSettings(e=null){let t=c[o];if(t instanceof c||(t=new c,c[o]=t),e){const n={};return t.forEach((r=>{if(r.startsWith(e)){const i=r.split(`${e}.`)[1];n[i]=t.get(r)}})),n}return t}static getRuntimeSettings(){let e=c[a];return e instanceof c||(e=new c(c.getDefaultSettings()),c[a]=e),e}static getObjectSettings(e,t){let n=null;if(e instanceof c)n=e;else if("object"==typeof e&&null!==e){let r=c[s];r instanceof WeakMap||(r=new WeakMap,c[s]=r),n=r.get(e),n instanceof c||(n=new c(c.assert(c.getObjectSettings(t))),r.set(e,n))}return n}static extendRuntimeSettings(){return c.getRuntimeSettings().extend()}}function u(e,t){for(const n in e)t(n,e[n])}function d(e,t,n,r){return!!function(e){let t,n,r;if("string"!=typeof e||(t=e.length-1)<0)return!1;r=-1;for(;(n=e.indexOf(".",r+1))>=0;){if(n-r<2||n===t)return!1;r=n}return!0}(t)&&(f(n)?function(e,t,n,r){let i;if(r.has(n))return d(e,t,null,r);r.add(n),i=0;for(const o in n)Object.prototype.hasOwnProperty.call(n,o)&&(d(e,0===o.length?t:`${t}.${o}`,n[o],r)||++i);return r.delete(n),0===i}(e,t,n,r instanceof WeakSet?r:new WeakSet):(e[t]=n,!0))}function f(e){if("object"==typeof e&&null!==e){const t=Object.getPrototypeOf(e);if(t===Object.prototype||null===t)return!0}return!1}function g(e,t,n){const r=t.indexOf(".");if(r>=0){const i=t.slice(0,r);let o=e[i];if("object"!=typeof o||null===o){const t=o;o={},void 0!==t&&(o[""]=t),e[i]=o}g(o,t.slice(r+1,t.length),n)}else e[t]=n}c.getDefaultSettings().set("useCursors",!0);n(39561),n(80068),n(98455);n(90808);n(32643),n(69372);n(36822);var m,h=n(49035),p=(n(55500),n(55509),n(98834),n(58498)),v=n(42008);const y=(m="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e){var t,n,r=void 0!==(e=e||{})?e:{};r.ready=new Promise((function(e,r){t=e,n=r}));var i,o=Object.assign({},r),a=[],s="./this.program",l=(e,t)=>{throw t},c=!0,u=!1,d="";(c||u)&&(u?d=self.location.href:"undefined"!=typeof document&&document.currentScript&&(d=document.currentScript.src),m&&(d=m),d=0!==d.indexOf("blob:")?d.substr(0,d.replace(/[?#].*/,"").lastIndexOf("/")+1):"",u&&(i=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}));var f=r.print||console.log.bind(console),g=r.printErr||console.warn.bind(console);Object.assign(r,o),o=null,r.arguments&&(a=r.arguments),r.thisProgram&&(s=r.thisProgram),r.quit&&(l=r.quit);var h,p=4;r.wasmBinary&&(h=r.wasmBinary);var v,y=r.noExitRuntime||!0;"object"!=typeof WebAssembly&&G("no native wasm support detected");var w,I,A,P,b,S,E,T,x,_,M=!1,C="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function R(e,t,n){for(var r=t+n,i=t;e[i]&&!(i>=r);)++i;if(i-t>16&&e.buffer&&C)return C.decode(e.subarray(t,i));for(var o="";t<i;){var a=e[t++];if(128&a){var s=63&e[t++];if(192!=(224&a)){var l=63&e[t++];if((a=224==(240&a)?(15&a)<<12|s<<6|l:(7&a)<<18|s<<12|l<<6|63&e[t++])<65536)o+=String.fromCharCode(a);else{var c=a-65536;o+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else o+=String.fromCharCode((31&a)<<6|s)}else o+=String.fromCharCode(a)}return o}function D(e,t){return e?R(P,e,t):""}function O(e,t,n,r){if(!(r>0))return 0;for(var i=n,o=n+r-1,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a)),s<=127){if(n>=o)break;t[n++]=s}else if(s<=2047){if(n+1>=o)break;t[n++]=192|s>>6,t[n++]=128|63&s}else if(s<=65535){if(n+2>=o)break;t[n++]=224|s>>12,t[n++]=128|s>>6&63,t[n++]=128|63&s}else{if(n+3>=o)break;t[n++]=240|s>>18,t[n++]=128|s>>12&63,t[n++]=128|s>>6&63,t[n++]=128|63&s}}return t[n]=0,n-i}function V(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);r<=127?t++:r<=2047?t+=2:r>=55296&&r<=57343?(t+=4,++n):t+=3}return t}function L(e){I=e,r.HEAP8=A=new Int8Array(e),r.HEAP16=b=new Int16Array(e),r.HEAP32=E=new Int32Array(e),r.HEAPU8=P=new Uint8Array(e),r.HEAPU16=S=new Uint16Array(e),r.HEAPU32=T=new Uint32Array(e),r.HEAPF32=x=new Float32Array(e),r.HEAPF64=_=new Float64Array(e)}r.INITIAL_MEMORY;var N,F=[],W=[],U=[],k=[],j=0,B=null,z=null;function G(e){r.onAbort&&r.onAbort(e),g(e="Aborted("+e+")"),M=!0,w=1,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw n(t),t}var H,Y,q="data:application/octet-stream;base64,";function $(e){return e.startsWith(q)}function X(e){try{if(e==H&&h)return new Uint8Array(h);if(i)return i(e);throw"both async and sync fetching of the wasm failed"}catch(e){G(e)}}$(H="ICRPolySeg.wasm")||(Y=H,H=r.locateFile?r.locateFile(Y,d):d+Y);var J={638383:e=>{r.updateProgress&&r.updateProgress(e)}};function K(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function Z(e){for(;e.length>0;)e.shift()(r)}function Q(e){this.excPtr=e,this.ptr=e-24,this.set_type=function(e){T[this.ptr+4>>2]=e},this.get_type=function(){return T[this.ptr+4>>2]},this.set_destructor=function(e){T[this.ptr+8>>2]=e},this.get_destructor=function(){return T[this.ptr+8>>2]},this.set_refcount=function(e){E[this.ptr>>2]=e},this.set_caught=function(e){e=e?1:0,A[this.ptr+12|0]=e},this.get_caught=function(){return 0!=A[this.ptr+12|0]},this.set_rethrown=function(e){e=e?1:0,A[this.ptr+13|0]=e},this.get_rethrown=function(){return 0!=A[this.ptr+13|0]},this.init=function(e,t){this.set_adjusted_ptr(0),this.set_type(e),this.set_destructor(t),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var e=E[this.ptr>>2];E[this.ptr>>2]=e+1},this.release_ref=function(){var e=E[this.ptr>>2];return E[this.ptr>>2]=e-1,1===e},this.set_adjusted_ptr=function(e){T[this.ptr+16>>2]=e},this.get_adjusted_ptr=function(){return T[this.ptr+16>>2]},this.get_exception_ptr=function(){if(mt(this.get_type()))return T[this.excPtr>>2];var e=this.get_adjusted_ptr();return 0!==e?e:this.excPtr}}var ee={varargs:void 0,get:function(){return ee.varargs+=4,E[ee.varargs-4>>2]},getStr:function(e){return D(e)}},te={};function ne(e){for(;e.length;){var t=e.pop();e.pop()(t)}}function re(e){return this.fromWireType(E[e>>2])}var ie={},oe={},ae={},se=48,le=57;function ce(e){if(void 0===e)return"_unknown";var t=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return t>=se&&t<=le?"_"+e:e}function ue(e,t){return e=ce(e),new Function("body","return function "+e+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(t)}function de(e,t){var n=ue(t,(function(e){this.name=t,this.message=e;var n=new Error(e).stack;void 0!==n&&(this.stack=this.toString()+"\n"+n.replace(/^Error(:[^\n]*)?\n/,""))}));return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},n}var fe=void 0;function ge(e){throw new fe(e)}function me(e,t,n){function r(t){var r=n(t);r.length!==e.length&&ge("Mismatched type converter count");for(var i=0;i<e.length;++i)Ie(e[i],r[i])}e.forEach((function(e){ae[e]=t}));var i=new Array(t.length),o=[],a=0;t.forEach(((e,t)=>{oe.hasOwnProperty(e)?i[t]=oe[e]:(o.push(e),ie.hasOwnProperty(e)||(ie[e]=[]),ie[e].push((()=>{i[t]=oe[e],++a===o.length&&r(i)})))})),0===o.length&&r(i)}function he(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}var pe=void 0;function ve(e){for(var t="",n=e;P[n];)t+=pe[P[n++]];return t}var ye=void 0;function we(e){throw new ye(e)}function Ie(e,t,n={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var r=t.name;if(e||we('type "'+r+'" must have a positive integer typeid pointer'),oe.hasOwnProperty(e)){if(n.ignoreDuplicateRegistrations)return;we("Cannot register type '"+r+"' twice")}if(oe[e]=t,delete ae[e],ie.hasOwnProperty(e)){var i=ie[e];delete ie[e],i.forEach((e=>e()))}}var Ae=[],Pe=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function be(e){e>4&&0==--Pe[e].refcount&&(Pe[e]=void 0,Ae.push(e))}function Se(){for(var e=0,t=5;t<Pe.length;++t)void 0!==Pe[t]&&++e;return e}function Ee(){for(var e=5;e<Pe.length;++e)if(void 0!==Pe[e])return Pe[e];return null}var Te={toValue:e=>(e||we("Cannot use deleted val. handle = "+e),Pe[e].value),toHandle:e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var t=Ae.length?Ae.pop():Pe.length;return Pe[t]={refcount:1,value:e},t}}};function xe(e,t){switch(t){case 2:return function(e){return this.fromWireType(x[e>>2])};case 3:return function(e){return this.fromWireType(_[e>>3])};default:throw new TypeError("Unknown float type: "+e)}}function _e(e,t){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var n=ue(e.name||"unknownFunctionName",(function(){}));n.prototype=e.prototype;var r=new n,i=e.apply(r,t);return i instanceof Object?i:r}function Me(e,t,n){r.hasOwnProperty(e)?((void 0===n||void 0!==r[e].overloadTable&&void 0!==r[e].overloadTable[n])&&we("Cannot register public name '"+e+"' twice"),function(e,t,n){if(void 0===e[t].overloadTable){var r=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||we("Function '"+n+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].overloadTable+")!"),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[r.argCount]=r}}(r,e,e),r.hasOwnProperty(n)&&we("Cannot register multiple overloads of a function with the same number of arguments ("+n+")!"),r[e].overloadTable[n]=t):(r[e]=t,void 0!==n&&(r[e].numArguments=n))}var Ce=[];function Re(e){var t=Ce[e];return t||(e>=Ce.length&&(Ce.length=e+1),Ce[e]=t=N.get(e)),t}function De(e,t,n){return e.includes("j")?function(e,t,n){var i=r["dynCall_"+e];return n&&n.length?i.apply(null,[t].concat(n)):i.call(null,t)}(e,t,n):Re(t).apply(null,n)}function Oe(e,t){var n,r,i,o=(e=ve(e)).includes("j")?(n=e,r=t,i=[],function(){return i.length=0,Object.assign(i,arguments),De(n,r,i)}):Re(t);return"function"!=typeof o&&we("unknown function pointer with signature "+e+": "+t),o}var Ve=void 0;function Le(e){var t=gt(e),n=ve(t);return ft(t),n}function Ne(e,t,n){switch(t){case 0:return n?function(e){return A[e]}:function(e){return P[e]};case 1:return n?function(e){return b[e>>1]}:function(e){return S[e>>1]};case 2:return n?function(e){return E[e>>2]}:function(e){return T[e>>2]};default:throw new TypeError("Unknown integer type: "+e)}}var Fe="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function We(e,t){for(var n=e,r=n>>1,i=r+t/2;!(r>=i)&&S[r];)++r;if((n=r<<1)-e>32&&Fe)return Fe.decode(P.subarray(e,n));for(var o="",a=0;!(a>=t/2);++a){var s=b[e+2*a>>1];if(0==s)break;o+=String.fromCharCode(s)}return o}function Ue(e,t,n){if(void 0===n&&(n=2147483647),n<2)return 0;for(var r=t,i=(n-=2)<2*e.length?n/2:e.length,o=0;o<i;++o){var a=e.charCodeAt(o);b[t>>1]=a,t+=2}return b[t>>1]=0,t-r}function ke(e){return 2*e.length}function je(e,t){for(var n=0,r="";!(n>=t/4);){var i=E[e+4*n>>2];if(0==i)break;if(++n,i>=65536){var o=i-65536;r+=String.fromCharCode(55296|o>>10,56320|1023&o)}else r+=String.fromCharCode(i)}return r}function Be(e,t,n){if(void 0===n&&(n=2147483647),n<4)return 0;for(var r=t,i=r+n-4,o=0;o<e.length;++o){var a=e.charCodeAt(o);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o)),E[t>>2]=a,(t+=4)+4>i)break}return E[t>>2]=0,t-r}function ze(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);r>=55296&&r<=57343&&++n,t+=4}return t}function Ge(e,t){var n=oe[e];return void 0===n&&we(t+" has unknown type "+Le(e)),n}var He={};function Ye(e){var t=He[e];return void 0===t?ve(e):t}var qe=[];function $e(){return"object"==typeof globalThis?globalThis:Function("return this")()}var Xe=[],Je={},Ke=[];function Ze(e,t,n){var r=function(e,t){var n;for(Ke.length=0,t>>=2;n=P[e++];)t+=105!=n&t,Ke.push(105==n?E[t]:_[t++>>1]),++t;return Ke}(t,n);return J[e].apply(null,r)}function Qe(e){try{return v.grow(e-I.byteLength+65535>>>16),L(v.buffer),1}catch(e){}}var et={};function tt(){if(!tt.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:s||"./this.program"};for(var t in et)void 0===et[t]?delete e[t]:e[t]=et[t];var n=[];for(var t in e)n.push(t+"="+e[t]);tt.strings=n}return tt.strings}var nt=[null,[],[]];function rt(e,t){var n=nt[e];0===t||10===t?((1===e?f:g)(R(n,0)),n.length=0):n.push(t)}function it(e){return e%4==0&&(e%100!=0||e%400==0)}var ot=[31,29,31,30,31,30,31,31,30,31,30,31],at=[31,28,31,30,31,30,31,31,30,31,30,31];function st(e,t,n,r){var i=E[r+40>>2],o={tm_sec:E[r>>2],tm_min:E[r+4>>2],tm_hour:E[r+8>>2],tm_mday:E[r+12>>2],tm_mon:E[r+16>>2],tm_year:E[r+20>>2],tm_wday:E[r+24>>2],tm_yday:E[r+28>>2],tm_isdst:E[r+32>>2],tm_gmtoff:E[r+36>>2],tm_zone:i?D(i):""},a=D(n),s={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var l in s)a=a.replace(new RegExp(l,"g"),s[l]);var c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],u=["January","February","March","April","May","June","July","August","September","October","November","December"];function d(e,t,n){for(var r="number"==typeof e?e.toString():e||"";r.length<t;)r=n[0]+r;return r}function f(e,t){return d(e,t,"0")}function g(e,t){function n(e){return e<0?-1:e>0?1:0}var r;return 0===(r=n(e.getFullYear()-t.getFullYear()))&&0===(r=n(e.getMonth()-t.getMonth()))&&(r=n(e.getDate()-t.getDate())),r}function m(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function h(e){var t=function(e,t){for(var n=new Date(e.getTime());t>0;){var r=it(n.getFullYear()),i=n.getMonth(),o=(r?ot:at)[i];if(!(t>o-n.getDate()))return n.setDate(n.getDate()+t),n;t-=o-n.getDate()+1,n.setDate(1),i<11?n.setMonth(i+1):(n.setMonth(0),n.setFullYear(n.getFullYear()+1))}return n}(new Date(e.tm_year+1900,0,1),e.tm_yday),n=new Date(t.getFullYear(),0,4),r=new Date(t.getFullYear()+1,0,4),i=m(n),o=m(r);return g(i,t)<=0?g(o,t)<=0?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var p={"%a":function(e){return c[e.tm_wday].substring(0,3)},"%A":function(e){return c[e.tm_wday]},"%b":function(e){return u[e.tm_mon].substring(0,3)},"%B":function(e){return u[e.tm_mon]},"%C":function(e){return f((e.tm_year+1900)/100|0,2)},"%d":function(e){return f(e.tm_mday,2)},"%e":function(e){return d(e.tm_mday,2," ")},"%g":function(e){return h(e).toString().substring(2)},"%G":function(e){return h(e)},"%H":function(e){return f(e.tm_hour,2)},"%I":function(e){var t=e.tm_hour;return 0==t?t=12:t>12&&(t-=12),f(t,2)},"%j":function(e){return f(e.tm_mday+function(e,t){for(var n=0,r=0;r<=t;n+=e[r++]);return n}(it(e.tm_year+1900)?ot:at,e.tm_mon-1),3)},"%m":function(e){return f(e.tm_mon+1,2)},"%M":function(e){return f(e.tm_min,2)},"%n":function(){return"\n"},"%p":function(e){return e.tm_hour>=0&&e.tm_hour<12?"AM":"PM"},"%S":function(e){return f(e.tm_sec,2)},"%t":function(){return"\t"},"%u":function(e){return e.tm_wday||7},"%U":function(e){var t=e.tm_yday+7-e.tm_wday;return f(Math.floor(t/7),2)},"%V":function(e){var t=Math.floor((e.tm_yday+7-(e.tm_wday+6)%7)/7);if((e.tm_wday+371-e.tm_yday-2)%7<=2&&t++,t){if(53==t){var n=(e.tm_wday+371-e.tm_yday)%7;4==n||3==n&&it(e.tm_year)||(t=1)}}else{t=52;var r=(e.tm_wday+7-e.tm_yday-1)%7;(4==r||5==r&&it(e.tm_year%400-1))&&t++}return f(t,2)},"%w":function(e){return e.tm_wday},"%W":function(e){var t=e.tm_yday+7-(e.tm_wday+6)%7;return f(Math.floor(t/7),2)},"%y":function(e){return(e.tm_year+1900).toString().substring(2)},"%Y":function(e){return e.tm_year+1900},"%z":function(e){var t=e.tm_gmtoff,n=t>=0;return t=(t=Math.abs(t)/60)/60*100+t%60,(n?"+":"-")+String("0000"+t).slice(-4)},"%Z":function(e){return e.tm_zone},"%%":function(){return"%"}};for(var l in a=a.replace(/%%/g,"\0\0"),p)a.includes(l)&&(a=a.replace(new RegExp(l,"g"),p[l](o)));a=a.replace(/\0\0/g,"%");var v,y,w,I,P,b,S=(v=a,y=!1,I=w>0?w:V(v)+1,P=new Array(I),b=O(v,P,0,P.length),y&&(P.length=b),P);return S.length>t?0:(function(e,t){A.set(e,t)}(S,e),S.length-1)}function lt(e){w=e,y||(r.onExit&&r.onExit(e),M=!0),l(e,new K(e))}fe=r.InternalError=de(Error,"InternalError"),function(){for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);pe=e}(),ye=r.BindingError=de(Error,"BindingError"),r.count_emval_handles=Se,r.get_first_emval=Ee,Ve=r.UnboundTypeError=de(Error,"UnboundTypeError");var ct,ut={b:function(e,t,n){throw new Q(e).init(t,n),e},J:function(e,t){},F:function(e,t,n){},L:function(e,t,n,r){ee.varargs=r},E:function(e,t,n,r){},G:function(e,t){},x:function(e){var t=te[e];delete te[e];var n=t.rawConstructor,r=t.rawDestructor,i=t.fields;me([e],i.map((e=>e.getterReturnType)).concat(i.map((e=>e.setterArgumentType))),(e=>{var o={};return i.forEach(((t,n)=>{var r=t.fieldName,a=e[n],s=t.getter,l=t.getterContext,c=e[n+i.length],u=t.setter,d=t.setterContext;o[r]={read:e=>a.fromWireType(s(l,e)),write:(e,t)=>{var n=[];u(d,e,c.toWireType(n,t)),ne(n)}}})),[{name:t.name,fromWireType:function(e){var t={};for(var n in o)t[n]=o[n].read(e);return r(e),t},toWireType:function(e,t){for(var i in o)if(!(i in t))throw new TypeError('Missing field:  "'+i+'"');var a=n();for(i in o)o[i].write(a,t[i]);return null!==e&&e.push(r,a),a},argPackAdvance:8,readValueFromPointer:re,destructorFunction:r}]}))},A:function(e,t,n,r,i){},O:function(e,t,n,r,i){var o=he(n);Ie(e,{name:t=ve(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?r:i},argPackAdvance:8,readValueFromPointer:function(e){var r;if(1===n)r=A;else if(2===n)r=b;else{if(4!==n)throw new TypeError("Unknown boolean type size: "+t);r=E}return this.fromWireType(r[e>>o])},destructorFunction:null})},N:function(e,t){Ie(e,{name:t=ve(t),fromWireType:function(e){var t=Te.toValue(e);return be(e),t},toWireType:function(e,t){return Te.toHandle(t)},argPackAdvance:8,readValueFromPointer:re,destructorFunction:null})},v:function(e,t,n){var r=he(n);Ie(e,{name:t=ve(t),fromWireType:function(e){return e},toWireType:function(e,t){return t},argPackAdvance:8,readValueFromPointer:xe(t,r),destructorFunction:null})},g:function(e,t,n,i,o,a){var s=function(e,t){for(var n=[],r=0;r<e;r++)n.push(T[t+4*r>>2]);return n}(t,n);e=ve(e),o=Oe(i,o),Me(e,(function(){!function(e,t){var n=[],r={};throw t.forEach((function e(t){r[t]||oe[t]||(ae[t]?ae[t].forEach(e):(n.push(t),r[t]=!0))})),new Ve(e+": "+n.map(Le).join([", "]))}("Cannot call "+e+" due to unbound types",s)}),t-1),me([],s,(function(n){var i=[n[0],null].concat(n.slice(1));return function(e,t,n){r.hasOwnProperty(e)||ge("Replacing nonexistant public symbol"),void 0!==r[e].overloadTable&&void 0!==n?r[e].overloadTable[n]=t:(r[e]=t,r[e].argCount=n)}(e,function(e,t,n,r,i){var o=t.length;o<2&&we("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var a=null!==t[1]&&null!==n,s=!1,l=1;l<t.length;++l)if(null!==t[l]&&void 0===t[l].destructorFunction){s=!0;break}var c="void"!==t[0].name,u="",d="";for(l=0;l<o-2;++l)u+=(0!==l?", ":"")+"arg"+l,d+=(0!==l?", ":"")+"arg"+l+"Wired";var f="return function "+ce(e)+"("+u+") {\nif (arguments.length !== "+(o-2)+") {\nthrowBindingError('function "+e+" called with ' + arguments.length + ' arguments, expected "+(o-2)+" args!');\n}\n";s&&(f+="var destructors = [];\n");var g=s?"destructors":"null",m=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],h=[we,r,i,ne,t[0],t[1]];for(a&&(f+="var thisWired = classParam.toWireType("+g+", this);\n"),l=0;l<o-2;++l)f+="var arg"+l+"Wired = argType"+l+".toWireType("+g+", arg"+l+"); // "+t[l+2].name+"\n",m.push("argType"+l),h.push(t[l+2]);if(a&&(d="thisWired"+(d.length>0?", ":"")+d),f+=(c?"var rv = ":"")+"invoker(fn"+(d.length>0?", ":"")+d+");\n",s)f+="runDestructors(destructors);\n";else for(l=a?1:2;l<t.length;++l){var p=1===l?"thisWired":"arg"+(l-2)+"Wired";null!==t[l].destructorFunction&&(f+=p+"_dtor("+p+"); // "+t[l].name+"\n",m.push(p+"_dtor"),h.push(t[l].destructorFunction))}return c&&(f+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),f+="}\n",m.push(f),_e(Function,m).apply(null,h)}(e,i,null,o,a),t-1),[]}))},d:function(e,t,n,r,i){t=ve(t),-1===i&&(i=4294967295);var o=he(n),a=e=>e;if(0===r){var s=32-8*n;a=e=>e<<s>>>s}var l=t.includes("unsigned");Ie(e,{name:t,fromWireType:a,toWireType:l?function(e,t){return this.name,t>>>0}:function(e,t){return this.name,t},argPackAdvance:8,readValueFromPointer:Ne(t,o,0!==r),destructorFunction:null})},c:function(e,t,n){var r=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];function i(e){var t=T,n=t[e>>=2],i=t[e+1];return new r(I,i,n)}Ie(e,{name:n=ve(n),fromWireType:i,argPackAdvance:8,readValueFromPointer:i},{ignoreDuplicateRegistrations:!0})},u:function(e,t){var n="std::string"===(t=ve(t));Ie(e,{name:t,fromWireType:function(e){var t,r=T[e>>2],i=e+4;if(n)for(var o=i,a=0;a<=r;++a){var s=i+a;if(a==r||0==P[s]){var l=D(o,s-o);void 0===t?t=l:(t+=String.fromCharCode(0),t+=l),o=s+1}}else{var c=new Array(r);for(a=0;a<r;++a)c[a]=String.fromCharCode(P[i+a]);t=c.join("")}return ft(e),t},toWireType:function(e,t){var r;t instanceof ArrayBuffer&&(t=new Uint8Array(t));var i="string"==typeof t;i||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||we("Cannot pass non-string to std::string"),r=n&&i?V(t):t.length;var o=dt(4+r+1),a=o+4;if(T[o>>2]=r,n&&i)O(t,P,a,r+1);else if(i)for(var s=0;s<r;++s){var l=t.charCodeAt(s);l>255&&(ft(a),we("String has UTF-16 code units that do not fit in 8 bits")),P[a+s]=l}else for(s=0;s<r;++s)P[a+s]=t[s];return null!==e&&e.push(ft,o),o},argPackAdvance:8,readValueFromPointer:re,destructorFunction:function(e){ft(e)}})},m:function(e,t,n){var r,i,o,a,s;n=ve(n),2===t?(r=We,i=Ue,a=ke,o=()=>S,s=1):4===t&&(r=je,i=Be,a=ze,o=()=>T,s=2),Ie(e,{name:n,fromWireType:function(e){for(var n,i=T[e>>2],a=o(),l=e+4,c=0;c<=i;++c){var u=e+4+c*t;if(c==i||0==a[u>>s]){var d=r(l,u-l);void 0===n?n=d:(n+=String.fromCharCode(0),n+=d),l=u+t}}return ft(e),n},toWireType:function(e,r){"string"!=typeof r&&we("Cannot pass non-string to C++ string type "+n);var o=a(r),l=dt(4+o+t);return T[l>>2]=o>>s,i(r,l+4,o+t),null!==e&&e.push(ft,l),l},argPackAdvance:8,readValueFromPointer:re,destructorFunction:function(e){ft(e)}})},y:function(e,t,n,r,i,o){te[e]={name:ve(t),rawConstructor:Oe(n,r),rawDestructor:Oe(i,o),fields:[]}},e:function(e,t,n,r,i,o,a,s,l,c){te[e].fields.push({fieldName:ve(t),getterReturnType:n,getter:Oe(r,i),getterContext:o,setterArgumentType:a,setter:Oe(s,l),setterContext:c})},P:function(e,t){Ie(e,{isVoid:!0,name:t=ve(t),argPackAdvance:0,fromWireType:function(){},toWireType:function(e,t){}})},r:function(e,t,n){e=Te.toValue(e),t=Ge(t,"emval::as");var r=[],i=Te.toHandle(r);return T[n>>2]=i,t.toWireType(r,e)},i:function(e,t,n,r){(e=qe[e])(t=Te.toValue(t),n=Ye(n),null,r)},a:be,p:function(e){return 0===e?Te.toHandle($e()):(e=Ye(e),Te.toHandle($e()[e]))},j:function(e,t){var n=function(e,t){for(var n=new Array(e),r=0;r<e;++r)n[r]=Ge(T[t+r*p>>2],"parameter "+r);return n}(e,t),r=n[0],i=r.name+"_$"+n.slice(1).map((function(e){return e.name})).join("_")+"$",o=Xe[i];if(void 0!==o)return o;for(var a=["retType"],s=[r],l="",c=0;c<e-1;++c)l+=(0!==c?", ":"")+"arg"+c,a.push("argType"+c),s.push(n[1+c]);var u="return function "+ce("methodCaller_"+i)+"(handle, name, destructors, args) {\n",d=0;for(c=0;c<e-1;++c)u+="    var arg"+c+" = argType"+c+".readValueFromPointer(args"+(d?"+"+d:"")+");\n",d+=n[c+1].argPackAdvance;for(u+="    var rv = handle[name]("+l+");\n",c=0;c<e-1;++c)n[c+1].deleteObject&&(u+="    argType"+c+".deleteObject(arg"+c+");\n");r.isVoid||(u+="    return retType.toWireType(destructors, rv);\n"),u+="};\n",a.push(u);var f,g,m=_e(Function,a).apply(null,s);return f=m,g=qe.length,qe.push(f),o=g,Xe[i]=o,o},s:function(e,t){return e=Te.toValue(e),t=Te.toValue(t),Te.toHandle(e[t])},f:function(e){e>4&&(Pe[e].refcount+=1)},o:function(e,t,n,i){e=Te.toValue(e);var o=Je[t];return o||(o=function(e){for(var t="",n=0;n<e;++n)t+=(0!==n?", ":"")+"arg"+n;var i="return function emval_allocator_"+e+"(constructor, argTypes, args) {\n  var HEAPU32 = getMemory();\n";for(n=0;n<e;++n)i+="var argType"+n+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+n+"');\nvar arg"+n+" = argType"+n+".readValueFromPointer(args);\nargs += argType"+n+"['argPackAdvance'];\nargTypes += 4;\n";return i+="var obj = new constructor("+t+");\nreturn valueToHandle(obj);\n}\n",new Function("requireRegisteredType","Module","valueToHandle","getMemory",i)(Ge,r,Te.toHandle,(()=>T))}(t),Je[t]=o),o(e,n,i)},w:function(e){return Te.toHandle(Ye(e))},q:function(e){ne(Te.toValue(e)),be(e)},k:function(e,t){var n=(e=Ge(e,"_emval_take_value")).readValueFromPointer(t);return Te.toHandle(n)},n:function(){G("")},h:function(e,t,n){return Ze(e,t,n)},D:function(){return 2147483648},M:function(e,t,n){P.copyWithin(e,t,t+n)},C:function(e){var t,n,r=P.length,i=2147483648;if((e>>>=0)>i)return!1;for(var o=1;o<=4;o*=2){var a=r*(1+.2/o);if(a=Math.min(a,e+100663296),Qe(Math.min(i,(t=Math.max(e,a))+((n=65536)-t%n)%n)))return!0}return!1},H:function(e,t){var n=0;return tt().forEach((function(r,i){var o=t+n;T[e+4*i>>2]=o,function(e,t,n){for(var r=0;r<e.length;++r)A[0|t++]=e.charCodeAt(r);n||(A[0|t]=0)}(r,o),n+=r.length+1})),0},I:function(e,t){var n=tt();T[e>>2]=n.length;var r=0;return n.forEach((function(e){r+=e.length+1})),T[t>>2]=r,0},l:function(e){return 52},K:function(e,t,n,r){return 52},z:function(e,t,n,r,i){return 70},t:function(e,t,n,r){for(var i=0,o=0;o<n;o++){var a=T[t>>2],s=T[t+4>>2];t+=8;for(var l=0;l<s;l++)rt(e,P[a+l]);i+=s}return T[r>>2]=i,0},B:function(e,t,n,r,i){return st(e,t,n,r)}},dt=(function(){var e={a:ut};function t(e,t){var n,i=e.exports;r.asm=i,L((v=r.asm.Q).buffer),N=r.asm.T,n=r.asm.R,W.unshift(n),function(e){if(j--,r.monitorRunDependencies&&r.monitorRunDependencies(j),0==j&&(null!==B&&(clearInterval(B),B=null),z)){var t=z;z=null,t()}}()}function i(e){t(e.instance)}function o(t){return(h||!c&&!u||"function"!=typeof fetch?Promise.resolve().then((function(){return X(H)})):fetch(H,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+H+"'";return e.arrayBuffer()})).catch((function(){return X(H)}))).then((function(t){return WebAssembly.instantiate(t,e)})).then((function(e){return e})).then(t,(function(e){g("failed to asynchronously prepare wasm: "+e),G(e)}))}if(j++,r.monitorRunDependencies&&r.monitorRunDependencies(j),r.instantiateWasm)try{return r.instantiateWasm(e,t)}catch(e){g("Module.instantiateWasm callback failed with error: "+e),n(e)}(h||"function"!=typeof WebAssembly.instantiateStreaming||$(H)||"function"!=typeof fetch?o(i):fetch(H,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(i,(function(e){return g("wasm streaming compile failed: "+e),g("falling back to ArrayBuffer instantiation"),o(i)}))}))).catch(n)}(),r.___wasm_call_ctors=function(){return(r.___wasm_call_ctors=r.asm.R).apply(null,arguments)},r._main=function(){return(r._main=r.asm.S).apply(null,arguments)},r._malloc=function(){return(dt=r._malloc=r.asm.U).apply(null,arguments)}),ft=r._free=function(){return(ft=r._free=r.asm.V).apply(null,arguments)},gt=r.___getTypeName=function(){return(gt=r.___getTypeName=r.asm.W).apply(null,arguments)},mt=(r.__embind_initialize_bindings=function(){return(r.__embind_initialize_bindings=r.asm.X).apply(null,arguments)},r.___cxa_is_pointer_type=function(){return(mt=r.___cxa_is_pointer_type=r.asm.Y).apply(null,arguments)});function ht(e){var t,n=r._main;try{var i=n(0,0);return w=t=i,lt(t),i}catch(e){return function(e){if(e instanceof K||"unwind"==e)return w;l(1,e)}(e)}}function pt(e){function n(){ct||(ct=!0,r.calledRun=!0,M||(Z(W),Z(U),t(r),r.onRuntimeInitialized&&r.onRuntimeInitialized(),vt&&ht(),function(){if(r.postRun)for("function"==typeof r.postRun&&(r.postRun=[r.postRun]);r.postRun.length;)e=r.postRun.shift(),k.unshift(e);var e;Z(k)}()))}e=e||a,j>0||(function(){if(r.preRun)for("function"==typeof r.preRun&&(r.preRun=[r.preRun]);r.preRun.length;)e=r.preRun.shift(),F.unshift(e);var e;Z(F)}(),j>0||(r.setStatus?(r.setStatus("Running..."),setTimeout((function(){setTimeout((function(){r.setStatus("")}),1),n()}),1)):n()))}if(r.dynCall_viij=function(){return(r.dynCall_viij=r.asm.Z).apply(null,arguments)},r.dynCall_vij=function(){return(r.dynCall_vij=r.asm._).apply(null,arguments)},r.dynCall_iij=function(){return(r.dynCall_iij=r.asm.$).apply(null,arguments)},r.dynCall_viji=function(){return(r.dynCall_viji=r.asm.aa).apply(null,arguments)},r.dynCall_jiji=function(){return(r.dynCall_jiji=r.asm.ba).apply(null,arguments)},r.dynCall_viijii=function(){return(r.dynCall_viijii=r.asm.ca).apply(null,arguments)},r.dynCall_iiiiij=function(){return(r.dynCall_iiiiij=r.asm.da).apply(null,arguments)},r.dynCall_iiiiijj=function(){return(r.dynCall_iiiiijj=r.asm.ea).apply(null,arguments)},r.dynCall_iiiiiijj=function(){return(r.dynCall_iiiiiijj=r.asm.fa).apply(null,arguments)},r.___start_em_js=638316,r.___stop_em_js=638383,z=function e(){ct||pt(),ct||(z=e)},r.preInit)for("function"==typeof r.preInit&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();var vt=!0;return r.noInitialRun&&(vt=!1),pt(),e.ready}),w=n.p+"17dd54813d5acc10bf8f.wasm";class I{constructor(){this._instance}get instance(){if(this._instance)return this._instance;throw new Error("ICRPolySeg is not initialized.")}async initialize(e={}){this._instance=await y({locateFile:e=>e.endsWith(".wasm")?w:e,...e})}}var A=n(75127),P=n(79484),b=n(28906);const S={Forward:1,Backward:-1},E=new Set;const T={};function x(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,T,n),b.m.obj(e,t),b.m.algo(e,t,1,1),function(e,t){e.requestData=(t,n)=>{const[r]=t;n[0]||(n[0]=P.Ay.newInstance());const[i]=n;e.extractContours(r,i),i.modified()},e.traverseLoop=(e,t,n,r,i)=>{let o=n,a=r,s=!1,l=0;for(;!s;){const{cellPointIds:n}=e.getCellPoints(o);if(!n)continue;a=n[0]!==a?n[0]:n[1],l++;const c=t*l;i.push({t:c,ptId:a});const u=e.getPointCells(a);if(2!==u.length||a===r)return a;2===u.length?(o=u[0]!==o?u[0]:u[1],E.add(o)):s=!0}return a},e.extractContours=(t,n)=>{const r=[];E.clear();const i=t.getLines();n.getPoints().setData(Float32Array.from(t.getPoints().getData()));for(let n=0;n<i.getNumberOfCells();n++){if(E.has(n))continue;const{cellPointIds:i}=t.getCellPoints(n);if(!i)continue;E.add(n);const o=i[0],a=[];a.push({t:0,ptId:o}),o!==e.traverseLoop(t,S.Forward,n,o,a)&&(e.traverseLoop(t,S.Backward,n,o,a),a.sort(((e,t)=>e.t<t.t?-1:1)),a.length&&a[0].ptId!==a[a.length-1]?.ptId&&a.push({...a[a.length-1]})),a.length&&r.push(a)}const o=n.getLines();o.resize(0),r.forEach((e=>{o.insertNextCell(e.map((e=>e.ptId)))}))}}(e)}var _={newInstance:b.m.newInstance(x,"vtkContourLoopExtraction"),extend:x},M=n(61088);const{EPSILON:C}=i;function R(e,t,n=!1){let r=1/0,i=n?-1/0:0,o=1/0,a=n?-1/0:0,s=1/0,l=n?-1/0:0;const c=3===e[0]?.length;for(let t=0;t<e.length;t++){const n=e[t];r=Math.min(n[0],r),i=Math.max(n[0],i),o=Math.min(n[1],o),a=Math.max(n[1],a),c&&(s=Math.min(n[2]??s,s),l=Math.max(n[2]??l,l))}return t?(r=Math.max(n?t[0]+C:0,r),i=Math.min(n?t[0]-C:t[0]-1,i),o=Math.max(n?t[1]+C:0,o),a=Math.min(n?t[1]-C:t[1]-1,a),c&&3===t.length&&(s=Math.max(n?t[2]+C:0,s),l=Math.min(n?t[2]-C:t[2]-1,l))):n||(r=Math.max(0,r),i=Math.min(1/0,i),o=Math.max(0,o),a=Math.min(1/0,a),c&&(s=Math.max(0,s),l=Math.min(1/0,l))),c?[[r,i],[o,a],[s,l]]:[[r,i],[o,a],null]}function D(e,t){return R(e,t,!0)}var O=n(3823);function V(e){if(e.length<3)return!1;const t=e.length,n=function(e,t){if(e.length!==t.length)throw Error("Both points should have the same dimensionality");const[n,r,i=0]=e,[o,a,s=0]=t,l=o-n,c=a-r,u=s-i;return l*l+c*c+u*u}(e[0],e[t-1]);return O.Fd.equals(0,n)}function L(e,t,n={closed:void 0}){if(e.length<3)return!1;const r=e.length;let i=0;const{closed:o,holes:a}=n;if(a?.length)for(const e of a)if(L(e,t))return!1;const s=!(void 0===o?V(e):o),l=e.length-(s?1:2);for(let n=0;n<=l;n++){const o=e[n],a=e[n===r-1?0:n+1],s=o[0]>=a[0]?o[0]:a[0],l=o[1]>=a[1]?o[1]:a[1],c=o[1]<=a[1]?o[1]:a[1];if(t[0]<=s&&t[1]>=c&&t[1]<l){let e=o[0]===a[0];if(!e){const n=(t[1]-o[1])*(a[0]-o[0])/(a[1]-o[1])+o[0];e=t[0]<=n}i+=e?1:0}}return!!(i%2)}function N(e,t){let n=e;const r=t?.numDimensions||2,i=3===r;if(!Array.isArray(e[0])){const t=e,o=t.length/r;n=new Array(t.length/r);for(let e=0,a=o;e<a;e++)n[e]=[t[e*r],t[e*r+1]],i&&n[e].push(t[e*r+2])}let o=1/0,a=1/0,s=-1/0,l=-1/0,c=1/0,u=-1/0;for(let e=0,t=n.length;e<t;e++){const[t,r,d]=n[e];o=o<t?o:t,a=a<r?a:r,s=s>t?s:t,l=l>r?l:r,i&&(c=c<d?c:d,u=u>d?u:d)}return i?{minX:o,maxX:s,minY:a,maxY:l,minZ:c,maxZ:u}:{minX:o,maxX:s,minY:a,maxY:l}}var F,W,U;!function(e){e[e.Vertex=0]="Vertex",e[e.Intersection=1]="Intersection"}(F||(F={})),function(e){e[e.Outside=-1]="Outside",e[e.Edge=0]="Edge",e[e.Inside=1]="Inside"}(W||(W={})),function(e){e[e.Exiting=-1]="Exiting",e[e.Unknown=0]="Unknown",e[e.Entering=1]="Entering"}(U||(U={}));function k(e){let t;const n=h.getRandomSampleFromArray(e,50);for(let e=0;e<3;e++)if(n.every(((t,n,r)=>Math.abs(t[e]-r[0][e])<1e-6))){t=e;break}if(void 0===t)throw new Error("Cannot find a shared dimension index for polyline, probably oblique plane");const r=[],i=(t+1)%3,o=(t+2)%3;for(let t=0;t<e.length;t++)r.push([e[t][i],e[t][o]]);return{sharedDimensionIndex:t,projectedPolyline:r}}const{EPSILON:j}=i;n(84607);const B=(e,t,n,r,i,o,a,s)=>{const l=[O.eR.fromValues(n,r,i),O.eR.fromValues(o,r,i),O.eR.fromValues(n,a,i),O.eR.fromValues(o,a,i),O.eR.fromValues(n,r,s),O.eR.fromValues(o,r,s),O.eR.fromValues(n,a,s),O.eR.fromValues(o,a,s)],c=O.eR.fromValues(t[0],t[1],t[2]),u=O.eR.fromValues(e[0],e[1],e[2]),d=-O.eR.dot(c,u);let f=null;for(const e of l){const t=O.eR.dot(c,e)+d;if(null===f)f=Math.sign(t);else if(Math.sign(t)!==f)return!0}return!1},{EPSILON:z}=i;const G={polySeg:null,polySegInitializing:!1,polySegInitializingPromise:null,async initializePolySeg(e){this.polySegInitializing?await this.polySegInitializingPromise:this.polySeg?.instance||(this.polySegInitializing=!0,this.polySegInitializingPromise=new Promise((t=>{this.polySeg=new I,this.polySeg.initialize({updateProgress:e}).then((()=>{this.polySegInitializing=!1,t()}))})),await this.polySegInitializingPromise)},async convertContourToSurface(e,...t){const{polylines:n,numPointsArray:r}=e,[i]=t;await this.initializePolySeg(i);return await this.polySeg.instance.convertContourRoiToSurface(n,r)},async convertLabelmapToSurface(e,...t){const[n]=t;await this.initializePolySeg(n);return this.polySeg.instance.convertLabelmapToSurface(e.scalarData,e.dimensions,e.spacing,e.direction,e.origin,[e.segmentIndex])},async convertContourToVolumeLabelmap(e,...t){const[n]=t,r=await new I;await r.initialize({updateProgress:n});const{segmentIndices:i,scalarData:o,annotationUIDsInSegmentMap:a,dimensions:s,origin:l,direction:c,spacing:u}=e,d=h.VoxelManager.createScalarVolumeVoxelManager({dimensions:s,scalarData:o}),f=p.Ay.newInstance();f.setDimensions(s),f.setOrigin(l),f.setDirection(c),f.setSpacing(u);const g=v.Ay.newInstance({name:"Pixels",numberOfComponents:1,values:o});f.getPointData().setScalars(g),f.modified();for(const e of i){const t=a.get(e);for(const n of t){if(!n.polyline)continue;const{polyline:t,holesPolyline:r}=n,i=D(t),[a,l,c]=h.transformWorldToIndex(f,[i[0][0],i[1][0],i[2][0]]),[u,g,m]=h.transformWorldToIndex(f,[i[0][1],i[1][1],i[2][1]]),{projectedPolyline:p,sharedDimensionIndex:v}=k(t),y=r?.map((e=>{const{projectedPolyline:t}=k(e);return t})),w=(v+1)%3,I=(v+2)%3;h.VoxelManager.createScalarVolumeVoxelManager({dimensions:s,scalarData:o}).forEach((({pointIJK:t})=>{d.setAtIJKPoint(t,e)}),{imageData:f,isInObject:e=>{const t=[e[w],e[I]];return L(p,t,{holes:y})},boundsIJK:[[a,u],[l,g],[c,m]]})}}return d.scalarData},async convertContourToStackLabelmap(e,...t){const[n]=t,r=await new I;await r.initialize({updateProgress:n});const{segmentationsInfo:i,annotationUIDsInSegmentMap:o,segmentIndices:a}=e,s=new Map;i.forEach(((e,t)=>{const{dimensions:n,scalarData:r,direction:i,spacing:o,origin:a}=e,l=h.VoxelManager.createScalarVolumeVoxelManager({dimensions:n,scalarData:r}),c=p.Ay.newInstance();c.setDimensions(n),c.setOrigin(a),c.setDirection(i),c.setSpacing(o);const u=v.Ay.newInstance({name:"Pixels",numberOfComponents:1,values:r});c.getPointData().setScalars(u),c.modified(),s.set(t,{manager:l,imageData:c})}));for(const e of a){const t=o.get(e);for(const n of t){if(!n.polyline)continue;const{polyline:t,holesPolyline:r,referencedImageId:i}=n,o=D(t),{manager:a,imageData:l}=s.get(i),[c,u,d]=h.transformWorldToIndex(l,[o[0][0],o[1][0],o[2][0]]),[f,g,m]=h.transformWorldToIndex(l,[o[0][1],o[1][1],o[2][1]]),{projectedPolyline:p,sharedDimensionIndex:v}=k(t),y=r?.map((e=>{const{projectedPolyline:t}=k(e);return t})),w=(v+1)%3,I=(v+2)%3;h.VoxelManager.createImageVoxelManager({width:l.getDimensions()[0],height:l.getDimensions()[1],scalarData:l.getPointData().getScalars().getData()}).forEach((({pointIJK:t})=>{a.setAtIJKPoint(t,e)}),{imageData:l,isInObject:e=>{const t=[e[w],e[I]];return L(p,t,{holes:y})},boundsIJK:[[c,f],[u,g],[d,m]]})}}return i.forEach(((e,t)=>{const{manager:n}=s.get(t);e.scalarData=n.scalarData})),i},async convertSurfaceToVolumeLabelmap(e,...t){const[n]=t;await this.initializePolySeg(n);return this.polySeg.instance.convertSurfaceToLabelmap(e.points,e.polys,e.dimensions,e.spacing,e.direction,e.origin)},async convertSurfacesToVolumeLabelmap(e,...t){const[n]=t;await this.initializePolySeg(n);const{segmentsInfo:r}=e,i=Array.from(r.keys()).map((t=>{const{points:n,polys:i}=r.get(t);return{...this.polySeg.instance.convertSurfaceToLabelmap(n,i,e.dimensions,e.spacing,e.direction,e.origin),segmentIndex:t}})),o=await Promise.all(i),a=p.Ay.newInstance();a.setDimensions(e.dimensions),a.setOrigin(e.origin),a.setSpacing(e.spacing),a.setDirection(e.direction);const s=e.dimensions[0]*e.dimensions[1]*e.dimensions[2],l=v.Ay.newInstance({name:"Pixels",numberOfComponents:1,values:new Uint8Array(s)});a.getPointData().setScalars(l),a.modified();const{dimensions:c}=e,u=a.getPointData().getScalars().getData(),d=h.VoxelManager.createScalarVolumeVoxelManager({dimensions:c,scalarData:u}),f=o.map((e=>{const{data:t,dimensions:n,direction:r,origin:i,spacing:o}=e,a=p.Ay.newInstance();a.setDimensions(n),a.setOrigin(i),a.setSpacing(o),a.setDirection(r);const s=v.Ay.newInstance({name:"Pixels",numberOfComponents:1,values:t});a.getPointData().setScalars(s),a.modified();const l=h.VoxelManager.createScalarVolumeVoxelManager({dimensions:n,scalarData:t}),c=a.getExtent();return{volume:a,voxelManager:l,extent:c,scalarData:t,segmentIndex:e.segmentIndex}}));return h.VoxelManager.createScalarVolumeVoxelManager({dimensions:a.getDimensions(),scalarData:a.getPointData().getScalars().getData()}).forEach((({pointIJK:e,pointLPS:t})=>{try{for(const n of f){const{volume:r,extent:i,voxelManager:o,segmentIndex:a}=n,s=r.worldToIndex(t);if(s[0]<i[0]||s[0]>i[1]||s[1]<i[2]||s[1]>i[3]||s[2]<i[4]||s[2]>i[5])continue;const l=s.map(Math.round);if(o.getAtIJK(...l)>0){d.setAtIJKPoint(e,a);break}}}catch(e){}}),{imageData:a}),d.scalarData},getSurfacesAABBs({surfacesInfo:e}){const t=new Map;for(const{points:n,id:r}of e){const e=N(n,{numDimensions:3});t.set(r,e)}return t},cutSurfacesIntoPlanes({planesInfo:e,surfacesInfo:t,surfacesAABB:n=new Map},r,i){const o=e.length,a=M.Ay.newInstance(),s=A.Ay.newInstance();a.setCutFunction(s);const l=P.Ay.newInstance();try{for(const[c,u]of e.entries()){const{sliceIndex:e,planes:d}=u,f=new Map;for(const e of t){const{points:t,polys:r,id:i,segmentIndex:o}=e,c=n.get(i)||N(t,{numDimensions:3});n.has(i)||n.set(i,c);const{minX:u,minY:g,minZ:m,maxX:h,maxY:p,maxZ:v}=c,{origin:y,normal:w}=d[0];if(!B(y,w,u,g,m,h,p,v))continue;l.getPoints().setData(t,3),l.getPolys().setData(r,3),l.modified(),a.setInputData(l),s.setOrigin(y),s.setNormal(w);try{a.update()}catch(e){console.warn("Error during clipping",e);continue}const I=a.getOutputData(),A=I;A.buildLinks();const P=_.newInstance();P.setInputData(A);const b=P.getOutputData();I&&f.set(o,{points:b.getPoints().getData(),lines:b.getLines().getData(),numberOfCells:b.getLines().getNumberOfCells(),segmentIndex:o})}r({progress:(c+1)/o}),i({sliceIndex:e,polyDataResults:f})}}catch(e){console.warn("Error during processing",e)}finally{t=null,s.delete()}}};(0,r.p)(G)},35056:(e,t,n)=>{n.d(t,{Ay:()=>u});var r=n(28906),i=n(42008),o=n(28914);function a(e){let t=0;return e.filter(((e,n)=>n===t&&(t+=e+1,!0)))}function s(e){let t=0;for(let n=0;n<e.length;)n+=e[n]+1,t++;return t}const l={extractCellSizes:a,getNumberOfCells:s};function c(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i.Ay.extend(e,t,function(e){return{empty:!0,numberOfComponents:1,dataType:o.JA.UNSIGNED_INT,...e}}(n)),function(e,t){t.classHierarchy.push("vtkCellArray");const n={...e};e.getNumberOfCells=n=>void 0===t.numberOfCells||n?(t.cellSizes?t.numberOfCells=t.cellSizes.length:t.numberOfCells=s(e.getData()),t.numberOfCells):t.numberOfCells,e.getCellSizes=n=>void 0===t.cellSizes||n?(t.cellSizes=a(e.getData()),t.cellSizes):t.cellSizes,e.resize=r=>{const i=e.getNumberOfTuples();n.resize(r);const o=e.getNumberOfTuples();o<i&&(0===o?(t.numberOfCells=0,t.cellSizes=[]):(t.numberOfCells=void 0,t.cellSizes=void 0))},e.setData=e=>{n.setData(e,1),t.numberOfCells=void 0,t.cellSizes=void 0},e.getCell=e=>{let n=e;const r=t.values[n++];return t.values.subarray(n,n+r)},e.insertNextCell=n=>{const r=e.getNumberOfCells();return e.insertNextTuples([n.length,...n]),++t.numberOfCells,null!=t.cellSizes&&t.cellSizes.push(n.length),r}}(e,t)}var u={newInstance:r.m.newInstance(c,"vtkCellArray"),extend:c,...l}},28914:(e,t,n)=>{n.d(t,{Ay:()=>i,JA:()=>r});const r={VOID:"",CHAR:"Int8Array",SIGNED_CHAR:"Int8Array",UNSIGNED_CHAR:"Uint8Array",UNSIGNED_CHAR_CLAMPED:"Uint8ClampedArray",SHORT:"Int16Array",UNSIGNED_SHORT:"Uint16Array",INT:"Int32Array",UNSIGNED_INT:"Uint32Array",FLOAT:"Float32Array",DOUBLE:"Float64Array"};var i={DefaultDataType:r.FLOAT,DataTypeByteSize:{Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},VtkDataTypes:r}},62612:(e,t,n)=>{n.d(t,{Ay:()=>r});var r={AttributeCopyOperations:{COPYTUPLE:0,INTERPOLATE:1,PASSDATA:2,ALLCOPY:3},AttributeLimitTypes:{MAX:0,EXACT:1,NOLIMIT:2},AttributeTypes:{SCALARS:0,VECTORS:1,NORMALS:2,TCOORDS:3,TENSORS:4,GLOBALIDS:5,PEDIGREEIDS:6,EDGEFLAG:7,NUM_ATTRIBUTES:8},CellGhostTypes:{DUPLICATECELL:1,HIGHCONNECTIVITYCELL:2,LOWCONNECTIVITYCELL:4,REFINEDCELL:8,EXTERIORCELL:16,HIDDENCELL:32},DesiredOutputPrecision:{DEFAULT:0,SINGLE:1,DOUBLE:2},PointGhostTypes:{DUPLICATEPOINT:1,HIDDENPOINT:2},ghostArrayName:"vtkGhostType"}},58498:(e,t,n)=>{n.d(t,{Ay:()=>g});var r=n(28906),i=n(16632),o=n(21734),a=n(69147),s=n(24964),l=n(85278),c=n(3823);const{vtkErrorMacro:u}=r.m;const d={direction:null,indexToWorld:null,worldToIndex:null,spacing:[1,1,1],origin:[0,0,0],extent:[0,-1,0,-1,0,-1],dataDescription:l.e.EMPTY};function f(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,d,n),a.Ay.extend(e,t,n),t.direction?Array.isArray(t.direction)&&(t.direction=new Float64Array(t.direction.slice(0,9))):t.direction=c.w0.identity(new Float64Array(9)),t.indexToWorld=new Float64Array(16),t.worldToIndex=new Float64Array(16),r.m.get(e,t,["indexToWorld","worldToIndex"]),r.m.setGetArray(e,t,["origin","spacing"],3),r.m.setGetArray(e,t,["direction"],9),r.m.getArray(e,t,["extent"],6),function(e,t){t.classHierarchy.push("vtkImageData"),e.setExtent=function(){if(t.deleted)return u("instance deleted - cannot call any method"),!1;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];const o=1===r.length?r[0]:r;if(6!==o.length)return!1;const a=t.extent.some(((e,t)=>e!==o[t]));return a&&(t.extent=o.slice(),t.dataDescription=s.A.getDataDescriptionFromExtent(t.extent),e.modified()),a},e.setDimensions=function(){let n,r,i;if(t.deleted)u("instance deleted - cannot call any method");else{if(1===arguments.length){const e=arguments.length<=0?void 0:arguments[0];n=e[0],r=e[1],i=e[2]}else{if(3!==arguments.length)return void u("Bad dimension specification");n=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1],i=arguments.length<=2?void 0:arguments[2]}e.setExtent(0,n-1,0,r-1,0,i-1)}},e.getDimensions=()=>[t.extent[1]-t.extent[0]+1,t.extent[3]-t.extent[2]+1,t.extent[5]-t.extent[4]+1],e.getNumberOfCells=()=>{const t=e.getDimensions();let n=1;for(let e=0;e<3;e++){if(0===t[e])return 0;t[e]>1&&(n*=t[e]-1)}return n},e.getNumberOfPoints=()=>{const t=e.getDimensions();return t[0]*t[1]*t[2]},e.getPoint=n=>{const r=e.getDimensions();if(0===r[0]||0===r[1]||0===r[2])return u("Requesting a point from an empty image."),null;const i=new Float64Array(3);switch(t.dataDescription){case l.e.EMPTY:return null;case l.e.SINGLE_POINT:break;case l.e.X_LINE:i[0]=n;break;case l.e.Y_LINE:i[1]=n;break;case l.e.Z_LINE:i[2]=n;break;case l.e.XY_PLANE:i[0]=n%r[0],i[1]=n/r[0];break;case l.e.YZ_PLANE:i[1]=n%r[1],i[2]=n/r[1];break;case l.e.XZ_PLANE:i[0]=n%r[0],i[2]=n/r[0];break;case l.e.XYZ_GRID:i[0]=n%r[0],i[1]=n/r[0]%r[1],i[2]=n/(r[0]*r[1]);break;default:u("Invalid dataDescription")}const o=[0,0,0];return e.indexToWorld(i,o),o},e.getBounds=()=>e.extentToBounds(e.getSpatialExtent()),e.extentToBounds=e=>o.Ay.transformBounds(e,t.indexToWorld),e.getSpatialExtent=()=>o.Ay.inflate([...t.extent],.5),e.computeTransforms=()=>{c.pB.fromTranslation(t.indexToWorld,t.origin),t.indexToWorld[0]=t.direction[0],t.indexToWorld[1]=t.direction[1],t.indexToWorld[2]=t.direction[2],t.indexToWorld[4]=t.direction[3],t.indexToWorld[5]=t.direction[4],t.indexToWorld[6]=t.direction[5],t.indexToWorld[8]=t.direction[6],t.indexToWorld[9]=t.direction[7],t.indexToWorld[10]=t.direction[8],c.pB.scale(t.indexToWorld,t.indexToWorld,t.spacing),c.pB.invert(t.worldToIndex,t.indexToWorld)},e.indexToWorld=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return c.eR.transformMat4(n,e,t.indexToWorld),n},e.indexToWorldVec3=e.indexToWorld,e.worldToIndex=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return c.eR.transformMat4(n,e,t.worldToIndex),n},e.worldToIndexVec3=e.worldToIndex,e.indexToWorldBounds=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return o.Ay.transformBounds(e,t.indexToWorld,n)},e.worldToIndexBounds=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return o.Ay.transformBounds(e,t.worldToIndex,n)},e.onModified(e.computeTransforms),e.computeTransforms(),e.getCenter=()=>o.Ay.getCenter(e.getBounds()),e.computeHistogram=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=[0,0,0,0,0,0];e.worldToIndexBounds(t,r);const a=[0,0,0],s=[0,0,0];o.Ay.computeCornerPoints(r,a,s),(0,i.b)(a,a),(0,i.b)(s,s);const l=e.getDimensions();(0,i.c)(a,[0,0,0],[l[0]-1,l[1]-1,l[2]-1],a),(0,i.c)(s,[0,0,0],[l[0]-1,l[1]-1,l[2]-1],s);const c=l[0],u=l[0]*l[1],d=e.getPointData().getScalars().getData();let f=-1/0,g=1/0,m=0,h=0,p=0;for(let e=a[2];e<=s[2];e++)for(let t=a[1];t<=s[1];t++){let i=a[0]+t*c+e*u;for(let o=a[0];o<=s[0];o++){if(!n||n([o,t,e],r)){const e=d[i];e>f&&(f=e),e<g&&(g=e),m+=e*e,h+=e,p+=1}++i}}const v=p>0?h/p:0,y=p?Math.abs(m/p-v*v):0;return{minimum:g,maximum:f,average:v,variance:y,sigma:Math.sqrt(y),count:p}},e.computeIncrements=function(e){const t=[];let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;for(let r=0;r<3;++r)t[r]=n,n*=e[2*r+1]-e[2*r]+1;return t},e.computeOffsetIndex=t=>{let[n,r,i]=t;const o=e.getExtent(),a=e.getPointData().getScalars().getNumberOfComponents(),s=e.computeIncrements(o,a);return Math.floor((Math.round(n)-o[0])*s[0]+(Math.round(r)-o[2])*s[1]+(Math.round(i)-o[4])*s[2])},e.getOffsetIndexFromWorld=t=>{const n=e.getExtent(),r=e.worldToIndex(t);for(let e=0;e<3;++e)if(r[e]<n[2*e]||r[e]>n[2*e+1])return u(`GetScalarPointer: Pixel ${r} is not in memory. Current extent = ${n}`),NaN;return e.computeOffsetIndex(r)},e.getScalarValueFromWorld=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=e.getPointData().getScalars().getNumberOfComponents();if(n<0||n>=r)return u(`GetScalarPointer: Scalar Component ${n} is not within bounds. Current Scalar numberOfComponents: ${r}`),NaN;const i=e.getOffsetIndexFromWorld(t);return Number.isNaN(i)?i:e.getPointData().getScalars().getComponent(i,n)}}(e,t)}var g={newInstance:r.m.newInstance(f,"vtkImageData"),extend:f}},99178:(e,t,n)=>{n.d(t,{p:()=>u});const r=Symbol("Comlink.proxy"),i=Symbol("Comlink.endpoint"),o=Symbol("Comlink.releaseProxy"),a=Symbol("Comlink.finalizer"),s=Symbol("Comlink.thrown"),l=e=>"object"==typeof e&&null!==e||"function"==typeof e,c=new Map([["proxy",{canHandle:e=>l(e)&&e[r],serialize(e){const{port1:t,port2:n}=new MessageChannel;return u(e,t),[n,[n]]},deserialize(e){return e.start(),p(e,[],t);var t}}],["throw",{canHandle:e=>l(e)&&s in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function u(e,t=globalThis,n=["*"]){t.addEventListener("message",(function i(o){if(!o||!o.data)return;if(!function(e,t){for(const n of e){if(t===n||"*"===n)return!0;if(n instanceof RegExp&&n.test(t))return!0}return!1}(n,o.origin))return void console.warn(`Invalid origin '${o.origin}' for comlink proxy`);const{id:l,type:c,path:f}=Object.assign({path:[]},o.data),g=(o.data.argumentList||[]).map(I);let m;try{const t=f.slice(0,-1).reduce(((e,t)=>e[t]),e),n=f.reduce(((e,t)=>e[t]),e);switch(c){case"GET":m=n;break;case"SET":t[f.slice(-1)[0]]=I(o.data.value),m=!0;break;case"APPLY":m=n.apply(t,g);break;case"CONSTRUCT":m=function(e){return Object.assign(e,{[r]:!0})}(new n(...g));break;case"ENDPOINT":{const{port1:t,port2:n}=new MessageChannel;u(e,n),m=function(e,t){return y.set(e,t),e}(t,[t])}break;case"RELEASE":m=void 0;break;default:return}}catch(e){m={value:e,[s]:0}}Promise.resolve(m).catch((e=>({value:e,[s]:0}))).then((n=>{const[r,o]=w(n);t.postMessage(Object.assign(Object.assign({},r),{id:l}),o),"RELEASE"===c&&(t.removeEventListener("message",i),d(t),a in e&&"function"==typeof e[a]&&e[a]())})).catch((e=>{const[n,r]=w({value:new TypeError("Unserializable return value"),[s]:0});t.postMessage(Object.assign(Object.assign({},n),{id:l}),r)}))})),t.start&&t.start()}function d(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function f(e){if(e)throw new Error("Proxy has been released and is not useable")}function g(e){return A(e,{type:"RELEASE"}).then((()=>{d(e)}))}const m=new WeakMap,h="FinalizationRegistry"in globalThis&&new FinalizationRegistry((e=>{const t=(m.get(e)||0)-1;m.set(e,t),0===t&&g(e)}));function p(e,t=[],n=function(){}){let r=!1;const a=new Proxy(n,{get(n,i){if(f(r),i===o)return()=>{!function(e){h&&h.unregister(e)}(a),g(e),r=!0};if("then"===i){if(0===t.length)return{then:()=>a};const n=A(e,{type:"GET",path:t.map((e=>e.toString()))}).then(I);return n.then.bind(n)}return p(e,[...t,i])},set(n,i,o){f(r);const[a,s]=w(o);return A(e,{type:"SET",path:[...t,i].map((e=>e.toString())),value:a},s).then(I)},apply(n,o,a){f(r);const s=t[t.length-1];if(s===i)return A(e,{type:"ENDPOINT"}).then(I);if("bind"===s)return p(e,t.slice(0,-1));const[l,c]=v(a);return A(e,{type:"APPLY",path:t.map((e=>e.toString())),argumentList:l},c).then(I)},construct(n,i){f(r);const[o,a]=v(i);return A(e,{type:"CONSTRUCT",path:t.map((e=>e.toString())),argumentList:o},a).then(I)}});return function(e,t){const n=(m.get(t)||0)+1;m.set(t,n),h&&h.register(e,t,e)}(a,e),a}function v(e){const t=e.map(w);return[t.map((e=>e[0])),(n=t.map((e=>e[1])),Array.prototype.concat.apply([],n))];var n}const y=new WeakMap;function w(e){for(const[t,n]of c)if(n.canHandle(e)){const[r,i]=n.serialize(e);return[{type:"HANDLER",name:t,value:r},i]}return[{type:"RAW",value:e},y.get(e)||[]]}function I(e){switch(e.type){case"HANDLER":return c.get(e.name).deserialize(e.value);case"RAW":return e.value}}function A(e,t,n){return new Promise((r=>{const i=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.addEventListener("message",(function t(n){n.data&&n.data.id&&n.data.id===i&&(e.removeEventListener("message",t),r(n.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:i},t),n)}))}},75210:(e,t,n)=>{n.d(t,{h1:()=>r.Ay,yl:()=>i.A,lq:()=>o.lq,sG:()=>o.sG,Zc:()=>o.Ay});var r=n(81068),i=(n(18642),n(38153)),o=(n(19743),n(5739),n(67800),n(11472),n(33760),n(47803),n(80130),n(52827),n(13723),n(22543),n(97315),n(48210),n(95211),n(67049),n(36426),n(64196),n(61515),n(26892),n(37412),n(57623),n(97982),n(3581),n(51963),n(35457),n(83254),n(49115),n(43523),n(14029),n(36820),n(84201),n(55973),n(40049),n(82061),n(65591),n(96945),n(66871),n(47598));n(77097);n(25475),n(39034),n(95388),n(69010),n(91804),n(23526),n(60786),n(18949),n(77050),n(29351),n(59128),n(47051),n(78603),n(59043)},57623:(e,t,n)=>{},65481:(e,t,n)=>{n.d(t,{GW:()=>r.A,Dj:()=>i.A,sH:()=>o.A});var r=n(1283),i=(n(82043),n(43724),n(96184),n(2728),n(61847),n(73524),n(20825)),o=(n(32204),n(34107),n(66822));n(33637),n(62911),n(85351),n(83441),n(26093),n(86617),n(69277),n(34121),n(84444)}}]);
//# sourceMappingURL=5252.bundle.14720459f6fcc3d6133d.js.map