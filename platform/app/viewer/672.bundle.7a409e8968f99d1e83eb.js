"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[672],{75183:(e,o,t)=>{var a;t.d(o,{A:()=>n}),function(e){e.Interaction="Interaction",e.HandlesUpdated="HandlesUpdated",e.StatsUpdated="StatsUpdated",e.InitialSetup="InitialSetup",e.Completed="Completed",e.InterpolationUpdated="InterpolationUpdated"}(a||(a={}));const n=a},94021:(e,o,t)=>{var a;t.d(o,{A:()=>n}),function(e){e.TOOL_ACTIVATED="CORNERSTONE_TOOLS_TOOL_ACTIVATED",e.TOOLGROUP_VIEWPORT_ADDED="CORNERSTONE_TOOLS_TOOLGROUP_VIEWPORT_ADDED",e.TOOLGROUP_VIEWPORT_REMOVED="CORNERSTONE_TOOLS_TOOLGROUP_VIEWPORT_REMOVED",e.TOOL_MODE_CHANGED="CORNERSTONE_TOOLS_TOOL_MODE_CHANGED",e.ANNOTATION_ADDED="CORNERSTONE_TOOLS_ANNOTATION_ADDED",e.ANNOTATION_COMPLETED="CORNERSTONE_TOOLS_ANNOTATION_COMPLETED",e.ANNOTATION_MODIFIED="CORNERSTONE_TOOLS_ANNOTATION_MODIFIED",e.ANNOTATION_REMOVED="CORNERSTONE_TOOLS_ANNOTATION_REMOVED",e.ANNOTATION_SELECTION_CHANGE="CORNERSTONE_TOOLS_ANNOTATION_SELECTION_CHANGE",e.ANNOTATION_LOCK_CHANGE="CORNERSTONE_TOOLS_ANNOTATION_LOCK_CHANGE",e.ANNOTATION_VISIBILITY_CHANGE="CORNERSTONE_TOOLS_ANNOTATION_VISIBILITY_CHANGE",e.ANNOTATION_RENDERED="CORNERSTONE_TOOLS_ANNOTATION_RENDERED",e.ANNOTATION_INTERPOLATION_PROCESS_COMPLETED="CORNERSTONE_TOOLS_ANNOTATION_INTERPOLATION_PROCESS_COMPLETED",e.INTERPOLATED_ANNOTATIONS_REMOVED="CORNERSTONE_TOOLS_INTERPOLATED_ANNOTATIONS_REMOVED",e.SEGMENTATION_MODIFIED="CORNERSTONE_TOOLS_SEGMENTATION_MODIFIED",e.SEGMENTATION_RENDERED="CORNERSTONE_TOOLS_SEGMENTATION_RENDERED",e.SEGMENTATION_REPRESENTATION_ADDED="CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_ADDED",e.SEGMENTATION_ADDED="CORNERSTONE_TOOLS_SEGMENTATION_ADDED",e.SEGMENTATION_REPRESENTATION_MODIFIED="CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_MODIFIED",e.SEGMENTATION_REMOVED="CORNERSTONE_TOOLS_SEGMENTATION_REMOVED",e.SEGMENTATION_REPRESENTATION_REMOVED="CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_REMOVED",e.SEGMENTATION_DATA_MODIFIED="CORNERSTONE_TOOLS_SEGMENTATION_DATA_MODIFIED",e.KEY_DOWN="CORNERSTONE_TOOLS_KEY_DOWN",e.KEY_UP="CORNERSTONE_TOOLS_KEY_UP",e.MOUSE_DOWN="CORNERSTONE_TOOLS_MOUSE_DOWN",e.MOUSE_UP="CORNERSTONE_TOOLS_MOUSE_UP",e.MOUSE_DOWN_ACTIVATE="CORNERSTONE_TOOLS_MOUSE_DOWN_ACTIVATE",e.MOUSE_DRAG="CORNERSTONE_TOOLS_MOUSE_DRAG",e.MOUSE_MOVE="CORNERSTONE_TOOLS_MOUSE_MOVE",e.MOUSE_CLICK="CORNERSTONE_TOOLS_MOUSE_CLICK",e.MOUSE_DOUBLE_CLICK="CORNERSTONE_TOOLS_MOUSE_DOUBLE_CLICK",e.MOUSE_WHEEL="CORNERSTONE_TOOLS_MOUSE_WHEEL",e.TOUCH_START="CORNERSTONE_TOOLS_TOUCH_START",e.TOUCH_START_ACTIVATE="CORNERSTONE_TOOLS_TOUCH_START_ACTIVATE",e.TOUCH_PRESS="CORNERSTONE_TOOLS_TOUCH_PRESS",e.TOUCH_DRAG="CORNERSTONE_TOOLS_TOUCH_DRAG",e.TOUCH_END="CORNERSTONE_TOOLS_TOUCH_END",e.TOUCH_TAP="CORNERSTONE_TOOLS_TAP",e.TOUCH_SWIPE="CORNERSTONE_TOOLS_SWIPE"}(a||(a={}));const n=a},18682:(e,o,t)=>{var a;t.d(o,{A:()=>n}),function(e){e.Labelmap="Labelmap",e.Contour="Contour",e.Surface="Surface"}(a||(a={}));const n=a},84093:(e,o,t)=>{var a;t.d(o,{A:()=>n}),function(e){e.OnInteractionStart="onInteractionStart",e.OnInteractionEnd="onInteractionEnd",e.Preview="preview",e.RejectPreview="rejectPreview",e.AcceptPreview="acceptPreview",e.Fill="fill",e.StrategyFunction="strategyFunction",e.CreateIsInThreshold="createIsInThreshold",e.Initialize="initialize",e.INTERNAL_setValue="setValue",e.ComputeInnerCircleRadius="computeInnerCircleRadius"}(a||(a={}));const n=a},66452:(e,o,t)=>{var a,n;t.d(o,{i:()=>a,q:()=>n}),function(e){e[e.Primary=1]="Primary",e[e.Secondary=2]="Secondary",e[e.Primary_And_Secondary=3]="Primary_And_Secondary",e[e.Auxiliary=4]="Auxiliary",e[e.Primary_And_Auxiliary=5]="Primary_And_Auxiliary",e[e.Secondary_And_Auxiliary=6]="Secondary_And_Auxiliary",e[e.Primary_And_Secondary_And_Auxiliary=7]="Primary_And_Secondary_And_Auxiliary",e[e.Fourth_Button=8]="Fourth_Button",e[e.Fifth_Button=16]="Fifth_Button",e[e.Wheel=524288]="Wheel",e[e.Wheel_Primary=524289]="Wheel_Primary"}(a||(a={})),function(e){e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.Meta=91]="Meta",e[e.ShiftCtrl=1617]="ShiftCtrl",e[e.ShiftAlt=1618]="ShiftAlt",e[e.ShiftMeta=1691]="ShiftMeta",e[e.CtrlAlt=1718]="CtrlAlt",e[e.CtrlMeta=1791]="CtrlMeta",e[e.AltMeta=1891]="AltMeta"}(n||(n={}))},49892:(e,o,t)=>{var a;t.d(o,{A:()=>n}),function(e){e.Active="Active",e.Passive="Passive",e.Enabled="Enabled",e.Disabled="Disabled"}(a||(a={}));const n=a},10401:(e,o,t)=>{var a;t.d(o,{H:()=>a}),function(e){e.UP="UP",e.DOWN="DOWN",e.LEFT="LEFT",e.RIGHT="RIGHT"}(a||(a={}))},99737:(e,o,t)=>{t.r(o),t.d(o,{AnnotationStyleStates:()=>l,ChangeTypes:()=>T.A,Events:()=>s.A,KeyboardBindings:()=>n.q,MouseBindings:()=>n.i,SegmentationRepresentations:()=>d.A,StrategyCallbacks:()=>u.A,Swipe:()=>c.H,ToolModes:()=>i.A,WorkerTypes:()=>m});var a,n=t(66452),i=t(49892);!function(e){e.Default="",e.Highlighted="Highlighted",e.Selected="Selected",e.Locked="Locked",e.AutoGenerated="AutoGenerated"}(a||(a={}));const l=a;var r,s=t(94021),d=t(18682),c=t(10401),u=t(84093),T=t(75183);!function(e){e.POLYSEG_CONTOUR_TO_LABELMAP="Converting Contour to Labelmap",e.POLYSEG_SURFACE_TO_LABELMAP="Converting Surfaces to Labelmap",e.POLYSEG_CONTOUR_TO_SURFACE="Converting Contour to Surface",e.POLYSEG_LABELMAP_TO_SURFACE="Converting Labelmap to Surface",e.SURFACE_CLIPPING="Clipping Surfaces"}(r||(r={}));const m=r},90672:(e,o,t)=>{t.r(o),t.d(o,{default:()=>b});var a=t(29463);const{createButton:n}=a.hx,i=[{commandName:"setSourceViewportForReferenceLinesTool",context:"CORNERSTONE"}],l={commandName:"setToolActiveToolbar",commandOptions:{toolGroupIds:["default","mpr","SRToolGroup","volume3d"]}},r=[{id:"Zoom",uiType:"ohif.radioGroup",props:{icon:"tool-zoom",label:"Zoom",commands:l,evaluate:"evaluate.cornerstoneTool"}},{id:"WindowLevel",uiType:"ohif.radioGroup",props:{icon:"tool-window-level",label:"Window Level",commands:l,evaluate:"evaluate.cornerstoneTool"}},{id:"Pan",uiType:"ohif.radioGroup",props:{icon:"tool-move",label:"Pan",commands:l,evaluate:"evaluate.cornerstoneTool"}},{id:"TrackballRotate",uiType:"ohif.radioGroup",props:{type:"tool",icon:"tool-3d-rotate",label:"3D Rotate",commands:l,evaluate:{name:"evaluate.cornerstoneTool",disabledText:"Select a 3D viewport to enable this tool"}}},{id:"Capture",uiType:"ohif.radioGroup",props:{icon:"tool-capture",label:"Capture",commands:"showDownloadViewportModal",evaluate:["evaluate.action",{name:"evaluate.viewport.supported",unsupportedViewportTypes:["video","wholeSlide"]}]}},{id:"Layout",uiType:"ohif.layoutSelector",props:{rows:3,columns:4,evaluate:"evaluate.action",commands:"setViewportGridLayout"}},{id:"Crosshairs",uiType:"ohif.radioGroup",props:{icon:"tool-crosshair",label:"Crosshairs",commands:{commandName:"setToolActiveToolbar",commandOptions:{toolGroupIds:["mpr"]}},evaluate:{name:"evaluate.cornerstoneTool",disabledText:"Select an MPR viewport to enable this tool"}}},{id:"MoreTools",uiType:"ohif.splitButton",props:{groupId:"MoreTools",evaluate:"evaluate.group.promoteToPrimaryIfCornerstoneToolNotActiveInTheList",primary:n({id:"Reset",icon:"tool-reset",tooltip:"Reset View",label:"Reset",commands:"resetViewport",evaluate:"evaluate.action"}),secondary:{icon:"chevron-down",label:"",tooltip:"More Tools"},items:[n({id:"Reset",icon:"tool-reset",label:"Reset View",tooltip:"Reset View",commands:"resetViewport",evaluate:"evaluate.action"}),n({id:"rotate-right",icon:"tool-rotate-right",label:"Rotate Right",tooltip:"Rotate +90",commands:"rotateViewportCW",evaluate:"evaluate.action"}),n({id:"flipHorizontal",icon:"tool-flip-horizontal",label:"Flip Horizontal",tooltip:"Flip Horizontally",commands:"flipViewportHorizontal",evaluate:["evaluate.viewportProperties.toggle",{name:"evaluate.viewport.supported",unsupportedViewportTypes:["volume3d"]}]}),n({id:"ReferenceLines",icon:"tool-referenceLines",label:"Reference Lines",tooltip:"Show Reference Lines",commands:"toggleEnabledDisabledToolbar",listeners:{[a.sI.EVENTS.ACTIVE_VIEWPORT_ID_CHANGED]:i,[a.sI.EVENTS.VIEWPORTS_READY]:i},evaluate:"evaluate.cornerstoneTool.toggle"}),n({id:"ImageOverlayViewer",icon:"toggle-dicom-overlay",label:"Image Overlay",tooltip:"Toggle Image Overlay",commands:"toggleEnabledDisabledToolbar",evaluate:"evaluate.cornerstoneTool.toggle"}),n({id:"StackScroll",icon:"tool-stack-scroll",label:"Stack Scroll",tooltip:"Stack Scroll",commands:l,evaluate:"evaluate.cornerstoneTool"}),n({id:"invert",icon:"tool-invert",label:"Invert",tooltip:"Invert Colors",commands:"invertViewport",evaluate:"evaluate.viewportProperties.toggle"}),n({id:"Probe",icon:"tool-probe",label:"Probe",tooltip:"Probe",commands:l,evaluate:"evaluate.cornerstoneTool"}),n({id:"Cine",icon:"tool-cine",label:"Cine",tooltip:"Cine",commands:"toggleCine",evaluate:["evaluate.cine",{name:"evaluate.viewport.supported",unsupportedViewportTypes:["volume3d"]}]}),n({id:"Angle",icon:"tool-angle",label:"Angle",tooltip:"Angle",commands:l,evaluate:"evaluate.cornerstoneTool"}),n({id:"Magnify",icon:"tool-magnify",label:"Zoom-in",tooltip:"Zoom-in",commands:l,evaluate:"evaluate.cornerstoneTool"}),n({id:"RectangleROI",icon:"tool-rectangle",label:"Rectangle",tooltip:"Rectangle",commands:l,evaluate:"evaluate.cornerstoneTool"}),n({id:"CalibrationLine",icon:"tool-calibration",label:"Calibration",tooltip:"Calibration Line",commands:l,evaluate:"evaluate.cornerstoneTool"}),n({id:"TagBrowser",icon:"dicom-tag-browser",label:"Dicom Tag Browser",tooltip:"Dicom Tag Browser",commands:"openDICOMTagViewer"}),n({id:"AdvancedMagnify",icon:"icon-tool-loupe",label:"Magnify Probe",tooltip:"Magnify Probe",commands:"toggleActiveDisabledToolbar",evaluate:"evaluate.cornerstoneTool.toggle.ifStrictlyDisabled"}),n({id:"UltrasoundDirectionalTool",icon:"icon-tool-ultrasound-bidirectional",label:"Ultrasound Directional",tooltip:"Ultrasound Directional",commands:l,evaluate:["evaluate.cornerstoneTool",{name:"evaluate.modality.supported",supportedModalities:["US"]}]}),n({id:"WindowLevelRegion",icon:"icon-tool-window-region",label:"Window Level Region",tooltip:"Window Level Region",commands:l,evaluate:"evaluate.cornerstoneTool"})]}}],s=[{id:"BrushTools",uiType:"ohif.buttonGroup",props:{groupId:"BrushTools",items:[{id:"Brush",icon:"icon-tool-brush",label:"Brush",evaluate:{name:"evaluate.cornerstone.segmentation",toolNames:["CircularBrush","SphereBrush"],disabledText:"Create new segmentation to enable this tool."},options:[{name:"Radius (mm)",id:"brush-radius",type:"range",min:.5,max:99.5,step:.5,value:25,commands:{commandName:"setBrushSize",commandOptions:{toolNames:["CircularBrush","SphereBrush"]}}},{name:"Shape",type:"radio",id:"brush-mode",value:"CircularBrush",values:[{value:"CircularBrush",label:"Circle"},{value:"SphereBrush",label:"Sphere"}],commands:"setToolActiveToolbar"}]},{id:"Eraser",icon:"icon-tool-eraser",label:"Eraser",evaluate:{name:"evaluate.cornerstone.segmentation",toolNames:["CircularEraser","SphereEraser"]},options:[{name:"Radius (mm)",id:"eraser-radius",type:"range",min:.5,max:99.5,step:.5,value:25,commands:{commandName:"setBrushSize",commandOptions:{toolNames:["CircularEraser","SphereEraser"]}}},{name:"Shape",type:"radio",id:"eraser-mode",value:"CircularEraser",values:[{value:"CircularEraser",label:"Circle"},{value:"SphereEraser",label:"Sphere"}],commands:"setToolActiveToolbar"}]},{id:"Threshold",icon:"icon-tool-threshold",label:"Threshold Tool",evaluate:{name:"evaluate.cornerstone.segmentation",toolNames:["ThresholdCircularBrush","ThresholdSphereBrush"]},options:[{name:"Radius (mm)",id:"threshold-radius",type:"range",min:.5,max:99.5,step:.5,value:25,commands:{commandName:"setBrushSize",commandOptions:{toolNames:["ThresholdCircularBrush","ThresholdSphereBrush","ThresholdCircularBrushDynamic"]}}},{name:"Threshold",type:"radio",id:"dynamic-mode",value:"ThresholdRange",values:[{value:"ThresholdDynamic",label:"Dynamic"},{value:"ThresholdRange",label:"Range"}],commands:({value:e,commandsManager:o,options:t})=>{if("ThresholdDynamic"===e)return void o.run("setToolActive",{toolName:"ThresholdCircularBrushDynamic"});const a=t.find((e=>"threshold-shape"===e.id));o.run("setToolActiveToolbar",{toolName:a.value})}},{name:"Shape",type:"radio",id:"threshold-shape",value:"ThresholdCircularBrush",values:[{value:"ThresholdCircularBrush",label:"Circle"},{value:"ThresholdSphereBrush",label:"Sphere"}],condition:({options:e})=>"ThresholdRange"===e.find((e=>"dynamic-mode"===e.id)).value,commands:"setToolActiveToolbar"},{name:"ThresholdRange",type:"double-range",id:"threshold-range",min:-1e3,max:1e3,step:1,value:[100,600],condition:({options:e})=>"ThresholdRange"===e.find((e=>"dynamic-mode"===e.id)).value,commands:{commandName:"setThresholdRange",commandOptions:{toolNames:["ThresholdCircularBrush","ThresholdSphereBrush"]}}}]}]}},{id:"Shapes",uiType:"ohif.radioGroup",props:{label:"Shapes",evaluate:{name:"evaluate.cornerstone.segmentation",toolNames:["CircleScissor","SphereScissor","RectangleScissor"]},icon:"icon-tool-shape",options:[{name:"Shape",type:"radio",value:"CircleScissor",id:"shape-mode",values:[{value:"CircleScissor",label:"Circle"},{value:"SphereScissor",label:"Sphere"},{value:"RectangleScissor",label:"Rectangle"}],commands:"setToolActiveToolbar"}]}}],d={"viewport-0":"rgb(200, 0, 0)","viewport-1":"rgb(200, 200, 0)","viewport-2":"rgb(0, 200, 0)"},c={axial:"rgb(200, 0, 0)",sagittal:"rgb(200, 200, 0)",coronal:"rgb(0, 200, 0)"};function u(e){const{toolNames:o,Enums:t}=e.exports;return{active:[{toolName:o.WindowLevel,bindings:[{mouseButton:t.MouseBindings.Primary}]},{toolName:o.Pan,bindings:[{mouseButton:t.MouseBindings.Auxiliary}]},{toolName:o.Zoom,bindings:[{mouseButton:t.MouseBindings.Secondary}]},{toolName:o.StackScroll,bindings:[{mouseButton:t.MouseBindings.Wheel}]}],passive:[{toolName:"CircularBrush",parentTool:"Brush",configuration:{activeStrategy:"FILL_INSIDE_CIRCLE"}},{toolName:"CircularEraser",parentTool:"Brush",configuration:{activeStrategy:"ERASE_INSIDE_CIRCLE"}},{toolName:"SphereBrush",parentTool:"Brush",configuration:{activeStrategy:"FILL_INSIDE_SPHERE"}},{toolName:"SphereEraser",parentTool:"Brush",configuration:{activeStrategy:"ERASE_INSIDE_SPHERE"}},{toolName:"ThresholdCircularBrush",parentTool:"Brush",configuration:{activeStrategy:"THRESHOLD_INSIDE_CIRCLE"}},{toolName:"ThresholdSphereBrush",parentTool:"Brush",configuration:{activeStrategy:"THRESHOLD_INSIDE_SPHERE"}},{toolName:"ThresholdCircularBrushDynamic",parentTool:"Brush",configuration:{activeStrategy:"THRESHOLD_INSIDE_CIRCLE",strategySpecificConfiguration:{THRESHOLD:{isDynamic:!0,dynamicRadius:3}}}},{toolName:o.CircleScissors},{toolName:o.RectangleScissors},{toolName:o.SphereScissors},{toolName:o.StackScroll},{toolName:o.Magnify},{toolName:o.WindowLevelRegion},{toolName:o.UltrasoundDirectional}],disabled:[{toolName:o.ReferenceLines},{toolName:o.AdvancedMagnify}]}}const T=function(e,o,t){!function(e,o,t,a){const n=u(e.getModuleEntry("@ohif/extension-cornerstone.utilityModule.tools"));o.createToolGroupAndAddTools(a,n)}(e,o,0,"default"),function(e,o,t){const a=e.getModuleEntry("@ohif/extension-cornerstone.utilityModule.tools"),n=e._servicesManager,{cornerstoneViewportService:i}=n.services,l=u(a);l.disabled.push({toolName:a.exports.toolNames.Crosshairs,configuration:{viewportIndicators:!0,viewportIndicatorsConfig:{circleRadius:5,xOffset:.95,yOffset:.05},disableOnPassive:!0,autoPan:{enabled:!1,panSize:10},getReferenceLineColor:e=>{const o=i.getViewportInfo(e),t=o?.viewportOptions;return t?d[t.id]||c[t.orientation]||"#0c0":(console.warn("missing viewport?",e),"#0c0")}}},{toolName:a.exports.toolNames.ReferenceLines}),o.createToolGroupAndAddTools("mpr",l)}(e,o),function(e,o){const t=e.getModuleEntry("@ohif/extension-cornerstone.utilityModule.tools"),{toolNames:a,Enums:n}=t.exports,i={active:[{toolName:a.TrackballRotateTool,bindings:[{mouseButton:n.MouseBindings.Primary}]},{toolName:a.Zoom,bindings:[{mouseButton:n.MouseBindings.Secondary}]},{toolName:a.Pan,bindings:[{mouseButton:n.MouseBindings.Auxiliary}]}]};o.createToolGroupAndAddTools("volume3d",i)}(e,o)},m=JSON.parse('{"UU":"mode-t-chaii"}').UU,O={study_id_basal:"1.3.51.0.1.1.172.19.3.128.2882759.2882698",segmentations_data:[{id:"dc58bced-995f-4ef8-bc13-bfff1c05606f",created_at:"2024-12-04T22:37:09.172700Z",updated_at:"2024-12-04T22:37:09.172716Z",is_deleted:!1,name:"test",segmentation_id:null,orthanc_id:"7c10181e-e506c38b-76f227ef-45328eaf-5e4be833",status:"FINISHED",series:"38cc8c1c-aa3f-42f7-94da-3d0fcdba8163",segments:[{id:"cc679843-ad12-4ccd-9851-426664318e3c",created_at:"2024-12-04T22:37:09.174416Z",updated_at:"2024-12-04T22:37:09.174425Z",is_deleted:!1,name:"Segment #1",label:"Segment #1",tracking_id:"1.2.826.0.1.3680043.8.498.11105252268930645618441703623246770449",affected_organs:"test",volume:32318,axial_diameter:null,coronal_diameter:null,sagittal_diameter:null,is_target_lession:!0,classification:null,segmentation_type:"('automatic', 'Automatic')",window_width:null,window_level:null,status:"FINISHED",lesion_segmentation:"dc58bced-995f-4ef8-bc13-bfff1c05606f",user:null,reviewed_by:null,model:null,lesion_segments:[]},{id:"8aa7907d-703e-44cc-9efb-c7cc7703e8b0",created_at:"2024-12-04T22:37:09.176353Z",updated_at:"2024-12-04T22:37:09.176362Z",is_deleted:!1,name:"Segment #2",label:"Segment #2",tracking_id:"1.2.826.0.1.3680043.8.498.12187923523073502176779813617747360192",affected_organs:"test",volume:300334,axial_diameter:null,coronal_diameter:null,sagittal_diameter:null,is_target_lession:!0,classification:null,segmentation_type:"('automatic', 'Automatic')",window_width:null,window_level:null,status:"FINISHED",lesion_segmentation:"dc58bced-995f-4ef8-bc13-bfff1c05606f",user:null,reviewed_by:null,model:null,lesion_segments:[]},{id:"cba59ee0-80d7-453a-a16d-264bac5dc522",created_at:"2024-12-04T22:37:09.177894Z",updated_at:"2024-12-04T22:37:09.177903Z",is_deleted:!1,name:"Segment #3",label:"Segment #3",tracking_id:"1.2.826.0.1.3680043.8.498.13230215384917429116554563969980160699",affected_organs:"test",volume:215813,axial_diameter:null,coronal_diameter:null,sagittal_diameter:null,is_target_lession:!0,classification:null,segmentation_type:"('automatic', 'Automatic')",window_width:null,window_level:null,status:"FINISHED",lesion_segmentation:"dc58bced-995f-4ef8-bc13-bfff1c05606f",user:null,reviewed_by:null,model:null,lesion_segments:[]}],study_date:"2023-10-16T00:00:00Z"},{id:"cdb7e7ae-222c-443d-a05b-50bf15d9fc48",created_at:"2024-12-04T22:39:27.047253Z",updated_at:"2024-12-04T22:39:27.047263Z",is_deleted:!1,name:"test",segmentation_id:null,orthanc_id:"ab89b09a-a3b5aa40-4afccdef-2c102335-1fd020df",status:"FINISHED",series:"c20a2508-b3fe-4203-a4be-e5ab433b1f20",segments:[{id:"789453f3-e433-4ee8-a619-7a3f68af20e3",created_at:"2024-12-04T22:39:27.049034Z",updated_at:"2024-12-04T22:39:27.049041Z",is_deleted:!1,name:"Segment #1",label:"Segment #1",tracking_id:"1.2.826.0.1.3680043.8.498.12589743509522659746329052362277933345",affected_organs:"test",volume:212572,axial_diameter:null,coronal_diameter:null,sagittal_diameter:null,is_target_lession:!0,classification:null,segmentation_type:"('automatic', 'Automatic')",window_width:null,window_level:null,status:"FINISHED",lesion_segmentation:"cdb7e7ae-222c-443d-a05b-50bf15d9fc48",user:null,reviewed_by:null,model:null,lesion_segments:[]},{id:"11d44d33-ed98-4df7-8416-eedac863f1f2",created_at:"2024-12-04T22:39:27.051787Z",updated_at:"2024-12-04T22:39:27.051794Z",is_deleted:!1,name:"Segment #2",label:"Segment #2",tracking_id:"1.2.826.0.1.3680043.8.498.14480479045670969767017487887829543474",affected_organs:"test",volume:319857,axial_diameter:null,coronal_diameter:null,sagittal_diameter:null,is_target_lession:!0,classification:null,segmentation_type:"('automatic', 'Automatic')",window_width:null,window_level:null,status:"FINISHED",lesion_segmentation:"cdb7e7ae-222c-443d-a05b-50bf15d9fc48",user:null,reviewed_by:null,model:null,lesion_segments:["cc679843-ad12-4ccd-9851-426664318e3c"]}],study_date:"2023-10-16T00:00:00Z"}]},_={getSegmentations:async e=>O};var E=t(99737);const S="@ohif/extension-default.layoutTemplateModule.viewerLayout",p="@ohif/extension-default.sopClassHandlerModule.stack",N="@ohif/extension-default.panelModule.seriesList",g="@ohif/extension-cornerstone.viewportModule.cornerstone",v="@ohif/extension-cornerstone-dicom-seg.sopClassHandlerModule.dicom-seg",h="@ohif/extension-cornerstone-dicom-seg.viewportModule.dicom-seg",R="extension-t-chaii.hangingProtocolModule.default",A="extension-t-chaii.panelModule.segmentation",C={"@ohif/extension-default":"^3.0.0","@ohif/extension-cornerstone":"^3.0.0","@ohif/extension-cornerstone-dicom-seg":"^3.0.0","extension-t-chaii":"^0.0.1"},I=[];const f={id:m,modeFactory:function({modeConfiguration:e}){return{id:m,routeName:"ai-segmentations",displayName:"T-CHAII Mode",onModeEnter:async({servicesManager:e,extensionManager:o,commandsManager:t})=>{const{measurementService:a,toolbarService:n,toolGroupService:i,displaySetService:l,segmentationService:d,cornerstoneViewportService:c,customizationService:u,viewportGridService:m,hangingProtocolService:O}=e.services;a.clearMeasurements(),T(o,i,t),n.addButtons(r),n.addButtons(s),n.createButtonSection("primary",["WindowLevel","Pan","Zoom","TrackballRotate","Capture","Layout","Crosshairs","MoreTools"]),n.createButtonSection("segmentationToolbox",["BrushTools","Shapes"]);const S=c.subscribe(c.EVENTS.VIEWPORT_DATA_CHANGED,(async({viewportData:e,viewportId:o})=>{console.log("onDisplaySetsAdded",e);const t=l.getDisplaySetByUID(e.data[e.data.length-1].displaySetInstanceUID);if(!t)return;if("SEG"!==t.Modality)return;console.log("viewportId",o),console.log("displaySet",t),console.log("displaySet.referencedDisplaySetInstanceUID",t.referencedDisplaySetInstanceUID);const{segmentations_data:a}=await _.getSegmentations(t.StudyInstanceUID);console.log("segmentations_data",a);const n=d.getSegmentations();console.log("segmentationsList",n);const i=d.getActiveSegmentation(o);console.log("activeSegmentation",i);const r=d.getSegmentationRepresentations(o,{type:E.SegmentationRepresentations.Labelmap});console.log("labelmaps",r);a.find((e=>e.segmentation_id===i.segmentationId));const s=d.getSegmentation(i.segmentationId);if(!s)return;for(const[e,o]of Object.entries(s.segments)){const t={diameter:0,volume:0,affected_organs:"Unknown"},a={...o,cachedStats:{...o.cachedStats,...t}};s.segments[e]=a}const c={...s,segments:{...s.segments}};d.addOrUpdateSegmentation(c)}));I.push(S.unsubscribe),u.addModeCustomizations([{id:"PanelSegmentation.tableMode",mode:"expanded"}])},onModeExit:({servicesManager:e})=>{const{toolGroupService:o,syncGroupService:t,segmentationService:a,cornerstoneViewportService:n,uiDialogService:i,uiModalService:l}=e.services;I.forEach((e=>e())),i.dismissAll(),l.hide(),o.destroy(),t.destroy(),a.destroy(),n.destroy()},validationTags:{study:[],series:[]},isValidMode:({modalities:e})=>({valid:e.split("\\").includes("CT"),description:"T-CHAII mode only supports the CT modality"}),routes:[{path:"template",layoutTemplate:({location:e,servicesManager:o})=>({id:S,props:{leftPanels:[N],rightPanels:[A],viewports:[{namespace:g,displaySetsToDisplay:[p]},{namespace:h,displaySetsToDisplay:[v]}]}})}],defaultContext:["VIEWER"],hangingProtocol:R,sopClassHandlers:[p,v],extensions:C,hotkeys:[...a.ot.defaults.hotkeyBindings],...e}},extensionDependencies:C},b=f}}]);
//# sourceMappingURL=672.bundle.7a409e8968f99d1e83eb.js.map