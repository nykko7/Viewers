"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[717,2591,4182,1801],{14696:(e,t,a)=>{a.r(t),a.d(t,{default:()=>G});var n={};a.r(n),a.d(n,{updateSegmentationsChartDisplaySet:()=>g});const i=JSON.parse('{"UU":"@ohif/extension-cornerstone-dynamic-volume"}').UU;var s=a(29463),o=a(81985),r=a(55139);const c="CHT",l=s.Wp.guid(),p="1.9.451.13215.7.3.2.7.6.1",{utilities:m}=r;function u(e,t){const a=e.imageIds.reduce(((e,a)=>{const n=s.H8.getInstanceByImageId(a)[t];return void 0!==n&&e.add(n),e}),new Set);return Array.from(a).sort(((e,t)=>e-t))}function d(e,t,{servicesManager:a}){const{displaySetService:n,segmentationService:i,viewportGridService:r}=a.services;let c;const l=n.getActiveDisplaySets().find((e=>{const t=e.instances?.[0];return!!t&&(void 0!==t.FrameReferenceTime||void 0!==t.NumberOfTimeSlices)})).displaySetInstanceUID;for(const[e]of o.cache._volumeCache)if(e.includes(l)){c=e;break}let p;c&&(p=o.cache.getVolume(c));const{StudyInstanceUID:d,StudyDescription:y}=s.H8.getInstanceByImageId(p.imageIds[0]),g=i.getLabelmapVolume(e.segmentationId),S=g?.volumeId,[v,h]=m.dynamicVolume.getDataInTime(p,{maskVolumeId:S}),I=v.length;if(0===I)return[];const D=r.getActiveViewportId(),f=i.getSegmentColor(D,e.segmentationId,1),w=o.utilities.color.rgbToHex(f[0],f[1],f[2]);let C=t.get(p);C||(C=function(e){const t={FrameReferenceTime:{unit:"ms"}},a=Object.keys(t);let n,i;for(let s=0;s<a.length;s++){const o=a[s],r=u(e,o);if(r.length){n=r,i=t[o].unit;break}}if(!n.length){const e=a.join(", ");throw new Error(`Could not extract time points data for the following tags: ${e}`)}const s=function(e,t){const a=["ms","s","m","h"],n=[1e3,60,60],i=a.indexOf(t);let s=1;if(-1!==i){for(let o=i;o<a.length-1;o++){const i=s*n[o];if(e.filter((e=>e>i)).length<=e.length/2)break;s=i,t=a[o+1]}s>1&&(e=e.map((e=>e/s)))}return{timePoints:e,timePointsUnit:t}}(n,i);return n=s.timePoints,i=s.timePointsUnit,{timePoints:n,timePointsUnit:i}}(p),t.set(p,C));const{timePoints:b,timePointsUnit:E}=C;if(b.length!==v[0].length)throw new Error("Invalid number of time points returned");const x=b.length,T=new Array(x);for(let e=0;e<x;e++){const t=v.reduce(((t,a)=>t+a[e]/I),0);T[e]=[b[e],t]}return{StudyInstanceUID:d,StudyDescription:y,chartData:{series:{label:e.label,points:T,color:w},axis:{x:{label:`Time (${E})`},y:{label:"Vl (Bq/ml)"}}}}}function y(e,{servicesManager:t}){if(!e.length)return;const a=new WeakMap,n=e.map((e=>d(e,a,{servicesManager:t}))),{date:i,time:o}=function(){const e=new Date;return{date:e.getFullYear()+("0"+e.getUTCMonth()).slice(-2)+("0"+e.getUTCDate()).slice(-2),time:("0"+e.getUTCHours()).slice(-2)+("0"+e.getUTCMinutes()).slice(-2)+("0"+e.getUTCSeconds()).slice(-2)}}(),r=n.reduce(((e,t)=>[...e,t.chartData.series]),[]),m={SOPClassUID:p,Modality:c,SOPInstanceUID:s.Wp.guid(),SeriesDate:i,SeriesTime:o,SeriesInstanceUID:l,StudyInstanceUID:n[0].StudyInstanceUID,StudyDescription:n[0].StudyDescription,SeriesNumber:100,SeriesDescription:"Segmentation chart series data",chartData:{series:r,axis:{...n[0].chartData.axis}}};return{seriesMetadata:{StudyInstanceUID:m.StudyInstanceUID,StudyDescription:m.StudyDescription,SeriesInstanceUID:m.SeriesInstanceUID,SeriesDescription:m.SeriesDescription,SeriesNumber:m.SeriesNumber,SeriesTime:m.SeriesTime,SOPClassUID:m.SOPClassUID,Modality:m.Modality},instance:m}}function g({servicesManager:e}){const{segmentationService:t}=e.services,a=t.getSegmentations(),{seriesMetadata:n,instance:i}=y(a,{servicesManager:e})??{};n&&i&&(s.H8.addSeriesMetadata([n],!0),s.H8.addInstances([i],!0))}r.Enums.SegmentationRepresentations.Labelmap;const S=({commandsManager:e,servicesManager:t})=>{const a=t.services,{displaySetService:i,viewportGridService:s,segmentationService:c}=a,l={...n,getDynamic4DDisplaySet:()=>i.getActiveDisplaySets().find((e=>{const t=e.instances?.[0];return!!t&&(void 0!==t.FrameReferenceTime||void 0!==t.NumberOfTimeSlices||void 0!==t.TemporalPositionIdentifier)})),getComputedDisplaySets:()=>[...i.getDisplaySetCache().values()].filter((e=>e.isDerived)),exportTimeReportCSV:({segmentations:e,config:t,options:a,summaryStats:n})=>{const i=l.getDynamic4DDisplaySet(),s=i?.displaySetInstanceUID;let p,m;for(const[e]of o.cache._volumeCache)if(e.includes(s)){p=e;break}p&&(m=o.cache.getVolume(p));const u=i.instances[0],d=[];function y(e){const t=e.length,a=e.reduce(((e,t)=>e+t),0)/t,n=e.map((e=>(e-a)**2)).reduce(((e,t)=>e+t),0)/t;return Math.sqrt(n)}d.push(`Patient ID,${u.PatientID},`),d.push(`Study Date,${u.StudyDate},`),d.push(`StudyInstanceUID,${u.StudyInstanceUID},`),d.push(`StudyDescription,${u.StudyDescription},`),d.push(`SeriesInstanceUID,${u.SeriesInstanceUID},`),d.push(""),d.push(""),e.forEach((e=>{const t=c.getLabelmapVolume(e.segmentationId),[a,i]=r.utilities.dynamicVolume.getDataInTime(m,{maskVolumeId:t.volumeId});if(n){let t="Operation,Segmentation Label ID";const n=m.numTimePoints;for(let e=0;e<n;e++)t+=`,Time Point ${e}`;d.push(t);const s=[],o=[],r=[],c=[],l=[],p=[],u=a.length;for(let e=0;e<n;e++){const t=[];let n=0,m=1/0,d=-1/0,g=0,S=0;for(let i=0;i<u;i++){const s=a[i][e];t.push(s),n+=s,s<m&&(m=s,g=i),s>d&&(d=s,S=i)}s.push(n/u),o.push(m),r.push(i[g]),c.push(d),l.push(i[S]),p.push(y(t))}let g=`Mean,${e.label}`;for(let e=0;e<n;e++)g+=`,${s[e]}`;d.push(g),g=`Standard Deviation,${e.label}`;for(let e=0;e<n;e++)g+=`,${p[e]}`;d.push(g),g=`Min,${e.label}`;for(let e=0;e<n;e++)g+=`,${o[e]}`;d.push(g),g=`Max,${e.label}`;for(let e=0;e<n;e++)g+=`,${c[e]}`;d.push(g)}else{let t="Pixel Identifier (IJK),Segmentation Label ID";const n=m.numTimePoints;for(let e=0;e<n;e++)t+=`,Time Point ${e}`;d.push(t);for(let t=0;t<a.length;t++){let n=`${`${i[t][0]}_${i[t][1]}_${i[t][2]}`},${e.label}`;for(let e=0;e<a[t].length;e++)n+=`,${a[t][e]}`;d.push(n)}}}));const g=d.join("\n"),S=`${u.PatientID}.csv`,v=new Blob([g],{type:"text/csv;charset=utf-8;"}),h=document.createElement("a"),I=URL.createObjectURL(v);h.setAttribute("href",I),h.setAttribute("download",S),h.style.visibility="hidden",document.body.appendChild(h),h.click(),document.body.removeChild(h)},swapDynamicWithComputedDisplaySet:({displaySet:e})=>{const t=e,a=i.getDisplaySetCache(),n=[a.keys()],{displaySetInstanceUID:o}=t;n.includes(o)||a.set(o,t);const{viewports:r}=s.getState(),c=l.getDynamic4DDisplaySet(),p=[];for(const[e,t]of r){const e=t,a=e.viewportOptions,{displaySetInstanceUIDs:n}=e,i=n.indexOf(c.displaySetInstanceUID);if(-1!==i){const t={viewportId:e.viewportId,displaySetInstanceUIDs:[...n.slice(0,i),o,...n.slice(i+1)],viewportOptions:{initialImageOptions:a.initialImageOptions,viewportType:"volume",orientation:a.orientation,background:a.background}};p.push(t)}}s.setDisplaySetsForViewports(p)},swapComputedWithDynamicDisplaySet:()=>{const e=l.getDynamic4DDisplaySet(),t=i.getDisplaySetCache(),a=[...t.keys()],{displaySetInstanceUID:n}=e;a.includes(n)||t.set(n,e);const{viewports:o}=s.getState(),r=l.getComputedDisplaySets()[0],c=[];for(const[e,t]of o){const e=t,a=e.viewportOptions,{displaySetInstanceUIDs:i}=e,s=i.indexOf(r.displaySetInstanceUID);if(-1!==s){const t={viewportId:e.viewportId,displaySetInstanceUIDs:[...i.slice(0,s),n,...i.slice(s+1)],viewportOptions:{initialImageOptions:a.initialImageOptions,viewportType:"volume",orientation:a.orientation,background:a.background}};c.push(t)}}s.setDisplaySetsForViewports(c)},createNewLabelMapForDynamicVolume:async({label:e})=>{const{viewports:t,activeViewportId:a}=s.getState(),n=l.getDynamic4DDisplaySet(),o=n.displaySetInstanceUID;let r;if(t.get(a).displaySetInstanceUIDs.includes(o)&&(r=n),!r){const e=i.getDisplaySetCache();for(const[t,a]of e)if(a.referenceDisplaySetUID===o){r=a;break}}if(!r)throw new Error("No reference display set found based on the dynamic data");const p=i.getDisplaySetByUID(r.displaySetInstanceUID),m=await c.createLabelmapForDisplaySet(p,{label:e}),u=t.values().next().value;return await c.addSegmentationRepresentation(u.viewportId,{segmentationId:m}),m}},p={updateSegmentationsChartDisplaySet:{commandFn:l.updateSegmentationsChartDisplaySet,storeContexts:[],options:{}},exportTimeReportCSV:{commandFn:l.exportTimeReportCSV,storeContexts:[],options:{}},swapDynamicWithComputedDisplaySet:{commandFn:l.swapDynamicWithComputedDisplaySet,storeContexts:[],options:{}},createNewLabelMapForDynamicVolume:{commandFn:l.createNewLabelMapForDynamicVolume,storeContexts:[],options:{}},swapComputedWithDynamicDisplaySet:{commandFn:l.swapComputedWithDynamicDisplaySet,storeContexts:[],options:{}}};return{actions:l,definitions:p,defaultContext:"DYNAMIC-VOLUME:CORNERSTONE"}};var v=a(86326),h=a(58851),I=a(43494);function D(){return D=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)({}).hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},D.apply(null,arguments)}const f={sizeClassName:"w-[58px] h-[28px]",arrowsDirection:"horizontal",labelPosition:"bottom"},w=({title:e,tooltip:t})=>v.createElement("div",{className:"flex items-center space-x-1"},v.createElement(h.m_,{content:v.createElement("div",{className:"text-white"},t),position:"bottom-left",tight:!0,tooltipBoxClassName:"max-w-xs p-2"},v.createElement(h.In,{name:"info-link",className:"text-primary-active h-[14px] w-[14px]"})),v.createElement("span",{className:"text-aqua-pale text-[11px] uppercase"},e)),C=({isPlaying:e,onPlayPauseChange:t,fps:a,onFpsChange:n,minFps:i,maxFps:s,currentFrameIndex:r,onFrameChange:c,framesLength:l,onGenerate:p,onDoubleRangeChange:m,onDynamicClick:u})=>{const[d,y]=(0,v.useState)(!1),[g,S]=(0,v.useState)(o.Enums.DynamicOperatorType.SUM),[D,f]=(0,v.useState)([0,l-1]);return v.createElement("div",{className:"flex select-none flex-col"},v.createElement(h.aU,{title:"Controls",childrenClassName:"space-y-4 pb-5 px-5"},v.createElement("div",{className:"mt-2"},v.createElement(w,{title:"View",tooltip:"Select the view mode, 4D to view the dynamic volume or Computed to view the computed volume"}),v.createElement(h.e2,{className:"mt-2 w-full"},v.createElement("button",{className:"w-1/2",onClick:()=>{y(!1),u?.()}},"4D"),v.createElement("button",{className:"w-1/2",onClick:()=>{y(!0)}},"Computed"))),v.createElement("div",null,v.createElement(b,{onPlayPauseChange:t,isPlaying:e,computedView:d,fps:a,onFpsChange:n,minFps:i,maxFps:s,framesLength:l,onFrameChange:c,currentFrameIndex:r})),v.createElement("div",{className:"mt-6 flex flex-col "+(d?"":"ohif-disabled")},v.createElement(w,{title:"Computed Operation",tooltip:v.createElement("div",null,"Operation Buttons (SUM, AVERAGE, SUBTRACT): Select the mathematical operation to be applied to the data set.",v.createElement("br",null)," Range Slider: Choose the numeric range within which the operation will be performed.",v.createElement("br",null),"Generate Button: Execute the chosen operation on the specified range of data."," ")}),v.createElement(h.e2,{className:"mt-2 w-full",separated:!0},v.createElement("button",{className:"w-1/2",onClick:()=>S(o.Enums.DynamicOperatorType.SUM)},o.Enums.DynamicOperatorType.SUM.toString().toUpperCase()),v.createElement("button",{className:"w-1/2",onClick:()=>S(o.Enums.DynamicOperatorType.AVERAGE)},o.Enums.DynamicOperatorType.AVERAGE.toString().toUpperCase()),v.createElement("button",{className:"w-1/2",onClick:()=>S(o.Enums.DynamicOperatorType.SUBTRACT)},o.Enums.DynamicOperatorType.SUBTRACT.toString().toUpperCase())),v.createElement("div",{className:"mt-2 w-full"},v.createElement(I.Jg,{min:0,max:l-1,step:1,defaultValue:D,onValueChange:e=>{m(e),f(e)},formatLabel:e=>Math.round(e),className:"w-full"})),v.createElement(h.$n,{className:"mt-2 !h-[26px] !w-[115px] self-start !p-0",onClick:()=>{p(g)}},"Generate"))))};function b({isPlaying:e,onPlayPauseChange:t,fps:a,minFps:n,maxFps:i,onFpsChange:s,framesLength:o,onFrameChange:r,currentFrameIndex:c,computedView:l}){return v.createElement("div",{className:l&&"ohif-disabled"},v.createElement(w,{title:"4D Controls",tooltip:v.createElement("div",null,"Play/Pause Button: Begin or pause the animation of the 4D visualization. ",v.createElement("br",null)," Frame Selector: Navigate through individual frames of the 4D data. ",v.createElement("br",null)," FPS (Frames Per Second) Selector: Adjust the playback speed of the animation.")}),v.createElement("div",{className:"mt-3 flex justify-between"},v.createElement(h.K0,{className:"bg-customblue-30 h-[26px] w-[58px] rounded-[4px]",onClick:()=>t(!e)},v.createElement(h.In,{name:e?"icon-pause":"icon-play",className:"active:text-primary-light hover:bg-customblue-300 h-[24px] w-[24px] cursor-pointer text-white"})),v.createElement(h.YI,D({value:c,onChange:r,minValue:0,maxValue:o-1,label:"Frame"},f)),v.createElement(h.YI,D({value:a,onChange:s,minValue:n,maxValue:i},f,{label:"FPS"}))))}const E="@ohif/extension-default.sopClassHandlerModule.stack";function x({servicesManager:e,commandsManager:t}){const{cornerstoneViewportService:a,viewportGridService:n,displaySetService:i}=e.services,[{isCineEnabled:s},c]=(0,h.tq)(),[{activeViewportId:l}]=(0,h.ih)(),[p,m]=(0,v.useState)([0,0]),[u,d]=(0,v.useState)([0,0]),[y,g]=(0,v.useState)(null),[S,I]=(0,v.useState)(null),[D,f]=(0,v.useState)(20),[w,b]=(0,v.useState)(s),[x,T]=(0,v.useState)(null),[M,O]=(0,v.useState)(!1),U=(0,v.useRef)(o.utilities.uuidv4()),P=(0,v.useRef)(null),F=`cornerstoneStreamingImageVolume:${U.current}`;function N(e){t.runCommand("swapDynamicWithComputedDisplaySet",{displaySet:e}),O(!0)}(0,v.useEffect)((()=>{const t=a.EVENTS.VIEWPORT_DATA_CHANGED,n=e.services.cineService.EVENTS.CINE_STATE_CHANGED,{unsubscribe:i}=a.subscribe(t,(e=>{e.viewportData.data.forEach((e=>{if(e.volume?.isDynamicVolume()){I(e.volume),P.current=e.displaySetInstanceUID;const t=[1,e.volume.numTimePoints];m(t),d(t)}}))})),{unsubscribe:s}=e.services.cineService.subscribe(n,(e=>{b(e.isPlaying)}));return()=>{i(),s()}}),[a,c,e.services.cineService]),(0,v.useEffect)((()=>{const e=o.Enums.Events.DYNAMIC_VOLUME_TIME_POINT_INDEX_CHANGED,t=e=>{T(e.detail.timePointIndex)};return o.eventTarget.addEventListener(e,t),()=>{o.eventTarget.removeEventListener(e,t)}}),[a]),(0,v.useEffect)((()=>{const e=n.getDisplaySetsUIDsForViewport(l);if(!e?.length)return;const t=e.map(i.getDisplaySetByUID).find((e=>e.isDynamicVolume));if(!t)return;const a=o.cache.getVolumes().find((e=>e.volumeId.includes(t.displaySetInstanceUID)));if(!a)return;I(a),P.current=t.displaySetInstanceUID;const s=[1,a.numTimePoints];m(s),d(s)}),[l,n,i,a,c]);const R=()=>{b(!0);const e=a.getViewportInfo(l);if(!e)return;const{element:t}=e;c.playClip(t,{framesPerSecond:D,viewportId:l})},V=()=>{b(!1);const{element:e}=a.getViewportInfo(l);c.stopClip(e)};return S&&0!==p.length?v.createElement(C,{fps:D,isPlaying:w,onPlayPauseChange:e=>{e?R():V()},minFps:1,maxFps:50,currentFrameIndex:x,onFpsChange:e=>{f(e),V(),R()},framesLength:p[1],onFrameChange:e=>{S.timePointIndex=e},onGenerate:async function(e){const n=S.volumeId;if(!n)return;let i=o.cache.getVolume(F);i||(i=await o.volumeLoader.createAndCacheDerivedVolume(n,{volumeId:F}));const[s,c]=u,l=Array.from({length:c-s+1},((e,t)=>t+s-1)),p={frameNumbers:"SUBTRACT"===e?[s,c-1]:l,targetVolume:i};if(r.utilities.dynamicVolume.updateVolumeFromTimeData(S,e,p),y)t.runCommand("updateVolumeData",{volume:i}),a.getRenderingEngine().render(),N(y);else{const e={volumeLoaderSchema:i.volumeId.split(":")[0],displaySetInstanceUID:U.current,SOPClassHandlerId:E,Modality:S.metadata.Modality,isMultiFrame:!1,numImageFrames:1,uid:U.current,referenceDisplaySetUID:S.volumeId.split(":")[1],madeInClient:!0,FrameOfReferenceUID:S.metadata.FrameOfReferenceUID,isDerived:!0,imageIds:i.imageIds};g(e),N(e)}},onDynamicClick:M?()=>{t.runCommand("swapComputedWithDynamicDisplaySet")}:null,onDoubleRangeChange:function(e){e[0]===u[0]&&e[1]===u[1]||d(e)},initialRangeValues:u}):null}const T=function({servicesManager:e,commandsManager:t,tab:a}){return v.createElement(v.Fragment,null,v.createElement("div",{className:"flex flex-col text-white","data-cy":"dynamic-volume-panel"},v.createElement(x,{commandsManager:t,servicesManager:e})))};var M=a(11185);const O=function({commandsManager:e,servicesManager:t}){const a=(0,M.useSegmentations)({servicesManager:t});return a?.length?v.createElement("div",{className:"flex gap-2"},v.createElement("div",{className:"flex h-8 w-full items-center rounded pr-0.5"},v.createElement(I.$n,{size:"sm",variant:"ghost",className:"pl-1.5",onClick:()=>{e.runCommand("exportTimeReportCSV",{segmentations:a,options:{filename:"TimeData.csv"}})}},v.createElement(I.FI.Export,null),v.createElement("span",{className:"pl-1"},"Time Data"))),v.createElement("div",{className:"flex h-8 w-full items-center rounded pr-0.5"},v.createElement(I.$n,{size:"sm",variant:"ghost",className:"pl-1.5",onClick:()=>{e.runCommand("exportTimeReportCSV",{segmentations:a,summaryStats:!0,options:{filename:"ROIStats.csv"}})}},v.createElement(I.FI.Export,null),v.createElement("span",{className:"pl-1"},"ROI Stats")))):null};const U=function({commandsManager:e,extensionManager:t,servicesManager:a,configuration:n}){return[{name:"dynamic-volume",iconName:"tab-4d",iconLabel:"4D Workflow",label:"4D Workflow",component:()=>v.createElement(T,{commandsManager:e,servicesManager:a,extensionManager:t})},{name:"dynamic-segmentation",iconName:"tab-segmentation",iconLabel:"Segmentation",label:"Segmentation",component:()=>v.createElement(v.Fragment,null,v.createElement(I.OO,{commandsManager:e,servicesManager:a,extensionManager:t,buttonSectionId:"dynamic-toolbox",title:"Threshold Tools"}),v.createElement(M.PanelSegmentation,{servicesManager:a,commandsManager:e,extensionManager:t,configuration:n},v.createElement(O,{servicesManager:a,commandsManager:e})))}]},P="2hot",F="dynamic4D-pt",N="dynamic4D-fusion",R="dynamic4D-ct";function V({colormap:e,voiInverted:t}={}){return{blendMode:"MIP",colormap:e,voi:{windowWidth:5,windowCenter:2.5},voiInverted:t}}function L(){const e={colormap:{name:P,opacity:[{value:0,opacity:0},{value:.1,opacity:1},{value:1,opacity:1}]},voiInverted:!1};return[{viewportOptions:{viewportId:"ptAxial",viewportType:"volume",orientation:"axial",toolGroupId:F,initialImageOptions:{preset:"middle"},syncGroups:[{type:"cameraPosition",id:"axialSync",source:!0,target:!0},{type:"voi",id:"ptWLSync",source:!0,target:!0}]},displaySets:[{id:"ptDisplaySet",options:{...V(e)}}]},{viewportOptions:{viewportId:"ptSagittal",viewportType:"volume",orientation:"sagittal",toolGroupId:F,initialImageOptions:{preset:"middle"},syncGroups:[{type:"cameraPosition",id:"sagittalSync",source:!0,target:!0},{type:"voi",id:"ptWLSync",source:!0,target:!0}]},displaySets:[{id:"ptDisplaySet",options:{...V(e)}}]},{viewportOptions:{viewportId:"ptCoronal",viewportType:"volume",orientation:"coronal",toolGroupId:F,initialImageOptions:{preset:"middle"},syncGroups:[{type:"cameraPosition",id:"coronalSync",source:!0,target:!0},{type:"voi",id:"ptWLSync",source:!0,target:!0}]},displaySets:[{id:"ptDisplaySet",options:{...V(e)}}]}]}function k(){const e={colormap:{name:P,opacity:[{value:0,opacity:0},{value:.1,opacity:.8},{value:1,opacity:.8}]}};return[{viewportOptions:{viewportId:"fusionAxial",viewportType:"volume",orientation:"axial",toolGroupId:N,initialImageOptions:{preset:"middle"},syncGroups:[{type:"cameraPosition",id:"axialSync",source:!0,target:!0},{type:"voi",id:"ctWLSync",source:!1,target:!0},{type:"voi",id:"fusionWLSync",source:!0,target:!0},{type:"voi",id:"ptFusionWLSync",source:!1,target:!0,options:{syncInvertState:!1}},{type:"hydrateseg",id:"sameFORId",source:!0,target:!0,options:{matchingRules:["sameFOR"]}}]},displaySets:[{id:"ctDisplaySet"},{options:{...V(e)},id:"ptDisplaySet"}]},{viewportOptions:{viewportId:"fusionSagittal",viewportType:"volume",orientation:"sagittal",toolGroupId:N,initialImageOptions:{preset:"middle"},syncGroups:[{type:"cameraPosition",id:"sagittalSync",source:!0,target:!0},{type:"voi",id:"ctWLSync",source:!1,target:!0},{type:"voi",id:"fusionWLSync",source:!0,target:!0},{type:"voi",id:"ptFusionWLSync",source:!1,target:!0,options:{syncInvertState:!1}},{type:"hydrateseg",id:"sameFORId",source:!0,target:!0,options:{matchingRules:["sameFOR"]}}]},displaySets:[{id:"ctDisplaySet"},{options:{...V(e)},id:"ptDisplaySet"}]},{viewportOptions:{viewportId:"fusionCoronal",viewportType:"volume",orientation:"coronal",toolGroupId:N,initialImageOptions:{preset:"middle"},syncGroups:[{type:"cameraPosition",id:"coronalSync",source:!0,target:!0},{type:"voi",id:"ctWLSync",source:!1,target:!0},{type:"voi",id:"fusionWLSync",source:!0,target:!0},{type:"voi",id:"ptFusionWLSync",source:!1,target:!0,options:{syncInvertState:!1}},{type:"hydrateseg",id:"sameFORId",source:!0,target:!0,options:{matchingRules:["sameFOR"]}}]},displaySets:[{id:"ctDisplaySet"},{options:{...V(e)},id:"ptDisplaySet"}]}]}const A={id:"default4D",locked:!0,hasUpdatedPriorsInformation:!1,name:"Default",createdDate:"2023-01-01T00:00:00.000Z",modifiedDate:"2023-01-01T00:00:00.000Z",availableTo:{},editableBy:{},imageLoadStrategy:"default",protocolMatchingRules:[{attribute:"ModalitiesInStudy",constraint:{contains:["CT","PT"]}}],numberOfPriorsReferenced:-1,displaySetSelectors:{defaultDisplaySetId:{imageMatchingRules:[],seriesMatchingRules:[{attribute:"numImageFrames",constraint:{greaterThan:{value:0}}}]},ctDisplaySet:{imageMatchingRules:[],seriesMatchingRules:[{attribute:"Modality",constraint:{equals:{value:"CT"}},required:!0},{attribute:"isReconstructable",constraint:{equals:{value:!0}},required:!0}]},ptDisplaySet:{imageMatchingRules:[],seriesMatchingRules:[{attribute:"Modality",constraint:{equals:"PT"},required:!0},{attribute:"isReconstructable",constraint:{equals:{value:!0}},required:!0},{attribute:"SeriesDescription",constraint:{contains:"Corrected"}},{weight:2,attribute:"SeriesDescription",constraint:{doesNotContain:{value:"Uncorrected"}}}]},chartDisplaySet:{imageMatchingRules:[],seriesMatchingRules:[{attribute:"Modality",constraint:{equals:{value:"CHT"}},required:!0}]}},stages:[{id:"dataPreparation",name:"Data Preparation",viewportStructure:{layoutType:"grid",properties:{rows:1,columns:3}},viewports:[...L()],createdDate:"2023-01-01T00:00:00.000Z"},{id:"registration",name:"Registration",viewportStructure:{layoutType:"grid",properties:{rows:3,columns:3}},viewports:[...k(),{viewportOptions:{viewportId:"ctAxial",viewportType:"volume",orientation:"axial",toolGroupId:R,initialImageOptions:{preset:"middle"},syncGroups:[{type:"cameraPosition",id:"axialSync",source:!0,target:!0},{type:"voi",id:"ctWLSync",source:!0,target:!0}]},displaySets:[{id:"ctDisplaySet"}]},{viewportOptions:{viewportId:"ctSagittal",viewportType:"volume",orientation:"sagittal",toolGroupId:R,initialImageOptions:{preset:"middle"},syncGroups:[{type:"cameraPosition",id:"sagittalSync",source:!0,target:!0},{type:"voi",id:"ctWLSync",source:!0,target:!0}]},displaySets:[{id:"ctDisplaySet"}]},{viewportOptions:{viewportId:"ctCoronal",viewportType:"volume",orientation:"coronal",toolGroupId:R,initialImageOptions:{preset:"middle"},syncGroups:[{type:"cameraPosition",id:"coronalSync",source:!0,target:!0},{type:"voi",id:"ctWLSync",source:!0,target:!0}]},displaySets:[{id:"ctDisplaySet"}]},...L()],createdDate:"2023-01-01T00:00:00.000Z"},{id:"roiQuantification",name:"ROI Quantification",viewportStructure:{layoutType:"grid",properties:{rows:1,columns:3}},viewports:[...k()],createdDate:"2023-01-01T00:00:00.000Z"},{id:"kineticAnalysis",name:"Kinetic Analysis",viewportStructure:{layoutType:"grid",properties:{rows:2,columns:3,layoutOptions:[{x:0,y:0,width:1/3,height:.5},{x:1/3,y:0,width:1/3,height:.5},{x:2/3,y:0,width:1/3,height:.5},{x:0,y:.5,width:1,height:.5}]}},viewports:[...k(),{viewportOptions:{viewportId:"seriesChart"},displaySets:[{id:"chartDisplaySet",options:{skipLoading:!0}}]}],createdDate:"2023-01-01T00:00:00.000Z"}]};const G={id:i,preRegistration:({servicesManager:e,commandsManager:t,configuration:a={}})=>{o.cache.setMaxCacheSize(5368709120)},getPanelModule:U,getHangingProtocolModule:function(){return[{name:A.id,protocol:A}]},getCommandsModule:({servicesManager:e,commandsManager:t,extensionManager:a})=>S({servicesManager:e,commandsManager:t,extensionManager:a})}}}]);
//# sourceMappingURL=717.bundle.62a970506376d6b2604e.js.map